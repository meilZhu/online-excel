!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e){},function(t,e,n){(function(t,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o,a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",c="__lodash_hash_undefined__",s=500,f="__lodash_placeholder__",h=1,p=2,v=4,d=1,y=2,g=1,b=2,m=4,w=8,_=16,k=32,x=64,O=128,S=256,E=512,j=30,C="...",T=800,A=16,P=1,R=2,I=1/0,D=9007199254740991,z=17976931348623157e292,M=NaN,L=4294967295,W=L-1,H=L>>>1,F=[["ary",O],["bind",g],["bindKey",b],["curry",w],["curryRight",_],["flip",E],["partial",k],["partialRight",x],["rearg",S]],N="[object Arguments]",q="[object Array]",B="[object AsyncFunction]",V="[object Boolean]",U="[object Date]",$="[object DOMException]",Y="[object Error]",X="[object Function]",K="[object GeneratorFunction]",Z="[object Map]",G="[object Number]",J="[object Null]",Q="[object Object]",tt="[object Proxy]",et="[object RegExp]",nt="[object Set]",rt="[object String]",it="[object Symbol]",ot="[object Undefined]",at="[object WeakMap]",lt="[object WeakSet]",ut="[object ArrayBuffer]",ct="[object DataView]",st="[object Float32Array]",ft="[object Float64Array]",ht="[object Int8Array]",pt="[object Int16Array]",vt="[object Int32Array]",dt="[object Uint8Array]",yt="[object Uint8ClampedArray]",gt="[object Uint16Array]",bt="[object Uint32Array]",mt=/\b__p \+= '';/g,wt=/\b(__p \+=) '' \+/g,_t=/(__e\(.*?\)|\b__t\)) \+\n'';/g,kt=/&(?:amp|lt|gt|quot|#39);/g,xt=/[&<>"']/g,Ot=RegExp(kt.source),St=RegExp(xt.source),Et=/<%-([\s\S]+?)%>/g,jt=/<%([\s\S]+?)%>/g,Ct=/<%=([\s\S]+?)%>/g,Tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,At=/^\w*$/,Pt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Rt=/[\\^$.*+?()[\]{}|]/g,It=RegExp(Rt.source),Dt=/^\s+|\s+$/g,zt=/^\s+/,Mt=/\s+$/,Lt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Wt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ht=/,? & /,Ft=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Nt=/\\(\\)?/g,qt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Bt=/\w*$/,Vt=/^[-+]0x[0-9a-f]+$/i,Ut=/^0b[01]+$/i,$t=/^\[object .+?Constructor\]$/,Yt=/^0o[0-7]+$/i,Xt=/^(?:0|[1-9]\d*)$/,Kt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Zt=/($^)/,Gt=/['\n\r\u2028\u2029\\]/g,Jt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Qt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",te="[\\ud800-\\udfff]",ee="["+Qt+"]",ne="["+Jt+"]",re="\\d+",ie="[\\u2700-\\u27bf]",oe="[a-z\\xdf-\\xf6\\xf8-\\xff]",ae="[^\\ud800-\\udfff"+Qt+re+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",le="\\ud83c[\\udffb-\\udfff]",ue="[^\\ud800-\\udfff]",ce="(?:\\ud83c[\\udde6-\\uddff]){2}",se="[\\ud800-\\udbff][\\udc00-\\udfff]",fe="[A-Z\\xc0-\\xd6\\xd8-\\xde]",he="(?:"+oe+"|"+ae+")",pe="(?:"+fe+"|"+ae+")",ve="(?:"+ne+"|"+le+")"+"?",de="[\\ufe0e\\ufe0f]?"+ve+("(?:\\u200d(?:"+[ue,ce,se].join("|")+")[\\ufe0e\\ufe0f]?"+ve+")*"),ye="(?:"+[ie,ce,se].join("|")+")"+de,ge="(?:"+[ue+ne+"?",ne,ce,se,te].join("|")+")",be=RegExp("['’]","g"),me=RegExp(ne,"g"),we=RegExp(le+"(?="+le+")|"+ge+de,"g"),_e=RegExp([fe+"?"+oe+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ee,fe,"$"].join("|")+")",pe+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ee,fe+he,"$"].join("|")+")",fe+"?"+he+"+(?:['’](?:d|ll|m|re|s|t|ve))?",fe+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",re,ye].join("|"),"g"),ke=RegExp("[\\u200d\\ud800-\\udfff"+Jt+"\\ufe0e\\ufe0f]"),xe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Oe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Se=-1,Ee={};Ee[st]=Ee[ft]=Ee[ht]=Ee[pt]=Ee[vt]=Ee[dt]=Ee[yt]=Ee[gt]=Ee[bt]=!0,Ee[N]=Ee[q]=Ee[ut]=Ee[V]=Ee[ct]=Ee[U]=Ee[Y]=Ee[X]=Ee[Z]=Ee[G]=Ee[Q]=Ee[et]=Ee[nt]=Ee[rt]=Ee[at]=!1;var je={};je[N]=je[q]=je[ut]=je[ct]=je[V]=je[U]=je[st]=je[ft]=je[ht]=je[pt]=je[vt]=je[Z]=je[G]=je[Q]=je[et]=je[nt]=je[rt]=je[it]=je[dt]=je[yt]=je[gt]=je[bt]=!0,je[Y]=je[X]=je[at]=!1;var Ce={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Te=parseFloat,Ae=parseInt,Pe="object"==typeof t&&t&&t.Object===Object&&t,Re="object"==typeof self&&self&&self.Object===Object&&self,Ie=Pe||Re||Function("return this")(),De=e&&!e.nodeType&&e,ze=De&&"object"==typeof r&&r&&!r.nodeType&&r,Me=ze&&ze.exports===De,Le=Me&&Pe.process,We=function(){try{var t=ze&&ze.require&&ze.require("util").types;return t||Le&&Le.binding&&Le.binding("util")}catch(t){}}(),He=We&&We.isArrayBuffer,Fe=We&&We.isDate,Ne=We&&We.isMap,qe=We&&We.isRegExp,Be=We&&We.isSet,Ve=We&&We.isTypedArray;function Ue(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function $e(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function Ye(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Xe(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Ke(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Ze(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function Ge(t,e){return!!(null==t?0:t.length)&&un(t,e,0)>-1}function Je(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Qe(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function tn(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function en(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function nn(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function rn(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var on=hn("length");function an(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function ln(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function un(t,e,n){return e==e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):ln(t,sn,n)}function cn(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function sn(t){return t!=t}function fn(t,e){var n=null==t?0:t.length;return n?dn(t,e)/n:M}function hn(t){return function(e){return null==e?o:e[t]}}function pn(t){return function(e){return null==t?o:t[e]}}function vn(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function dn(t,e){for(var n,r=-1,i=t.length;++r<i;){var a=e(t[r]);a!==o&&(n=n===o?a:n+a)}return n}function yn(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function gn(t){return function(e){return t(e)}}function bn(t,e){return Qe(e,function(e){return t[e]})}function mn(t,e){return t.has(e)}function wn(t,e){for(var n=-1,r=t.length;++n<r&&un(e,t[n],0)>-1;);return n}function _n(t,e){for(var n=t.length;n--&&un(e,t[n],0)>-1;);return n}var kn=pn({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),xn=pn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function On(t){return"\\"+Ce[t]}function Sn(t){return ke.test(t)}function En(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function jn(t,e){return function(n){return t(e(n))}}function Cn(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n];a!==e&&a!==f||(t[n]=f,o[i++]=n)}return o}function Tn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function An(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function Pn(t){return Sn(t)?function(t){var e=we.lastIndex=0;for(;we.test(t);)++e;return e}(t):on(t)}function Rn(t){return Sn(t)?function(t){return t.match(we)||[]}(t):function(t){return t.split("")}(t)}var In=pn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Dn=function t(e){var n,r=(e=null==e?Ie:Dn.defaults(Ie.Object(),e,Dn.pick(Ie,Oe))).Array,i=e.Date,Jt=e.Error,Qt=e.Function,te=e.Math,ee=e.Object,ne=e.RegExp,re=e.String,ie=e.TypeError,oe=r.prototype,ae=Qt.prototype,le=ee.prototype,ue=e["__core-js_shared__"],ce=ae.toString,se=le.hasOwnProperty,fe=0,he=(n=/[^.]+$/.exec(ue&&ue.keys&&ue.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",pe=le.toString,ve=ce.call(ee),de=Ie._,ye=ne("^"+ce.call(se).replace(Rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ge=Me?e.Buffer:o,we=e.Symbol,ke=e.Uint8Array,Ce=ge?ge.allocUnsafe:o,Pe=jn(ee.getPrototypeOf,ee),Re=ee.create,De=le.propertyIsEnumerable,ze=oe.splice,Le=we?we.isConcatSpreadable:o,We=we?we.iterator:o,on=we?we.toStringTag:o,pn=function(){try{var t=Ho(ee,"defineProperty");return t({},"",{}),t}catch(t){}}(),zn=e.clearTimeout!==Ie.clearTimeout&&e.clearTimeout,Mn=i&&i.now!==Ie.Date.now&&i.now,Ln=e.setTimeout!==Ie.setTimeout&&e.setTimeout,Wn=te.ceil,Hn=te.floor,Fn=ee.getOwnPropertySymbols,Nn=ge?ge.isBuffer:o,qn=e.isFinite,Bn=oe.join,Vn=jn(ee.keys,ee),Un=te.max,$n=te.min,Yn=i.now,Xn=e.parseInt,Kn=te.random,Zn=oe.reverse,Gn=Ho(e,"DataView"),Jn=Ho(e,"Map"),Qn=Ho(e,"Promise"),tr=Ho(e,"Set"),er=Ho(e,"WeakMap"),nr=Ho(ee,"create"),rr=er&&new er,ir={},or=fa(Gn),ar=fa(Jn),lr=fa(Qn),ur=fa(tr),cr=fa(er),sr=we?we.prototype:o,fr=sr?sr.valueOf:o,hr=sr?sr.toString:o;function pr(t){if(Cl(t)&&!gl(t)&&!(t instanceof gr)){if(t instanceof yr)return t;if(se.call(t,"__wrapped__"))return ha(t)}return new yr(t)}var vr=function(){function t(){}return function(e){if(!jl(e))return{};if(Re)return Re(e);t.prototype=e;var n=new t;return t.prototype=o,n}}();function dr(){}function yr(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=o}function gr(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=L,this.__views__=[]}function br(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function mr(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function wr(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function _r(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new wr;++e<n;)this.add(t[e])}function kr(t){var e=this.__data__=new mr(t);this.size=e.size}function xr(t,e){var n=gl(t),r=!n&&yl(t),i=!n&&!r&&_l(t),o=!n&&!r&&!i&&Ml(t),a=n||r||i||o,l=a?yn(t.length,re):[],u=l.length;for(var c in t)!e&&!se.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||$o(c,u))||l.push(c);return l}function Or(t){var e=t.length;return e?t[_i(0,e-1)]:o}function Sr(t,e){return ua(no(t),Dr(e,0,t.length))}function Er(t){return ua(no(t))}function jr(t,e,n){(n===o||pl(t[e],n))&&(n!==o||e in t)||Rr(t,e,n)}function Cr(t,e,n){var r=t[e];se.call(t,e)&&pl(r,n)&&(n!==o||e in t)||Rr(t,e,n)}function Tr(t,e){for(var n=t.length;n--;)if(pl(t[n][0],e))return n;return-1}function Ar(t,e,n,r){return Hr(t,function(t,i,o){e(r,t,n(t),o)}),r}function Pr(t,e){return t&&ro(e,iu(e),t)}function Rr(t,e,n){"__proto__"==e&&pn?pn(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Ir(t,e){for(var n=-1,i=e.length,a=r(i),l=null==t;++n<i;)a[n]=l?o:Ql(t,e[n]);return a}function Dr(t,e,n){return t==t&&(n!==o&&(t=t<=n?t:n),e!==o&&(t=t>=e?t:e)),t}function zr(t,e,n,r,i,a){var l,u=e&h,c=e&p,s=e&v;if(n&&(l=i?n(t,r,i,a):n(t)),l!==o)return l;if(!jl(t))return t;var f=gl(t);if(f){if(l=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&se.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!u)return no(t,l)}else{var d=qo(t),y=d==X||d==K;if(_l(t))return Zi(t,u);if(d==Q||d==N||y&&!i){if(l=c||y?{}:Vo(t),!u)return c?function(t,e){return ro(t,No(t),e)}(t,function(t,e){return t&&ro(e,ou(e),t)}(l,t)):function(t,e){return ro(t,Fo(t),e)}(t,Pr(l,t))}else{if(!je[d])return i?t:{};l=function(t,e,n){var r,i=t.constructor;switch(e){case ut:return Gi(t);case V:case U:return new i(+t);case ct:return function(t,e){var n=e?Gi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case st:case ft:case ht:case pt:case vt:case dt:case yt:case gt:case bt:return Ji(t,n);case Z:return new i;case G:case rt:return new i(t);case et:return function(t){var e=new t.constructor(t.source,Bt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case nt:return new i;case it:return r=t,fr?ee(fr.call(r)):{}}}(t,d,u)}}a||(a=new kr);var g=a.get(t);if(g)return g;a.set(t,l),Il(t)?t.forEach(function(r){l.add(zr(r,e,n,r,t,a))}):Tl(t)&&t.forEach(function(r,i){l.set(i,zr(r,e,n,i,t,a))});var b=f?o:(s?c?Ro:Po:c?ou:iu)(t);return Ye(b||t,function(r,i){b&&(r=t[i=r]),Cr(l,i,zr(r,e,n,i,t,a))}),l}function Mr(t,e,n){var r=n.length;if(null==t)return!r;for(t=ee(t);r--;){var i=n[r],a=e[i],l=t[i];if(l===o&&!(i in t)||!a(l))return!1}return!0}function Lr(t,e,n){if("function"!=typeof t)throw new ie(u);return ia(function(){t.apply(o,n)},e)}function Wr(t,e,n,r){var i=-1,o=Ge,l=!0,u=t.length,c=[],s=e.length;if(!u)return c;n&&(e=Qe(e,gn(n))),r?(o=Je,l=!1):e.length>=a&&(o=mn,l=!1,e=new _r(e));t:for(;++i<u;){var f=t[i],h=null==n?f:n(f);if(f=r||0!==f?f:0,l&&h==h){for(var p=s;p--;)if(e[p]===h)continue t;c.push(f)}else o(e,h,r)||c.push(f)}return c}pr.templateSettings={escape:Et,evaluate:jt,interpolate:Ct,variable:"",imports:{_:pr}},pr.prototype=dr.prototype,pr.prototype.constructor=pr,yr.prototype=vr(dr.prototype),yr.prototype.constructor=yr,gr.prototype=vr(dr.prototype),gr.prototype.constructor=gr,br.prototype.clear=function(){this.__data__=nr?nr(null):{},this.size=0},br.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},br.prototype.get=function(t){var e=this.__data__;if(nr){var n=e[t];return n===c?o:n}return se.call(e,t)?e[t]:o},br.prototype.has=function(t){var e=this.__data__;return nr?e[t]!==o:se.call(e,t)},br.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=nr&&e===o?c:e,this},mr.prototype.clear=function(){this.__data__=[],this.size=0},mr.prototype.delete=function(t){var e=this.__data__,n=Tr(e,t);return!(n<0||(n==e.length-1?e.pop():ze.call(e,n,1),--this.size,0))},mr.prototype.get=function(t){var e=this.__data__,n=Tr(e,t);return n<0?o:e[n][1]},mr.prototype.has=function(t){return Tr(this.__data__,t)>-1},mr.prototype.set=function(t,e){var n=this.__data__,r=Tr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},wr.prototype.clear=function(){this.size=0,this.__data__={hash:new br,map:new(Jn||mr),string:new br}},wr.prototype.delete=function(t){var e=Lo(this,t).delete(t);return this.size-=e?1:0,e},wr.prototype.get=function(t){return Lo(this,t).get(t)},wr.prototype.has=function(t){return Lo(this,t).has(t)},wr.prototype.set=function(t,e){var n=Lo(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},_r.prototype.add=_r.prototype.push=function(t){return this.__data__.set(t,c),this},_r.prototype.has=function(t){return this.__data__.has(t)},kr.prototype.clear=function(){this.__data__=new mr,this.size=0},kr.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},kr.prototype.get=function(t){return this.__data__.get(t)},kr.prototype.has=function(t){return this.__data__.has(t)},kr.prototype.set=function(t,e){var n=this.__data__;if(n instanceof mr){var r=n.__data__;if(!Jn||r.length<a-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new wr(r)}return n.set(t,e),this.size=n.size,this};var Hr=ao(Yr),Fr=ao(Xr,!0);function Nr(t,e){var n=!0;return Hr(t,function(t,r,i){return n=!!e(t,r,i)}),n}function qr(t,e,n){for(var r=-1,i=t.length;++r<i;){var a=t[r],l=e(a);if(null!=l&&(u===o?l==l&&!zl(l):n(l,u)))var u=l,c=a}return c}function Br(t,e){var n=[];return Hr(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function Vr(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=Uo),i||(i=[]);++o<a;){var l=t[o];e>0&&n(l)?e>1?Vr(l,e-1,n,r,i):tn(i,l):r||(i[i.length]=l)}return i}var Ur=lo(),$r=lo(!0);function Yr(t,e){return t&&Ur(t,e,iu)}function Xr(t,e){return t&&$r(t,e,iu)}function Kr(t,e){return Ze(e,function(e){return Ol(t[e])})}function Zr(t,e){for(var n=0,r=(e=$i(e,t)).length;null!=t&&n<r;)t=t[sa(e[n++])];return n&&n==r?t:o}function Gr(t,e,n){var r=e(t);return gl(t)?r:tn(r,n(t))}function Jr(t){return null==t?t===o?ot:J:on&&on in ee(t)?function(t){var e=se.call(t,on),n=t[on];try{t[on]=o;var r=!0}catch(t){}var i=pe.call(t);return r&&(e?t[on]=n:delete t[on]),i}(t):function(t){return pe.call(t)}(t)}function Qr(t,e){return t>e}function ti(t,e){return null!=t&&se.call(t,e)}function ei(t,e){return null!=t&&e in ee(t)}function ni(t,e,n){for(var i=n?Je:Ge,a=t[0].length,l=t.length,u=l,c=r(l),s=1/0,f=[];u--;){var h=t[u];u&&e&&(h=Qe(h,gn(e))),s=$n(h.length,s),c[u]=!n&&(e||a>=120&&h.length>=120)?new _r(u&&h):o}h=t[0];var p=-1,v=c[0];t:for(;++p<a&&f.length<s;){var d=h[p],y=e?e(d):d;if(d=n||0!==d?d:0,!(v?mn(v,y):i(f,y,n))){for(u=l;--u;){var g=c[u];if(!(g?mn(g,y):i(t[u],y,n)))continue t}v&&v.push(y),f.push(d)}}return f}function ri(t,e,n){var r=null==(t=ea(t,e=$i(e,t)))?t:t[sa(xa(e))];return null==r?o:Ue(r,t,n)}function ii(t){return Cl(t)&&Jr(t)==N}function oi(t,e,n,r,i){return t===e||(null==t||null==e||!Cl(t)&&!Cl(e)?t!=t&&e!=e:function(t,e,n,r,i,a){var l=gl(t),u=gl(e),c=l?q:qo(t),s=u?q:qo(e),f=(c=c==N?Q:c)==Q,h=(s=s==N?Q:s)==Q,p=c==s;if(p&&_l(t)){if(!_l(e))return!1;l=!0,f=!1}if(p&&!f)return a||(a=new kr),l||Ml(t)?To(t,e,n,r,i,a):function(t,e,n,r,i,o,a){switch(n){case ct:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ut:return!(t.byteLength!=e.byteLength||!o(new ke(t),new ke(e)));case V:case U:case G:return pl(+t,+e);case Y:return t.name==e.name&&t.message==e.message;case et:case rt:return t==e+"";case Z:var l=En;case nt:var u=r&d;if(l||(l=Tn),t.size!=e.size&&!u)return!1;var c=a.get(t);if(c)return c==e;r|=y,a.set(t,e);var s=To(l(t),l(e),r,i,o,a);return a.delete(t),s;case it:if(fr)return fr.call(t)==fr.call(e)}return!1}(t,e,c,n,r,i,a);if(!(n&d)){var v=f&&se.call(t,"__wrapped__"),g=h&&se.call(e,"__wrapped__");if(v||g){var b=v?t.value():t,m=g?e.value():e;return a||(a=new kr),i(b,m,n,r,a)}}return!!p&&(a||(a=new kr),function(t,e,n,r,i,a){var l=n&d,u=Po(t),c=u.length,s=Po(e).length;if(c!=s&&!l)return!1;for(var f=c;f--;){var h=u[f];if(!(l?h in e:se.call(e,h)))return!1}var p=a.get(t);if(p&&a.get(e))return p==e;var v=!0;a.set(t,e),a.set(e,t);for(var y=l;++f<c;){h=u[f];var g=t[h],b=e[h];if(r)var m=l?r(b,g,h,e,t,a):r(g,b,h,t,e,a);if(!(m===o?g===b||i(g,b,n,r,a):m)){v=!1;break}y||(y="constructor"==h)}if(v&&!y){var w=t.constructor,_=e.constructor;w!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof w&&w instanceof w&&"function"==typeof _&&_ instanceof _)&&(v=!1)}return a.delete(t),a.delete(e),v}(t,e,n,r,i,a))}(t,e,n,r,oi,i))}function ai(t,e,n,r){var i=n.length,a=i,l=!r;if(null==t)return!a;for(t=ee(t);i--;){var u=n[i];if(l&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<a;){var c=(u=n[i])[0],s=t[c],f=u[1];if(l&&u[2]){if(s===o&&!(c in t))return!1}else{var h=new kr;if(r)var p=r(s,f,c,t,e,h);if(!(p===o?oi(f,s,d|y,r,h):p))return!1}}return!0}function li(t){return!(!jl(t)||(e=t,he&&he in e))&&(Ol(t)?ye:$t).test(fa(t));var e}function ui(t){return"function"==typeof t?t:null==t?Au:"object"==typeof t?gl(t)?vi(t[0],t[1]):pi(t):Hu(t)}function ci(t){if(!Go(t))return Vn(t);var e=[];for(var n in ee(t))se.call(t,n)&&"constructor"!=n&&e.push(n);return e}function si(t){if(!jl(t))return function(t){var e=[];if(null!=t)for(var n in ee(t))e.push(n);return e}(t);var e=Go(t),n=[];for(var r in t)("constructor"!=r||!e&&se.call(t,r))&&n.push(r);return n}function fi(t,e){return t<e}function hi(t,e){var n=-1,i=ml(t)?r(t.length):[];return Hr(t,function(t,r,o){i[++n]=e(t,r,o)}),i}function pi(t){var e=Wo(t);return 1==e.length&&e[0][2]?Qo(e[0][0],e[0][1]):function(n){return n===t||ai(n,t,e)}}function vi(t,e){return Xo(t)&&Jo(e)?Qo(sa(t),e):function(n){var r=Ql(n,t);return r===o&&r===e?tu(n,t):oi(e,r,d|y)}}function di(t,e,n,r,i){t!==e&&Ur(e,function(a,l){if(i||(i=new kr),jl(a))!function(t,e,n,r,i,a,l){var u=na(t,n),c=na(e,n),s=l.get(c);if(s)jr(t,n,s);else{var f=a?a(u,c,n+"",t,e,l):o,h=f===o;if(h){var p=gl(c),v=!p&&_l(c),d=!p&&!v&&Ml(c);f=c,p||v||d?gl(u)?f=u:wl(u)?f=no(u):v?(h=!1,f=Zi(c,!0)):d?(h=!1,f=Ji(c,!0)):f=[]:Pl(c)||yl(c)?(f=u,yl(u)?f=Vl(u):jl(u)&&!Ol(u)||(f=Vo(c))):h=!1}h&&(l.set(c,f),i(f,c,r,a,l),l.delete(c)),jr(t,n,f)}}(t,e,l,n,di,r,i);else{var u=r?r(na(t,l),a,l+"",t,e,i):o;u===o&&(u=a),jr(t,l,u)}},ou)}function yi(t,e){var n=t.length;if(n)return $o(e+=e<0?n:0,n)?t[e]:o}function gi(t,e,n){var r=-1;return e=Qe(e.length?e:[Au],gn(Mo())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(hi(t,function(t,n,i){return{criteria:Qe(e,function(e){return e(t)}),index:++r,value:t}}),function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,a=i.length,l=n.length;++r<a;){var u=Qi(i[r],o[r]);if(u){if(r>=l)return u;var c=n[r];return u*("desc"==c?-1:1)}}return t.index-e.index}(t,e,n)})}function bi(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],l=Zr(t,a);n(l,a)&&Ei(o,$i(a,t),l)}return o}function mi(t,e,n,r){var i=r?cn:un,o=-1,a=e.length,l=t;for(t===e&&(e=no(e)),n&&(l=Qe(t,gn(n)));++o<a;)for(var u=0,c=e[o],s=n?n(c):c;(u=i(l,s,u,r))>-1;)l!==t&&ze.call(l,u,1),ze.call(t,u,1);return t}function wi(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;$o(i)?ze.call(t,i,1):Wi(t,i)}}return t}function _i(t,e){return t+Hn(Kn()*(e-t+1))}function ki(t,e){var n="";if(!t||e<1||e>D)return n;do{e%2&&(n+=t),(e=Hn(e/2))&&(t+=t)}while(e);return n}function xi(t,e){return oa(ta(t,e,Au),t+"")}function Oi(t){return Or(pu(t))}function Si(t,e){var n=pu(t);return ua(n,Dr(e,0,n.length))}function Ei(t,e,n,r){if(!jl(t))return t;for(var i=-1,a=(e=$i(e,t)).length,l=a-1,u=t;null!=u&&++i<a;){var c=sa(e[i]),s=n;if(i!=l){var f=u[c];(s=r?r(f,c,u):o)===o&&(s=jl(f)?f:$o(e[i+1])?[]:{})}Cr(u,c,s),u=u[c]}return t}var ji=rr?function(t,e){return rr.set(t,e),t}:Au,Ci=pn?function(t,e){return pn(t,"toString",{configurable:!0,enumerable:!1,value:ju(e),writable:!0})}:Au;function Ti(t){return ua(pu(t))}function Ai(t,e,n){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var a=r(o);++i<o;)a[i]=t[i+e];return a}function Pi(t,e){var n;return Hr(t,function(t,r,i){return!(n=e(t,r,i))}),!!n}function Ri(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=H){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!zl(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return Ii(t,e,Au,n)}function Ii(t,e,n,r){e=n(e);for(var i=0,a=null==t?0:t.length,l=e!=e,u=null===e,c=zl(e),s=e===o;i<a;){var f=Hn((i+a)/2),h=n(t[f]),p=h!==o,v=null===h,d=h==h,y=zl(h);if(l)var g=r||d;else g=s?d&&(r||p):u?d&&p&&(r||!v):c?d&&p&&!v&&(r||!y):!v&&!y&&(r?h<=e:h<e);g?i=f+1:a=f}return $n(a,W)}function Di(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],l=e?e(a):a;if(!n||!pl(l,u)){var u=l;o[i++]=0===a?0:a}}return o}function zi(t){return"number"==typeof t?t:zl(t)?M:+t}function Mi(t){if("string"==typeof t)return t;if(gl(t))return Qe(t,Mi)+"";if(zl(t))return hr?hr.call(t):"";var e=t+"";return"0"==e&&1/t==-I?"-0":e}function Li(t,e,n){var r=-1,i=Ge,o=t.length,l=!0,u=[],c=u;if(n)l=!1,i=Je;else if(o>=a){var s=e?null:xo(t);if(s)return Tn(s);l=!1,i=mn,c=new _r}else c=e?[]:u;t:for(;++r<o;){var f=t[r],h=e?e(f):f;if(f=n||0!==f?f:0,l&&h==h){for(var p=c.length;p--;)if(c[p]===h)continue t;e&&c.push(h),u.push(f)}else i(c,h,n)||(c!==u&&c.push(h),u.push(f))}return u}function Wi(t,e){return null==(t=ea(t,e=$i(e,t)))||delete t[sa(xa(e))]}function Hi(t,e,n,r){return Ei(t,e,n(Zr(t,e)),r)}function Fi(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Ai(t,r?0:o,r?o+1:i):Ai(t,r?o+1:0,r?i:o)}function Ni(t,e){var n=t;return n instanceof gr&&(n=n.value()),en(e,function(t,e){return e.func.apply(e.thisArg,tn([t],e.args))},n)}function qi(t,e,n){var i=t.length;if(i<2)return i?Li(t[0]):[];for(var o=-1,a=r(i);++o<i;)for(var l=t[o],u=-1;++u<i;)u!=o&&(a[o]=Wr(a[o]||l,t[u],e,n));return Li(Vr(a,1),e,n)}function Bi(t,e,n){for(var r=-1,i=t.length,a=e.length,l={};++r<i;){var u=r<a?e[r]:o;n(l,t[r],u)}return l}function Vi(t){return wl(t)?t:[]}function Ui(t){return"function"==typeof t?t:Au}function $i(t,e){return gl(t)?t:Xo(t,e)?[t]:ca(Ul(t))}var Yi=xi;function Xi(t,e,n){var r=t.length;return n=n===o?r:n,!e&&n>=r?t:Ai(t,e,n)}var Ki=zn||function(t){return Ie.clearTimeout(t)};function Zi(t,e){if(e)return t.slice();var n=t.length,r=Ce?Ce(n):new t.constructor(n);return t.copy(r),r}function Gi(t){var e=new t.constructor(t.byteLength);return new ke(e).set(new ke(t)),e}function Ji(t,e){var n=e?Gi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Qi(t,e){if(t!==e){var n=t!==o,r=null===t,i=t==t,a=zl(t),l=e!==o,u=null===e,c=e==e,s=zl(e);if(!u&&!s&&!a&&t>e||a&&l&&c&&!u&&!s||r&&l&&c||!n&&c||!i)return 1;if(!r&&!a&&!s&&t<e||s&&n&&i&&!r&&!a||u&&n&&i||!l&&i||!c)return-1}return 0}function to(t,e,n,i){for(var o=-1,a=t.length,l=n.length,u=-1,c=e.length,s=Un(a-l,0),f=r(c+s),h=!i;++u<c;)f[u]=e[u];for(;++o<l;)(h||o<a)&&(f[n[o]]=t[o]);for(;s--;)f[u++]=t[o++];return f}function eo(t,e,n,i){for(var o=-1,a=t.length,l=-1,u=n.length,c=-1,s=e.length,f=Un(a-u,0),h=r(f+s),p=!i;++o<f;)h[o]=t[o];for(var v=o;++c<s;)h[v+c]=e[c];for(;++l<u;)(p||o<a)&&(h[v+n[l]]=t[o++]);return h}function no(t,e){var n=-1,i=t.length;for(e||(e=r(i));++n<i;)e[n]=t[n];return e}function ro(t,e,n,r){var i=!n;n||(n={});for(var a=-1,l=e.length;++a<l;){var u=e[a],c=r?r(n[u],t[u],u,n,t):o;c===o&&(c=t[u]),i?Rr(n,u,c):Cr(n,u,c)}return n}function io(t,e){return function(n,r){var i=gl(n)?$e:Ar,o=e?e():{};return i(n,t,Mo(r,2),o)}}function oo(t){return xi(function(e,n){var r=-1,i=n.length,a=i>1?n[i-1]:o,l=i>2?n[2]:o;for(a=t.length>3&&"function"==typeof a?(i--,a):o,l&&Yo(n[0],n[1],l)&&(a=i<3?o:a,i=1),e=ee(e);++r<i;){var u=n[r];u&&t(e,u,r,a)}return e})}function ao(t,e){return function(n,r){if(null==n)return n;if(!ml(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=ee(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function lo(t){return function(e,n,r){for(var i=-1,o=ee(e),a=r(e),l=a.length;l--;){var u=a[t?l:++i];if(!1===n(o[u],u,o))break}return e}}function uo(t){return function(e){var n=Sn(e=Ul(e))?Rn(e):o,r=n?n[0]:e.charAt(0),i=n?Xi(n,1).join(""):e.slice(1);return r[t]()+i}}function co(t){return function(e){return en(Ou(yu(e).replace(be,"")),t,"")}}function so(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=vr(t.prototype),r=t.apply(n,e);return jl(r)?r:n}}function fo(t){return function(e,n,r){var i=ee(e);if(!ml(e)){var a=Mo(n,3);e=iu(e),n=function(t){return a(i[t],t,i)}}var l=t(e,n,r);return l>-1?i[a?e[l]:l]:o}}function ho(t){return Ao(function(e){var n=e.length,r=n,i=yr.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new ie(u);if(i&&!l&&"wrapper"==Do(a))var l=new yr([],!0)}for(r=l?r:n;++r<n;){var c=Do(a=e[r]),s="wrapper"==c?Io(a):o;l=s&&Ko(s[0])&&s[1]==(O|w|k|S)&&!s[4].length&&1==s[9]?l[Do(s[0])].apply(l,s[3]):1==a.length&&Ko(a)?l[c]():l.thru(a)}return function(){var t=arguments,r=t[0];if(l&&1==t.length&&gl(r))return l.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}})}function po(t,e,n,i,a,l,u,c,s,f){var h=e&O,p=e&g,v=e&b,d=e&(w|_),y=e&E,m=v?o:so(t);return function g(){for(var b=arguments.length,w=r(b),_=b;_--;)w[_]=arguments[_];if(d)var k=zo(g),x=function(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}(w,k);if(i&&(w=to(w,i,a,d)),l&&(w=eo(w,l,u,d)),b-=x,d&&b<f){var O=Cn(w,k);return _o(t,e,po,g.placeholder,n,w,O,c,s,f-b)}var S=p?n:this,E=v?S[t]:t;return b=w.length,c?w=function(t,e){for(var n=t.length,r=$n(e.length,n),i=no(t);r--;){var a=e[r];t[r]=$o(a,n)?i[a]:o}return t}(w,c):y&&b>1&&w.reverse(),h&&s<b&&(w.length=s),this&&this!==Ie&&this instanceof g&&(E=m||so(E)),E.apply(S,w)}}function vo(t,e){return function(n,r){return function(t,e,n,r){return Yr(t,function(t,i,o){e(r,n(t),i,o)}),r}(n,t,e(r),{})}}function yo(t,e){return function(n,r){var i;if(n===o&&r===o)return e;if(n!==o&&(i=n),r!==o){if(i===o)return r;"string"==typeof n||"string"==typeof r?(n=Mi(n),r=Mi(r)):(n=zi(n),r=zi(r)),i=t(n,r)}return i}}function go(t){return Ao(function(e){return e=Qe(e,gn(Mo())),xi(function(n){var r=this;return t(e,function(t){return Ue(t,r,n)})})})}function bo(t,e){var n=(e=e===o?" ":Mi(e)).length;if(n<2)return n?ki(e,t):e;var r=ki(e,Wn(t/Pn(e)));return Sn(e)?Xi(Rn(r),0,t).join(""):r.slice(0,t)}function mo(t){return function(e,n,i){return i&&"number"!=typeof i&&Yo(e,n,i)&&(n=i=o),e=Fl(e),n===o?(n=e,e=0):n=Fl(n),function(t,e,n,i){for(var o=-1,a=Un(Wn((e-t)/(n||1)),0),l=r(a);a--;)l[i?a:++o]=t,t+=n;return l}(e,n,i=i===o?e<n?1:-1:Fl(i),t)}}function wo(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=Bl(e),n=Bl(n)),t(e,n)}}function _o(t,e,n,r,i,a,l,u,c,s){var f=e&w;e|=f?k:x,(e&=~(f?x:k))&m||(e&=~(g|b));var h=[t,e,i,f?a:o,f?l:o,f?o:a,f?o:l,u,c,s],p=n.apply(o,h);return Ko(t)&&ra(p,h),p.placeholder=r,aa(p,t,e)}function ko(t){var e=te[t];return function(t,n){if(t=Bl(t),(n=null==n?0:$n(Nl(n),292))&&qn(t)){var r=(Ul(t)+"e").split("e");return+((r=(Ul(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var xo=tr&&1/Tn(new tr([,-0]))[1]==I?function(t){return new tr(t)}:zu;function Oo(t){return function(e){var n=qo(e);return n==Z?En(e):n==nt?An(e):function(t,e){return Qe(e,function(e){return[e,t[e]]})}(e,t(e))}}function So(t,e,n,i,a,l,c,s){var h=e&b;if(!h&&"function"!=typeof t)throw new ie(u);var p=i?i.length:0;if(p||(e&=~(k|x),i=a=o),c=c===o?c:Un(Nl(c),0),s=s===o?s:Nl(s),p-=a?a.length:0,e&x){var v=i,d=a;i=a=o}var y=h?o:Io(t),E=[t,e,n,i,a,v,d,l,c,s];if(y&&function(t,e){var n=t[1],r=e[1],i=n|r,o=i<(g|b|O),a=r==O&&n==w||r==O&&n==S&&t[7].length<=e[8]||r==(O|S)&&e[7].length<=e[8]&&n==w;if(!o&&!a)return t;r&g&&(t[2]=e[2],i|=n&g?0:m);var l=e[3];if(l){var u=t[3];t[3]=u?to(u,l,e[4]):l,t[4]=u?Cn(t[3],f):e[4]}(l=e[5])&&(u=t[5],t[5]=u?eo(u,l,e[6]):l,t[6]=u?Cn(t[5],f):e[6]),(l=e[7])&&(t[7]=l),r&O&&(t[8]=null==t[8]?e[8]:$n(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(E,y),t=E[0],e=E[1],n=E[2],i=E[3],a=E[4],!(s=E[9]=E[9]===o?h?0:t.length:Un(E[9]-p,0))&&e&(w|_)&&(e&=~(w|_)),e&&e!=g)j=e==w||e==_?function(t,e,n){var i=so(t);return function a(){for(var l=arguments.length,u=r(l),c=l,s=zo(a);c--;)u[c]=arguments[c];var f=l<3&&u[0]!==s&&u[l-1]!==s?[]:Cn(u,s);return(l-=f.length)<n?_o(t,e,po,a.placeholder,o,u,f,o,o,n-l):Ue(this&&this!==Ie&&this instanceof a?i:t,this,u)}}(t,e,s):e!=k&&e!=(g|k)||a.length?po.apply(o,E):function(t,e,n,i){var o=e&g,a=so(t);return function e(){for(var l=-1,u=arguments.length,c=-1,s=i.length,f=r(s+u),h=this&&this!==Ie&&this instanceof e?a:t;++c<s;)f[c]=i[c];for(;u--;)f[c++]=arguments[++l];return Ue(h,o?n:this,f)}}(t,e,n,i);else var j=function(t,e,n){var r=e&g,i=so(t);return function e(){return(this&&this!==Ie&&this instanceof e?i:t).apply(r?n:this,arguments)}}(t,e,n);return aa((y?ji:ra)(j,E),t,e)}function Eo(t,e,n,r){return t===o||pl(t,le[n])&&!se.call(r,n)?e:t}function jo(t,e,n,r,i,a){return jl(t)&&jl(e)&&(a.set(e,t),di(t,e,o,jo,a),a.delete(e)),t}function Co(t){return Pl(t)?o:t}function To(t,e,n,r,i,a){var l=n&d,u=t.length,c=e.length;if(u!=c&&!(l&&c>u))return!1;var s=a.get(t);if(s&&a.get(e))return s==e;var f=-1,h=!0,p=n&y?new _r:o;for(a.set(t,e),a.set(e,t);++f<u;){var v=t[f],g=e[f];if(r)var b=l?r(g,v,f,e,t,a):r(v,g,f,t,e,a);if(b!==o){if(b)continue;h=!1;break}if(p){if(!rn(e,function(t,e){if(!mn(p,e)&&(v===t||i(v,t,n,r,a)))return p.push(e)})){h=!1;break}}else if(v!==g&&!i(v,g,n,r,a)){h=!1;break}}return a.delete(t),a.delete(e),h}function Ao(t){return oa(ta(t,o,ba),t+"")}function Po(t){return Gr(t,iu,Fo)}function Ro(t){return Gr(t,ou,No)}var Io=rr?function(t){return rr.get(t)}:zu;function Do(t){for(var e=t.name+"",n=ir[e],r=se.call(ir,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function zo(t){return(se.call(pr,"placeholder")?pr:t).placeholder}function Mo(){var t=pr.iteratee||Pu;return t=t===Pu?ui:t,arguments.length?t(arguments[0],arguments[1]):t}function Lo(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Wo(t){for(var e=iu(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Jo(i)]}return e}function Ho(t,e){var n=function(t,e){return null==t?o:t[e]}(t,e);return li(n)?n:o}var Fo=Fn?function(t){return null==t?[]:(t=ee(t),Ze(Fn(t),function(e){return De.call(t,e)}))}:qu,No=Fn?function(t){for(var e=[];t;)tn(e,Fo(t)),t=Pe(t);return e}:qu,qo=Jr;function Bo(t,e,n){for(var r=-1,i=(e=$i(e,t)).length,o=!1;++r<i;){var a=sa(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&El(i)&&$o(a,i)&&(gl(t)||yl(t))}function Vo(t){return"function"!=typeof t.constructor||Go(t)?{}:vr(Pe(t))}function Uo(t){return gl(t)||yl(t)||!!(Le&&t&&t[Le])}function $o(t,e){var n=typeof t;return!!(e=null==e?D:e)&&("number"==n||"symbol"!=n&&Xt.test(t))&&t>-1&&t%1==0&&t<e}function Yo(t,e,n){if(!jl(n))return!1;var r=typeof e;return!!("number"==r?ml(n)&&$o(e,n.length):"string"==r&&e in n)&&pl(n[e],t)}function Xo(t,e){if(gl(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!zl(t))||At.test(t)||!Tt.test(t)||null!=e&&t in ee(e)}function Ko(t){var e=Do(t),n=pr[e];if("function"!=typeof n||!(e in gr.prototype))return!1;if(t===n)return!0;var r=Io(n);return!!r&&t===r[0]}(Gn&&qo(new Gn(new ArrayBuffer(1)))!=ct||Jn&&qo(new Jn)!=Z||Qn&&"[object Promise]"!=qo(Qn.resolve())||tr&&qo(new tr)!=nt||er&&qo(new er)!=at)&&(qo=function(t){var e=Jr(t),n=e==Q?t.constructor:o,r=n?fa(n):"";if(r)switch(r){case or:return ct;case ar:return Z;case lr:return"[object Promise]";case ur:return nt;case cr:return at}return e});var Zo=ue?Ol:Bu;function Go(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||le)}function Jo(t){return t==t&&!jl(t)}function Qo(t,e){return function(n){return null!=n&&n[t]===e&&(e!==o||t in ee(n))}}function ta(t,e,n){return e=Un(e===o?t.length-1:e,0),function(){for(var i=arguments,o=-1,a=Un(i.length-e,0),l=r(a);++o<a;)l[o]=i[e+o];o=-1;for(var u=r(e+1);++o<e;)u[o]=i[o];return u[e]=n(l),Ue(t,this,u)}}function ea(t,e){return e.length<2?t:Zr(t,Ai(e,0,-1))}function na(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var ra=la(ji),ia=Ln||function(t,e){return Ie.setTimeout(t,e)},oa=la(Ci);function aa(t,e,n){var r=e+"";return oa(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(Lt,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return Ye(F,function(n){var r="_."+n[0];e&n[1]&&!Ge(t,r)&&t.push(r)}),t.sort()}(function(t){var e=t.match(Wt);return e?e[1].split(Ht):[]}(r),n)))}function la(t){var e=0,n=0;return function(){var r=Yn(),i=A-(r-n);if(n=r,i>0){if(++e>=T)return arguments[0]}else e=0;return t.apply(o,arguments)}}function ua(t,e){var n=-1,r=t.length,i=r-1;for(e=e===o?r:e;++n<e;){var a=_i(n,i),l=t[a];t[a]=t[n],t[n]=l}return t.length=e,t}var ca=function(t){var e=ll(t,function(t){return n.size===s&&n.clear(),t}),n=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Pt,function(t,n,r,i){e.push(r?i.replace(Nt,"$1"):n||t)}),e});function sa(t){if("string"==typeof t||zl(t))return t;var e=t+"";return"0"==e&&1/t==-I?"-0":e}function fa(t){if(null!=t){try{return ce.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function ha(t){if(t instanceof gr)return t.clone();var e=new yr(t.__wrapped__,t.__chain__);return e.__actions__=no(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var pa=xi(function(t,e){return wl(t)?Wr(t,Vr(e,1,wl,!0)):[]}),va=xi(function(t,e){var n=xa(e);return wl(n)&&(n=o),wl(t)?Wr(t,Vr(e,1,wl,!0),Mo(n,2)):[]}),da=xi(function(t,e){var n=xa(e);return wl(n)&&(n=o),wl(t)?Wr(t,Vr(e,1,wl,!0),o,n):[]});function ya(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Nl(n);return i<0&&(i=Un(r+i,0)),ln(t,Mo(e,3),i)}function ga(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==o&&(i=Nl(n),i=n<0?Un(r+i,0):$n(i,r-1)),ln(t,Mo(e,3),i,!0)}function ba(t){return null!=t&&t.length?Vr(t,1):[]}function ma(t){return t&&t.length?t[0]:o}var wa=xi(function(t){var e=Qe(t,Vi);return e.length&&e[0]===t[0]?ni(e):[]}),_a=xi(function(t){var e=xa(t),n=Qe(t,Vi);return e===xa(n)?e=o:n.pop(),n.length&&n[0]===t[0]?ni(n,Mo(e,2)):[]}),ka=xi(function(t){var e=xa(t),n=Qe(t,Vi);return(e="function"==typeof e?e:o)&&n.pop(),n.length&&n[0]===t[0]?ni(n,o,e):[]});function xa(t){var e=null==t?0:t.length;return e?t[e-1]:o}var Oa=xi(Sa);function Sa(t,e){return t&&t.length&&e&&e.length?mi(t,e):t}var Ea=Ao(function(t,e){var n=null==t?0:t.length,r=Ir(t,e);return wi(t,Qe(e,function(t){return $o(t,n)?+t:t}).sort(Qi)),r});function ja(t){return null==t?t:Zn.call(t)}var Ca=xi(function(t){return Li(Vr(t,1,wl,!0))}),Ta=xi(function(t){var e=xa(t);return wl(e)&&(e=o),Li(Vr(t,1,wl,!0),Mo(e,2))}),Aa=xi(function(t){var e=xa(t);return e="function"==typeof e?e:o,Li(Vr(t,1,wl,!0),o,e)});function Pa(t){if(!t||!t.length)return[];var e=0;return t=Ze(t,function(t){if(wl(t))return e=Un(t.length,e),!0}),yn(e,function(e){return Qe(t,hn(e))})}function Ra(t,e){if(!t||!t.length)return[];var n=Pa(t);return null==e?n:Qe(n,function(t){return Ue(e,o,t)})}var Ia=xi(function(t,e){return wl(t)?Wr(t,e):[]}),Da=xi(function(t){return qi(Ze(t,wl))}),za=xi(function(t){var e=xa(t);return wl(e)&&(e=o),qi(Ze(t,wl),Mo(e,2))}),Ma=xi(function(t){var e=xa(t);return e="function"==typeof e?e:o,qi(Ze(t,wl),o,e)}),La=xi(Pa);var Wa=xi(function(t){var e=t.length,n=e>1?t[e-1]:o;return n="function"==typeof n?(t.pop(),n):o,Ra(t,n)});function Ha(t){var e=pr(t);return e.__chain__=!0,e}function Fa(t,e){return e(t)}var Na=Ao(function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return Ir(e,t)};return!(e>1||this.__actions__.length)&&r instanceof gr&&$o(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:Fa,args:[i],thisArg:o}),new yr(r,this.__chain__).thru(function(t){return e&&!t.length&&t.push(o),t})):this.thru(i)});var qa=io(function(t,e,n){se.call(t,n)?++t[n]:Rr(t,n,1)});var Ba=fo(ya),Va=fo(ga);function Ua(t,e){return(gl(t)?Ye:Hr)(t,Mo(e,3))}function $a(t,e){return(gl(t)?Xe:Fr)(t,Mo(e,3))}var Ya=io(function(t,e,n){se.call(t,n)?t[n].push(e):Rr(t,n,[e])});var Xa=xi(function(t,e,n){var i=-1,o="function"==typeof e,a=ml(t)?r(t.length):[];return Hr(t,function(t){a[++i]=o?Ue(e,t,n):ri(t,e,n)}),a}),Ka=io(function(t,e,n){Rr(t,n,e)});function Za(t,e){return(gl(t)?Qe:hi)(t,Mo(e,3))}var Ga=io(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]});var Ja=xi(function(t,e){if(null==t)return[];var n=e.length;return n>1&&Yo(t,e[0],e[1])?e=[]:n>2&&Yo(e[0],e[1],e[2])&&(e=[e[0]]),gi(t,Vr(e,1),[])}),Qa=Mn||function(){return Ie.Date.now()};function tl(t,e,n){return e=n?o:e,e=t&&null==e?t.length:e,So(t,O,o,o,o,o,e)}function el(t,e){var n;if("function"!=typeof e)throw new ie(u);return t=Nl(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=o),n}}var nl=xi(function(t,e,n){var r=g;if(n.length){var i=Cn(n,zo(nl));r|=k}return So(t,r,e,n,i)}),rl=xi(function(t,e,n){var r=g|b;if(n.length){var i=Cn(n,zo(rl));r|=k}return So(e,r,t,n,i)});function il(t,e,n){var r,i,a,l,c,s,f=0,h=!1,p=!1,v=!0;if("function"!=typeof t)throw new ie(u);function d(e){var n=r,a=i;return r=i=o,f=e,l=t.apply(a,n)}function y(t){var n=t-s;return s===o||n>=e||n<0||p&&t-f>=a}function g(){var t=Qa();if(y(t))return b(t);c=ia(g,function(t){var n=e-(t-s);return p?$n(n,a-(t-f)):n}(t))}function b(t){return c=o,v&&r?d(t):(r=i=o,l)}function m(){var t=Qa(),n=y(t);if(r=arguments,i=this,s=t,n){if(c===o)return function(t){return f=t,c=ia(g,e),h?d(t):l}(s);if(p)return Ki(c),c=ia(g,e),d(s)}return c===o&&(c=ia(g,e)),l}return e=Bl(e)||0,jl(n)&&(h=!!n.leading,a=(p="maxWait"in n)?Un(Bl(n.maxWait)||0,e):a,v="trailing"in n?!!n.trailing:v),m.cancel=function(){c!==o&&Ki(c),f=0,r=s=i=c=o},m.flush=function(){return c===o?l:b(Qa())},m}var ol=xi(function(t,e){return Lr(t,1,e)}),al=xi(function(t,e,n){return Lr(t,Bl(e)||0,n)});function ll(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new ie(u);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(ll.Cache||wr),n}function ul(t){if("function"!=typeof t)throw new ie(u);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}ll.Cache=wr;var cl=Yi(function(t,e){var n=(e=1==e.length&&gl(e[0])?Qe(e[0],gn(Mo())):Qe(Vr(e,1),gn(Mo()))).length;return xi(function(r){for(var i=-1,o=$n(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return Ue(t,this,r)})}),sl=xi(function(t,e){var n=Cn(e,zo(sl));return So(t,k,o,e,n)}),fl=xi(function(t,e){var n=Cn(e,zo(fl));return So(t,x,o,e,n)}),hl=Ao(function(t,e){return So(t,S,o,o,o,e)});function pl(t,e){return t===e||t!=t&&e!=e}var vl=wo(Qr),dl=wo(function(t,e){return t>=e}),yl=ii(function(){return arguments}())?ii:function(t){return Cl(t)&&se.call(t,"callee")&&!De.call(t,"callee")},gl=r.isArray,bl=He?gn(He):function(t){return Cl(t)&&Jr(t)==ut};function ml(t){return null!=t&&El(t.length)&&!Ol(t)}function wl(t){return Cl(t)&&ml(t)}var _l=Nn||Bu,kl=Fe?gn(Fe):function(t){return Cl(t)&&Jr(t)==U};function xl(t){if(!Cl(t))return!1;var e=Jr(t);return e==Y||e==$||"string"==typeof t.message&&"string"==typeof t.name&&!Pl(t)}function Ol(t){if(!jl(t))return!1;var e=Jr(t);return e==X||e==K||e==B||e==tt}function Sl(t){return"number"==typeof t&&t==Nl(t)}function El(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=D}function jl(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Cl(t){return null!=t&&"object"==typeof t}var Tl=Ne?gn(Ne):function(t){return Cl(t)&&qo(t)==Z};function Al(t){return"number"==typeof t||Cl(t)&&Jr(t)==G}function Pl(t){if(!Cl(t)||Jr(t)!=Q)return!1;var e=Pe(t);if(null===e)return!0;var n=se.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ce.call(n)==ve}var Rl=qe?gn(qe):function(t){return Cl(t)&&Jr(t)==et};var Il=Be?gn(Be):function(t){return Cl(t)&&qo(t)==nt};function Dl(t){return"string"==typeof t||!gl(t)&&Cl(t)&&Jr(t)==rt}function zl(t){return"symbol"==typeof t||Cl(t)&&Jr(t)==it}var Ml=Ve?gn(Ve):function(t){return Cl(t)&&El(t.length)&&!!Ee[Jr(t)]};var Ll=wo(fi),Wl=wo(function(t,e){return t<=e});function Hl(t){if(!t)return[];if(ml(t))return Dl(t)?Rn(t):no(t);if(We&&t[We])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[We]());var e=qo(t);return(e==Z?En:e==nt?Tn:pu)(t)}function Fl(t){return t?(t=Bl(t))===I||t===-I?(t<0?-1:1)*z:t==t?t:0:0===t?t:0}function Nl(t){var e=Fl(t),n=e%1;return e==e?n?e-n:e:0}function ql(t){return t?Dr(Nl(t),0,L):0}function Bl(t){if("number"==typeof t)return t;if(zl(t))return M;if(jl(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=jl(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Dt,"");var n=Ut.test(t);return n||Yt.test(t)?Ae(t.slice(2),n?2:8):Vt.test(t)?M:+t}function Vl(t){return ro(t,ou(t))}function Ul(t){return null==t?"":Mi(t)}var $l=oo(function(t,e){if(Go(e)||ml(e))ro(e,iu(e),t);else for(var n in e)se.call(e,n)&&Cr(t,n,e[n])}),Yl=oo(function(t,e){ro(e,ou(e),t)}),Xl=oo(function(t,e,n,r){ro(e,ou(e),t,r)}),Kl=oo(function(t,e,n,r){ro(e,iu(e),t,r)}),Zl=Ao(Ir);var Gl=xi(function(t,e){t=ee(t);var n=-1,r=e.length,i=r>2?e[2]:o;for(i&&Yo(e[0],e[1],i)&&(r=1);++n<r;)for(var a=e[n],l=ou(a),u=-1,c=l.length;++u<c;){var s=l[u],f=t[s];(f===o||pl(f,le[s])&&!se.call(t,s))&&(t[s]=a[s])}return t}),Jl=xi(function(t){return t.push(o,jo),Ue(lu,o,t)});function Ql(t,e,n){var r=null==t?o:Zr(t,e);return r===o?n:r}function tu(t,e){return null!=t&&Bo(t,e,ei)}var eu=vo(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=pe.call(e)),t[e]=n},ju(Au)),nu=vo(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=pe.call(e)),se.call(t,e)?t[e].push(n):t[e]=[n]},Mo),ru=xi(ri);function iu(t){return ml(t)?xr(t):ci(t)}function ou(t){return ml(t)?xr(t,!0):si(t)}var au=oo(function(t,e,n){di(t,e,n)}),lu=oo(function(t,e,n,r){di(t,e,n,r)}),uu=Ao(function(t,e){var n={};if(null==t)return n;var r=!1;e=Qe(e,function(e){return e=$i(e,t),r||(r=e.length>1),e}),ro(t,Ro(t),n),r&&(n=zr(n,h|p|v,Co));for(var i=e.length;i--;)Wi(n,e[i]);return n});var cu=Ao(function(t,e){return null==t?{}:function(t,e){return bi(t,e,function(e,n){return tu(t,n)})}(t,e)});function su(t,e){if(null==t)return{};var n=Qe(Ro(t),function(t){return[t]});return e=Mo(e),bi(t,n,function(t,n){return e(t,n[0])})}var fu=Oo(iu),hu=Oo(ou);function pu(t){return null==t?[]:bn(t,iu(t))}var vu=co(function(t,e,n){return e=e.toLowerCase(),t+(n?du(e):e)});function du(t){return xu(Ul(t).toLowerCase())}function yu(t){return(t=Ul(t))&&t.replace(Kt,kn).replace(me,"")}var gu=co(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),bu=co(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),mu=uo("toLowerCase");var wu=co(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()});var _u=co(function(t,e,n){return t+(n?" ":"")+xu(e)});var ku=co(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),xu=uo("toUpperCase");function Ou(t,e,n){return t=Ul(t),(e=n?o:e)===o?function(t){return xe.test(t)}(t)?function(t){return t.match(_e)||[]}(t):function(t){return t.match(Ft)||[]}(t):t.match(e)||[]}var Su=xi(function(t,e){try{return Ue(t,o,e)}catch(t){return xl(t)?t:new Jt(t)}}),Eu=Ao(function(t,e){return Ye(e,function(e){e=sa(e),Rr(t,e,nl(t[e],t))}),t});function ju(t){return function(){return t}}var Cu=ho(),Tu=ho(!0);function Au(t){return t}function Pu(t){return ui("function"==typeof t?t:zr(t,h))}var Ru=xi(function(t,e){return function(n){return ri(n,t,e)}}),Iu=xi(function(t,e){return function(n){return ri(t,n,e)}});function Du(t,e,n){var r=iu(e),i=Kr(e,r);null!=n||jl(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=Kr(e,iu(e)));var o=!(jl(n)&&"chain"in n&&!n.chain),a=Ol(t);return Ye(i,function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=no(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,tn([this.value()],arguments))})}),t}function zu(){}var Mu=go(Qe),Lu=go(Ke),Wu=go(rn);function Hu(t){return Xo(t)?hn(sa(t)):function(t){return function(e){return Zr(e,t)}}(t)}var Fu=mo(),Nu=mo(!0);function qu(){return[]}function Bu(){return!1}var Vu=yo(function(t,e){return t+e},0),Uu=ko("ceil"),$u=yo(function(t,e){return t/e},1),Yu=ko("floor");var Xu,Ku=yo(function(t,e){return t*e},1),Zu=ko("round"),Gu=yo(function(t,e){return t-e},0);return pr.after=function(t,e){if("function"!=typeof e)throw new ie(u);return t=Nl(t),function(){if(--t<1)return e.apply(this,arguments)}},pr.ary=tl,pr.assign=$l,pr.assignIn=Yl,pr.assignInWith=Xl,pr.assignWith=Kl,pr.at=Zl,pr.before=el,pr.bind=nl,pr.bindAll=Eu,pr.bindKey=rl,pr.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return gl(t)?t:[t]},pr.chain=Ha,pr.chunk=function(t,e,n){e=(n?Yo(t,e,n):e===o)?1:Un(Nl(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var a=0,l=0,u=r(Wn(i/e));a<i;)u[l++]=Ai(t,a,a+=e);return u},pr.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},pr.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return tn(gl(n)?no(n):[n],Vr(e,1))},pr.cond=function(t){var e=null==t?0:t.length,n=Mo();return t=e?Qe(t,function(t){if("function"!=typeof t[1])throw new ie(u);return[n(t[0]),t[1]]}):[],xi(function(n){for(var r=-1;++r<e;){var i=t[r];if(Ue(i[0],this,n))return Ue(i[1],this,n)}})},pr.conforms=function(t){return function(t){var e=iu(t);return function(n){return Mr(n,t,e)}}(zr(t,h))},pr.constant=ju,pr.countBy=qa,pr.create=function(t,e){var n=vr(t);return null==e?n:Pr(n,e)},pr.curry=function t(e,n,r){var i=So(e,w,o,o,o,o,o,n=r?o:n);return i.placeholder=t.placeholder,i},pr.curryRight=function t(e,n,r){var i=So(e,_,o,o,o,o,o,n=r?o:n);return i.placeholder=t.placeholder,i},pr.debounce=il,pr.defaults=Gl,pr.defaultsDeep=Jl,pr.defer=ol,pr.delay=al,pr.difference=pa,pr.differenceBy=va,pr.differenceWith=da,pr.drop=function(t,e,n){var r=null==t?0:t.length;return r?Ai(t,(e=n||e===o?1:Nl(e))<0?0:e,r):[]},pr.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?Ai(t,0,(e=r-(e=n||e===o?1:Nl(e)))<0?0:e):[]},pr.dropRightWhile=function(t,e){return t&&t.length?Fi(t,Mo(e,3),!0,!0):[]},pr.dropWhile=function(t,e){return t&&t.length?Fi(t,Mo(e,3),!0):[]},pr.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&Yo(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=Nl(n))<0&&(n=-n>i?0:i+n),(r=r===o||r>i?i:Nl(r))<0&&(r+=i),r=n>r?0:ql(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},pr.filter=function(t,e){return(gl(t)?Ze:Br)(t,Mo(e,3))},pr.flatMap=function(t,e){return Vr(Za(t,e),1)},pr.flatMapDeep=function(t,e){return Vr(Za(t,e),I)},pr.flatMapDepth=function(t,e,n){return n=n===o?1:Nl(n),Vr(Za(t,e),n)},pr.flatten=ba,pr.flattenDeep=function(t){return null!=t&&t.length?Vr(t,I):[]},pr.flattenDepth=function(t,e){return null!=t&&t.length?Vr(t,e=e===o?1:Nl(e)):[]},pr.flip=function(t){return So(t,E)},pr.flow=Cu,pr.flowRight=Tu,pr.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},pr.functions=function(t){return null==t?[]:Kr(t,iu(t))},pr.functionsIn=function(t){return null==t?[]:Kr(t,ou(t))},pr.groupBy=Ya,pr.initial=function(t){return null!=t&&t.length?Ai(t,0,-1):[]},pr.intersection=wa,pr.intersectionBy=_a,pr.intersectionWith=ka,pr.invert=eu,pr.invertBy=nu,pr.invokeMap=Xa,pr.iteratee=Pu,pr.keyBy=Ka,pr.keys=iu,pr.keysIn=ou,pr.map=Za,pr.mapKeys=function(t,e){var n={};return e=Mo(e,3),Yr(t,function(t,r,i){Rr(n,e(t,r,i),t)}),n},pr.mapValues=function(t,e){var n={};return e=Mo(e,3),Yr(t,function(t,r,i){Rr(n,r,e(t,r,i))}),n},pr.matches=function(t){return pi(zr(t,h))},pr.matchesProperty=function(t,e){return vi(t,zr(e,h))},pr.memoize=ll,pr.merge=au,pr.mergeWith=lu,pr.method=Ru,pr.methodOf=Iu,pr.mixin=Du,pr.negate=ul,pr.nthArg=function(t){return t=Nl(t),xi(function(e){return yi(e,t)})},pr.omit=uu,pr.omitBy=function(t,e){return su(t,ul(Mo(e)))},pr.once=function(t){return el(2,t)},pr.orderBy=function(t,e,n,r){return null==t?[]:(gl(e)||(e=null==e?[]:[e]),gl(n=r?o:n)||(n=null==n?[]:[n]),gi(t,e,n))},pr.over=Mu,pr.overArgs=cl,pr.overEvery=Lu,pr.overSome=Wu,pr.partial=sl,pr.partialRight=fl,pr.partition=Ga,pr.pick=cu,pr.pickBy=su,pr.property=Hu,pr.propertyOf=function(t){return function(e){return null==t?o:Zr(t,e)}},pr.pull=Oa,pr.pullAll=Sa,pr.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?mi(t,e,Mo(n,2)):t},pr.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?mi(t,e,o,n):t},pr.pullAt=Ea,pr.range=Fu,pr.rangeRight=Nu,pr.rearg=hl,pr.reject=function(t,e){return(gl(t)?Ze:Br)(t,ul(Mo(e,3)))},pr.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Mo(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return wi(t,i),n},pr.rest=function(t,e){if("function"!=typeof t)throw new ie(u);return xi(t,e=e===o?e:Nl(e))},pr.reverse=ja,pr.sampleSize=function(t,e,n){return e=(n?Yo(t,e,n):e===o)?1:Nl(e),(gl(t)?Sr:Si)(t,e)},pr.set=function(t,e,n){return null==t?t:Ei(t,e,n)},pr.setWith=function(t,e,n,r){return r="function"==typeof r?r:o,null==t?t:Ei(t,e,n,r)},pr.shuffle=function(t){return(gl(t)?Er:Ti)(t)},pr.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&Yo(t,e,n)?(e=0,n=r):(e=null==e?0:Nl(e),n=n===o?r:Nl(n)),Ai(t,e,n)):[]},pr.sortBy=Ja,pr.sortedUniq=function(t){return t&&t.length?Di(t):[]},pr.sortedUniqBy=function(t,e){return t&&t.length?Di(t,Mo(e,2)):[]},pr.split=function(t,e,n){return n&&"number"!=typeof n&&Yo(t,e,n)&&(e=n=o),(n=n===o?L:n>>>0)?(t=Ul(t))&&("string"==typeof e||null!=e&&!Rl(e))&&!(e=Mi(e))&&Sn(t)?Xi(Rn(t),0,n):t.split(e,n):[]},pr.spread=function(t,e){if("function"!=typeof t)throw new ie(u);return e=null==e?0:Un(Nl(e),0),xi(function(n){var r=n[e],i=Xi(n,0,e);return r&&tn(i,r),Ue(t,this,i)})},pr.tail=function(t){var e=null==t?0:t.length;return e?Ai(t,1,e):[]},pr.take=function(t,e,n){return t&&t.length?Ai(t,0,(e=n||e===o?1:Nl(e))<0?0:e):[]},pr.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?Ai(t,(e=r-(e=n||e===o?1:Nl(e)))<0?0:e,r):[]},pr.takeRightWhile=function(t,e){return t&&t.length?Fi(t,Mo(e,3),!1,!0):[]},pr.takeWhile=function(t,e){return t&&t.length?Fi(t,Mo(e,3)):[]},pr.tap=function(t,e){return e(t),t},pr.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new ie(u);return jl(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),il(t,e,{leading:r,maxWait:e,trailing:i})},pr.thru=Fa,pr.toArray=Hl,pr.toPairs=fu,pr.toPairsIn=hu,pr.toPath=function(t){return gl(t)?Qe(t,sa):zl(t)?[t]:no(ca(Ul(t)))},pr.toPlainObject=Vl,pr.transform=function(t,e,n){var r=gl(t),i=r||_l(t)||Ml(t);if(e=Mo(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:jl(t)&&Ol(o)?vr(Pe(t)):{}}return(i?Ye:Yr)(t,function(t,r,i){return e(n,t,r,i)}),n},pr.unary=function(t){return tl(t,1)},pr.union=Ca,pr.unionBy=Ta,pr.unionWith=Aa,pr.uniq=function(t){return t&&t.length?Li(t):[]},pr.uniqBy=function(t,e){return t&&t.length?Li(t,Mo(e,2)):[]},pr.uniqWith=function(t,e){return e="function"==typeof e?e:o,t&&t.length?Li(t,o,e):[]},pr.unset=function(t,e){return null==t||Wi(t,e)},pr.unzip=Pa,pr.unzipWith=Ra,pr.update=function(t,e,n){return null==t?t:Hi(t,e,Ui(n))},pr.updateWith=function(t,e,n,r){return r="function"==typeof r?r:o,null==t?t:Hi(t,e,Ui(n),r)},pr.values=pu,pr.valuesIn=function(t){return null==t?[]:bn(t,ou(t))},pr.without=Ia,pr.words=Ou,pr.wrap=function(t,e){return sl(Ui(e),t)},pr.xor=Da,pr.xorBy=za,pr.xorWith=Ma,pr.zip=La,pr.zipObject=function(t,e){return Bi(t||[],e||[],Cr)},pr.zipObjectDeep=function(t,e){return Bi(t||[],e||[],Ei)},pr.zipWith=Wa,pr.entries=fu,pr.entriesIn=hu,pr.extend=Yl,pr.extendWith=Xl,Du(pr,pr),pr.add=Vu,pr.attempt=Su,pr.camelCase=vu,pr.capitalize=du,pr.ceil=Uu,pr.clamp=function(t,e,n){return n===o&&(n=e,e=o),n!==o&&(n=(n=Bl(n))==n?n:0),e!==o&&(e=(e=Bl(e))==e?e:0),Dr(Bl(t),e,n)},pr.clone=function(t){return zr(t,v)},pr.cloneDeep=function(t){return zr(t,h|v)},pr.cloneDeepWith=function(t,e){return zr(t,h|v,e="function"==typeof e?e:o)},pr.cloneWith=function(t,e){return zr(t,v,e="function"==typeof e?e:o)},pr.conformsTo=function(t,e){return null==e||Mr(t,e,iu(e))},pr.deburr=yu,pr.defaultTo=function(t,e){return null==t||t!=t?e:t},pr.divide=$u,pr.endsWith=function(t,e,n){t=Ul(t),e=Mi(e);var r=t.length,i=n=n===o?r:Dr(Nl(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e},pr.eq=pl,pr.escape=function(t){return(t=Ul(t))&&St.test(t)?t.replace(xt,xn):t},pr.escapeRegExp=function(t){return(t=Ul(t))&&It.test(t)?t.replace(Rt,"\\$&"):t},pr.every=function(t,e,n){var r=gl(t)?Ke:Nr;return n&&Yo(t,e,n)&&(e=o),r(t,Mo(e,3))},pr.find=Ba,pr.findIndex=ya,pr.findKey=function(t,e){return an(t,Mo(e,3),Yr)},pr.findLast=Va,pr.findLastIndex=ga,pr.findLastKey=function(t,e){return an(t,Mo(e,3),Xr)},pr.floor=Yu,pr.forEach=Ua,pr.forEachRight=$a,pr.forIn=function(t,e){return null==t?t:Ur(t,Mo(e,3),ou)},pr.forInRight=function(t,e){return null==t?t:$r(t,Mo(e,3),ou)},pr.forOwn=function(t,e){return t&&Yr(t,Mo(e,3))},pr.forOwnRight=function(t,e){return t&&Xr(t,Mo(e,3))},pr.get=Ql,pr.gt=vl,pr.gte=dl,pr.has=function(t,e){return null!=t&&Bo(t,e,ti)},pr.hasIn=tu,pr.head=ma,pr.identity=Au,pr.includes=function(t,e,n,r){t=ml(t)?t:pu(t),n=n&&!r?Nl(n):0;var i=t.length;return n<0&&(n=Un(i+n,0)),Dl(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&un(t,e,n)>-1},pr.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Nl(n);return i<0&&(i=Un(r+i,0)),un(t,e,i)},pr.inRange=function(t,e,n){return e=Fl(e),n===o?(n=e,e=0):n=Fl(n),function(t,e,n){return t>=$n(e,n)&&t<Un(e,n)}(t=Bl(t),e,n)},pr.invoke=ru,pr.isArguments=yl,pr.isArray=gl,pr.isArrayBuffer=bl,pr.isArrayLike=ml,pr.isArrayLikeObject=wl,pr.isBoolean=function(t){return!0===t||!1===t||Cl(t)&&Jr(t)==V},pr.isBuffer=_l,pr.isDate=kl,pr.isElement=function(t){return Cl(t)&&1===t.nodeType&&!Pl(t)},pr.isEmpty=function(t){if(null==t)return!0;if(ml(t)&&(gl(t)||"string"==typeof t||"function"==typeof t.splice||_l(t)||Ml(t)||yl(t)))return!t.length;var e=qo(t);if(e==Z||e==nt)return!t.size;if(Go(t))return!ci(t).length;for(var n in t)if(se.call(t,n))return!1;return!0},pr.isEqual=function(t,e){return oi(t,e)},pr.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:o)?n(t,e):o;return r===o?oi(t,e,o,n):!!r},pr.isError=xl,pr.isFinite=function(t){return"number"==typeof t&&qn(t)},pr.isFunction=Ol,pr.isInteger=Sl,pr.isLength=El,pr.isMap=Tl,pr.isMatch=function(t,e){return t===e||ai(t,e,Wo(e))},pr.isMatchWith=function(t,e,n){return n="function"==typeof n?n:o,ai(t,e,Wo(e),n)},pr.isNaN=function(t){return Al(t)&&t!=+t},pr.isNative=function(t){if(Zo(t))throw new Jt(l);return li(t)},pr.isNil=function(t){return null==t},pr.isNull=function(t){return null===t},pr.isNumber=Al,pr.isObject=jl,pr.isObjectLike=Cl,pr.isPlainObject=Pl,pr.isRegExp=Rl,pr.isSafeInteger=function(t){return Sl(t)&&t>=-D&&t<=D},pr.isSet=Il,pr.isString=Dl,pr.isSymbol=zl,pr.isTypedArray=Ml,pr.isUndefined=function(t){return t===o},pr.isWeakMap=function(t){return Cl(t)&&qo(t)==at},pr.isWeakSet=function(t){return Cl(t)&&Jr(t)==lt},pr.join=function(t,e){return null==t?"":Bn.call(t,e)},pr.kebabCase=gu,pr.last=xa,pr.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==o&&(i=(i=Nl(n))<0?Un(r+i,0):$n(i,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,i):ln(t,sn,i,!0)},pr.lowerCase=bu,pr.lowerFirst=mu,pr.lt=Ll,pr.lte=Wl,pr.max=function(t){return t&&t.length?qr(t,Au,Qr):o},pr.maxBy=function(t,e){return t&&t.length?qr(t,Mo(e,2),Qr):o},pr.mean=function(t){return fn(t,Au)},pr.meanBy=function(t,e){return fn(t,Mo(e,2))},pr.min=function(t){return t&&t.length?qr(t,Au,fi):o},pr.minBy=function(t,e){return t&&t.length?qr(t,Mo(e,2),fi):o},pr.stubArray=qu,pr.stubFalse=Bu,pr.stubObject=function(){return{}},pr.stubString=function(){return""},pr.stubTrue=function(){return!0},pr.multiply=Ku,pr.nth=function(t,e){return t&&t.length?yi(t,Nl(e)):o},pr.noConflict=function(){return Ie._===this&&(Ie._=de),this},pr.noop=zu,pr.now=Qa,pr.pad=function(t,e,n){t=Ul(t);var r=(e=Nl(e))?Pn(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return bo(Hn(i),n)+t+bo(Wn(i),n)},pr.padEnd=function(t,e,n){t=Ul(t);var r=(e=Nl(e))?Pn(t):0;return e&&r<e?t+bo(e-r,n):t},pr.padStart=function(t,e,n){t=Ul(t);var r=(e=Nl(e))?Pn(t):0;return e&&r<e?bo(e-r,n)+t:t},pr.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),Xn(Ul(t).replace(zt,""),e||0)},pr.random=function(t,e,n){if(n&&"boolean"!=typeof n&&Yo(t,e,n)&&(e=n=o),n===o&&("boolean"==typeof e?(n=e,e=o):"boolean"==typeof t&&(n=t,t=o)),t===o&&e===o?(t=0,e=1):(t=Fl(t),e===o?(e=t,t=0):e=Fl(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=Kn();return $n(t+i*(e-t+Te("1e-"+((i+"").length-1))),e)}return _i(t,e)},pr.reduce=function(t,e,n){var r=gl(t)?en:vn,i=arguments.length<3;return r(t,Mo(e,4),n,i,Hr)},pr.reduceRight=function(t,e,n){var r=gl(t)?nn:vn,i=arguments.length<3;return r(t,Mo(e,4),n,i,Fr)},pr.repeat=function(t,e,n){return e=(n?Yo(t,e,n):e===o)?1:Nl(e),ki(Ul(t),e)},pr.replace=function(){var t=arguments,e=Ul(t[0]);return t.length<3?e:e.replace(t[1],t[2])},pr.result=function(t,e,n){var r=-1,i=(e=$i(e,t)).length;for(i||(i=1,t=o);++r<i;){var a=null==t?o:t[sa(e[r])];a===o&&(r=i,a=n),t=Ol(a)?a.call(t):a}return t},pr.round=Zu,pr.runInContext=t,pr.sample=function(t){return(gl(t)?Or:Oi)(t)},pr.size=function(t){if(null==t)return 0;if(ml(t))return Dl(t)?Pn(t):t.length;var e=qo(t);return e==Z||e==nt?t.size:ci(t).length},pr.snakeCase=wu,pr.some=function(t,e,n){var r=gl(t)?rn:Pi;return n&&Yo(t,e,n)&&(e=o),r(t,Mo(e,3))},pr.sortedIndex=function(t,e){return Ri(t,e)},pr.sortedIndexBy=function(t,e,n){return Ii(t,e,Mo(n,2))},pr.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=Ri(t,e);if(r<n&&pl(t[r],e))return r}return-1},pr.sortedLastIndex=function(t,e){return Ri(t,e,!0)},pr.sortedLastIndexBy=function(t,e,n){return Ii(t,e,Mo(n,2),!0)},pr.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=Ri(t,e,!0)-1;if(pl(t[n],e))return n}return-1},pr.startCase=_u,pr.startsWith=function(t,e,n){return t=Ul(t),n=null==n?0:Dr(Nl(n),0,t.length),e=Mi(e),t.slice(n,n+e.length)==e},pr.subtract=Gu,pr.sum=function(t){return t&&t.length?dn(t,Au):0},pr.sumBy=function(t,e){return t&&t.length?dn(t,Mo(e,2)):0},pr.template=function(t,e,n){var r=pr.templateSettings;n&&Yo(t,e,n)&&(e=o),t=Ul(t),e=Xl({},e,r,Eo);var i,a,l=Xl({},e.imports,r.imports,Eo),u=iu(l),c=bn(l,u),s=0,f=e.interpolate||Zt,h="__p += '",p=ne((e.escape||Zt).source+"|"+f.source+"|"+(f===Ct?qt:Zt).source+"|"+(e.evaluate||Zt).source+"|$","g"),v="//# sourceURL="+(se.call(e,"sourceURL")?(e.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++Se+"]")+"\n";t.replace(p,function(e,n,r,o,l,u){return r||(r=o),h+=t.slice(s,u).replace(Gt,On),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),l&&(a=!0,h+="';\n"+l+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),s=u+e.length,e}),h+="';\n";var d=se.call(e,"variable")&&e.variable;d||(h="with (obj) {\n"+h+"\n}\n"),h=(a?h.replace(mt,""):h).replace(wt,"$1").replace(_t,"$1;"),h="function("+(d||"obj")+") {\n"+(d?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var y=Su(function(){return Qt(u,v+"return "+h).apply(o,c)});if(y.source=h,xl(y))throw y;return y},pr.times=function(t,e){if((t=Nl(t))<1||t>D)return[];var n=L,r=$n(t,L);e=Mo(e),t-=L;for(var i=yn(r,e);++n<t;)e(n);return i},pr.toFinite=Fl,pr.toInteger=Nl,pr.toLength=ql,pr.toLower=function(t){return Ul(t).toLowerCase()},pr.toNumber=Bl,pr.toSafeInteger=function(t){return t?Dr(Nl(t),-D,D):0===t?t:0},pr.toString=Ul,pr.toUpper=function(t){return Ul(t).toUpperCase()},pr.trim=function(t,e,n){if((t=Ul(t))&&(n||e===o))return t.replace(Dt,"");if(!t||!(e=Mi(e)))return t;var r=Rn(t),i=Rn(e);return Xi(r,wn(r,i),_n(r,i)+1).join("")},pr.trimEnd=function(t,e,n){if((t=Ul(t))&&(n||e===o))return t.replace(Mt,"");if(!t||!(e=Mi(e)))return t;var r=Rn(t);return Xi(r,0,_n(r,Rn(e))+1).join("")},pr.trimStart=function(t,e,n){if((t=Ul(t))&&(n||e===o))return t.replace(zt,"");if(!t||!(e=Mi(e)))return t;var r=Rn(t);return Xi(r,wn(r,Rn(e))).join("")},pr.truncate=function(t,e){var n=j,r=C;if(jl(e)){var i="separator"in e?e.separator:i;n="length"in e?Nl(e.length):n,r="omission"in e?Mi(e.omission):r}var a=(t=Ul(t)).length;if(Sn(t)){var l=Rn(t);a=l.length}if(n>=a)return t;var u=n-Pn(r);if(u<1)return r;var c=l?Xi(l,0,u).join(""):t.slice(0,u);if(i===o)return c+r;if(l&&(u+=c.length-u),Rl(i)){if(t.slice(u).search(i)){var s,f=c;for(i.global||(i=ne(i.source,Ul(Bt.exec(i))+"g")),i.lastIndex=0;s=i.exec(f);)var h=s.index;c=c.slice(0,h===o?u:h)}}else if(t.indexOf(Mi(i),u)!=u){var p=c.lastIndexOf(i);p>-1&&(c=c.slice(0,p))}return c+r},pr.unescape=function(t){return(t=Ul(t))&&Ot.test(t)?t.replace(kt,In):t},pr.uniqueId=function(t){var e=++fe;return Ul(t)+e},pr.upperCase=ku,pr.upperFirst=xu,pr.each=Ua,pr.eachRight=$a,pr.first=ma,Du(pr,(Xu={},Yr(pr,function(t,e){se.call(pr.prototype,e)||(Xu[e]=t)}),Xu),{chain:!1}),pr.VERSION="4.17.14",Ye(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){pr[t].placeholder=pr}),Ye(["drop","take"],function(t,e){gr.prototype[t]=function(n){n=n===o?1:Un(Nl(n),0);var r=this.__filtered__&&!e?new gr(this):this.clone();return r.__filtered__?r.__takeCount__=$n(n,r.__takeCount__):r.__views__.push({size:$n(n,L),type:t+(r.__dir__<0?"Right":"")}),r},gr.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),Ye(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n==P||3==n;gr.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Mo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),Ye(["head","last"],function(t,e){var n="take"+(e?"Right":"");gr.prototype[t]=function(){return this[n](1).value()[0]}}),Ye(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");gr.prototype[t]=function(){return this.__filtered__?new gr(this):this[n](1)}}),gr.prototype.compact=function(){return this.filter(Au)},gr.prototype.find=function(t){return this.filter(t).head()},gr.prototype.findLast=function(t){return this.reverse().find(t)},gr.prototype.invokeMap=xi(function(t,e){return"function"==typeof t?new gr(this):this.map(function(n){return ri(n,t,e)})}),gr.prototype.reject=function(t){return this.filter(ul(Mo(t)))},gr.prototype.slice=function(t,e){t=Nl(t);var n=this;return n.__filtered__&&(t>0||e<0)?new gr(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==o&&(n=(e=Nl(e))<0?n.dropRight(-e):n.take(e-t)),n)},gr.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},gr.prototype.toArray=function(){return this.take(L)},Yr(gr.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=pr[r?"take"+("last"==e?"Right":""):e],a=r||/^find/.test(e);i&&(pr.prototype[e]=function(){var e=this.__wrapped__,l=r?[1]:arguments,u=e instanceof gr,c=l[0],s=u||gl(e),f=function(t){var e=i.apply(pr,tn([t],l));return r&&h?e[0]:e};s&&n&&"function"==typeof c&&1!=c.length&&(u=s=!1);var h=this.__chain__,p=!!this.__actions__.length,v=a&&!h,d=u&&!p;if(!a&&s){e=d?e:new gr(this);var y=t.apply(e,l);return y.__actions__.push({func:Fa,args:[f],thisArg:o}),new yr(y,h)}return v&&d?t.apply(this,l):(y=this.thru(f),v?r?y.value()[0]:y.value():y)})}),Ye(["pop","push","shift","sort","splice","unshift"],function(t){var e=oe[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);pr.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(gl(i)?i:[],t)}return this[n](function(n){return e.apply(gl(n)?n:[],t)})}}),Yr(gr.prototype,function(t,e){var n=pr[e];if(n){var r=n.name+"";se.call(ir,r)||(ir[r]=[]),ir[r].push({name:e,func:n})}}),ir[po(o,b).name]=[{name:"wrapper",func:o}],gr.prototype.clone=function(){var t=new gr(this.__wrapped__);return t.__actions__=no(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=no(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=no(this.__views__),t},gr.prototype.reverse=function(){if(this.__filtered__){var t=new gr(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},gr.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=gl(t),r=e<0,i=n?t.length:0,o=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=$n(e,t+a);break;case"takeRight":t=Un(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,l=o.end,u=l-a,c=r?l:a-1,s=this.__iteratees__,f=s.length,h=0,p=$n(u,this.__takeCount__);if(!n||!r&&i==u&&p==u)return Ni(t,this.__actions__);var v=[];t:for(;u--&&h<p;){for(var d=-1,y=t[c+=e];++d<f;){var g=s[d],b=g.iteratee,m=g.type,w=b(y);if(m==R)y=w;else if(!w){if(m==P)continue t;break t}}v[h++]=y}return v},pr.prototype.at=Na,pr.prototype.chain=function(){return Ha(this)},pr.prototype.commit=function(){return new yr(this.value(),this.__chain__)},pr.prototype.next=function(){this.__values__===o&&(this.__values__=Hl(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?o:this.__values__[this.__index__++]}},pr.prototype.plant=function(t){for(var e,n=this;n instanceof dr;){var r=ha(n);r.__index__=0,r.__values__=o,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},pr.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof gr){var e=t;return this.__actions__.length&&(e=new gr(this)),(e=e.reverse()).__actions__.push({func:Fa,args:[ja],thisArg:o}),new yr(e,this.__chain__)}return this.thru(ja)},pr.prototype.toJSON=pr.prototype.valueOf=pr.prototype.value=function(){return Ni(this.__wrapped__,this.__actions__)},pr.prototype.first=pr.prototype.head,We&&(pr.prototype[We]=function(){return this}),pr}();Ie._=Dn,(i=function(){return Dn}.call(e,n,e,r))===o||(r.exports=i)}).call(this)}).call(this,n(2),n(3)(t))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e);var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.data={}}var e,n,o;return e=t,(n=[{key:"setHtml",value:function(t){this.el.innerHTML=t}},{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var n=r(t.split(".")),i=n[0],o=n.slice(1),a=i;return"mousewheel"===a&&/Firefox/i.test(window.navigator.userAgent)&&(a="DOMMouseScroll"),this.el.addEventListener(a,function(t){e(t);for(var n=0;n<o.length;n+=1){var r=o[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}}),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach(function(n){e.css(n,"".concat(t[n],"px"))}),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach(function(e){return t.child(e)}),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach(function(e){n.el.setAttribute(e,t[e])})}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){return t.el.style.removeProperty(e)}),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach(function(e){n.el.style[e]=t[e]}),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&i(e.prototype,n),o&&i(e,o),t}(),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new o(t,e)};n(0);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var u=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function c(t){for(var e="",n=t;n>=u.length;)n/=u.length,n-=1,e+=u[parseInt(n,10)%u.length];var r=t%u.length;return e+=u[r]}function s(t){for(var e=0,n=0;n<t.length-1;n+=1){var r=t.charCodeAt(n)-65,i=t.length-1-n;e+=Math.pow(u.length,i)+u.length*r}return e+=t.charCodeAt(t.length-1)-65}function f(t){for(var e="",n="",r=0;r<t.length;r+=1)t.charAt(r)>="0"&&t.charAt(r)<="9"?n+=t.charAt(r):e+=t.charAt(r);return[s(e),parseInt(n,10)-1]}function h(t,e){return"".concat(c(t)).concat(e+1)}function p(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===n)return t;var i=l(f(t),2),o=i[0],a=i[1];return r(o,a)?h(o+e,a+n):t}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var y=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=i,this.w=o,this.h=a}var e,n,r;return e=t,r=[{key:"valueOf",value:function(e){var n=e.split(":"),r=v(f(n[0]),2),i=r[0],o=r[1],a=o,l=i;if(n.length>1){var u=v(f(n[1]),2);l=u[0],a=u[1]}return new t(o,i,a,l)}}],(n=[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(1===r.length){var o=f(r[0]),a=v(o,2);e=a[0],t=a[1]}else 2===r.length&&(t=r[0],e=r[1]);var l=this.sri,u=this.sci,c=this.eri,s=this.eci;return l<=t&&t<=c&&u<=e&&e<=s}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,i=this.eri,o=this.eci,a=n;a<=i;a+=1)if(e(a))for(var l=r;l<=o;l+=1)t(a,l)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,i=this.eri,o=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>i?e.eri:i,e.eci>o?e.eci:o)}},{key:"difference",value:function(e){var n=[],r=function(e,r,i,o){n.push(new t(e,r,i,o))},i=this.sri,o=this.sci,a=this.eri,l=this.eci,u=e.sri-i,c=e.sci-o,s=a-e.eri,f=l-e.eci;return u>0?(r(i,o,e.sri-1,l),s>0?(r(e.eri+1,o,a,l),c>0&&r(e.sri,o,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,l)):(c>0&&r(e.sri,o,a,e.sci-1),f>0&&r(e.sri,e.eci+1,a,l))):s>0&&(r(e.eri+1,o,a,l),c>0&&r(i,o,e.eri,e.sci-1),f>0&&r(i,e.eci+1,e.eri,l)),c>0?(r(i,o,a,e.sci-1),f>0?(r(i,e.eri+1,a,l),u>0&&r(i,e.sci,e.sri-1,e.eci),s>0&&r(e.sri+1,e.sci,a,e.eci)):(u>0&&r(i,e.sci,e.sri-1,l),s>0&&r(e.sri+1,e.sci,a,l))):f>0&&(r(a,e.eci+1,a,l),u>0&&r(i,o,e.sri-1,e.eci),s>0&&r(e.eri+1,o,a,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,i=h(e,t);return this.multiple()&&(i="".concat(i,":").concat(h(r,n))),i}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&d(e.prototype,n),r&&d(e,r),t}();function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var b=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new y(0,0,0,0),this.ri=0,this.ci=0}var e,n,r;return e=t,(n=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&g(e.prototype,n),r&&g(e,r),t}();var m=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0};function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]}var e,n,r;return e=t,(n=[{key:"add",value:function(t){this.undoItems.push(t),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canUndo()&&(r.push(t),e(n.pop()))}},{key:"redo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canRedo()&&(n.push(t),e(r.pop()))}}])&&w(e.prototype,n),r&&w(e,r),t}();function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"}var e,n,r;return e=t,(n=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&k(e.prototype,n),r&&k(e,r),t}();function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function E(t,e,n){return e&&S(t.prototype,e),n&&S(t,n),t}var j=function(){function t(e,n,r){O(this,t),this.ci=e,this.operator=n,this.value=r}return E(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),C=function(){function t(e,n){O(this,t),this.ci=e,this.order=n}return E(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),T=function(){function t(){O(this,t),this.ref=null,this.filters=[],this.sort=null}return E(t,[{key:"setData",value:function(t){var e=t.ref,n=t.filters,r=t.sort;null!=e&&(this.ref=e,this.fitlers=n.map(function(t){return new j(t.ci,t.operator,t.value)}),r&&(this.sort=new C(r.ci,r.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map(function(t){return t.getData()}),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var r=this.getFilter(t);null==r?this.filters.push(new j(t,e,n)):r.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new C(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=this.filters,l=i+1;l<=o;l+=1)for(var u=0;u<a.length;u+=1){var c=a[u],s=t(l,c.ci),f=s?s.text:"";if(!c.includes(f)){e.add(l);break}n.add(l)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=i+1;a<=o;a+=1){var l=e(a,t);if(null===l||/^\s*$/.test(l.text))n[""]=(n[""]||0)+1;else{var u=l.text,c=(n[u]||0)+1;n[u]=c}}return n}},{key:"range",value:function(){return y.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var P=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=e}var e,n,r;return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter(function(e){return!e.within(t)})}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter(function(t){return t.intersects(e)}))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1){if(this._[e].intersects(t))return!0}return!1}},{key:"union",value:function(t){var e=t;return this._.forEach(function(t){t.intersects(e)&&(e=t.union(e))}),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,n,r){this._.forEach(function(i){var o=i.sri,a=i.sci,l=i.eri,u=i.eci,c=i;"row"===t?o>=e?(c.sri+=n,c.eri+=n):o<e&&e<=l&&(c.eri+=n,r(o,a,n,0)):"column"===t&&(a>=e?(c.sci+=n,c.eci+=n):a<e&&e<=u&&(c.eci+=n,r(o,a,0,n)))})}},{key:"move",value:function(t,e,n){this._.forEach(function(r){var i=r;i.within(t)&&(i.eri+=e,i.sri+=e,i.sci+=n,i.eci+=n)})}},{key:"setData",value:function(t){return this._=t.map(function(t){return y.valueOf(t)}),this}},{key:"getData",value:function(){return this._.map(function(t){return t.toString()})}}])&&A(e.prototype,n),r&&A(e,r),t}();var R=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(function(n){Object.keys(n).forEach(function(r){var i=n[r];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?e[r]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(e[r]=e[r]||{},t(e[r],i)):e[r]=i})}),e};function I(t){for(var e="".concat(t),n=0,r=!1,i=0;i<e.length;i+=1)!0===r&&(n+=1),"."===e.charAt(i)&&(r=!0);return n}function D(t,e,n){if(Number.isNaN(e)||Number.isNaN(n))return e+t+n;var r=I(e),i=I(n),o=Number(e),a=Number(n),l=0;return"-"===t?l=o-a:"+"===t?l=o+a:"*"===t?l=o*a:"/"===t&&(l=o/a),l.toFixed(Math.max(r,i))}var z={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return R.apply(void 0,[{}].concat(e))},equals:function t(e,n){var r=Object.keys(e);if(r.length!==Object.keys(n).length)return!1;for(var i=0;i<r.length;i+=1){var o=r[i],a=e[o],l=n[o];if(void 0===l)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==l)return!1}else if(Array.isArray(a)){if(a.length!==l.length)return!1;for(var u=0;u<a.length;u+=1)if(!t(a[u],l[u]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,l))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,r=0;return Object.keys(t).forEach(function(i){n+=e(t[i],i),r+=1}),[n,r]},rangeEach:function(t,e,n){for(var r=t;r<e;r+=1)n(r)},rangeSum:function(t,e,n){for(var r=0,i=t;i<e;i+=1)r+=n(i);return r},rangeReduceIf:function(t,e,n,r,i,o){for(var a=n,l=r,u=t;u<e&&!(a>i);u+=1)a+=l=o(u);return[u,a-l,l]},deleteProperty:function(t,e){var n=t["".concat(e)];return delete t["".concat(e)],n},numberCalc:D};function M(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var W=function(){function t(e){var n=e.len,r=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=r}var e,n,r;return e=t,(n=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,n){var r=this;return z.rangeSum(t,e,function(t){return n&&n.has(t)?0:r.getHeight(t)})}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var n=this.get(t);return void 0!==n&&void 0!==n.cells&&void 0!==n.cells[e]?n.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var n=this.getCell(t,e);return n&&n.merge?n.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var n=this.getOrNew(t);return n.cells[e]=n.cells[e]||{},n.cells[e]}},{key:"setCell",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=this.getOrNew(t);"all"===r?i.cells[e]=n:"text"===r?(i.cells[e]=i.cells[e]||{},i.cells[e].text=n.text):"format"===r&&(i.cells[e]=i.cells[e]||{},i.cells[e].style=n.style,n.merge&&(i.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n){this.getCellOrNew(t,e).text=n}},{key:"copyPaste",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=t.sri,a=t.sci,l=t.eri,u=t.eci,c=e.sri,s=e.sci,f=e.eri,h=e.eci,v=t.size(),d=M(v,2),y=d[0],g=d[1],b=e.size(),m=M(b,2),w=m[0],_=m[1],k=!0,x=0;(f<o||h<a)&&(k=!1,x=f<o?w:_);for(var O=o;O<=l;O+=1)if(this._[O])for(var S=a;S<=u;S+=1)if(this._[O].cells&&this._[O].cells[S])for(var E=c;E<=f;E+=y)for(var j=s;j<=h;j+=g){var C=E+(O-o),T=j+(S-a),A=z.cloneDeep(this._[O].cells[S]);r&&A&&A.text&&A.text.length>0&&function(){var t=A.text,e=j-s+(E-c)+2;if(k||(e-=x+1),"="===t[0])A.text=t.replace(/\w{1,3}\d/g,function(t){var n=0,r=0;return o===c?n=e-1:r=e-1,/^\d+$/.test(t)?t:p(t,n,r)});else if(y<=1&&g>1&&(c>l||f<o)||g<=1&&y>1&&(s>u||h<a)||y<=1&&g<=1){var n=/[\\.\d]+$/.exec(t);if(null!==n){var r=Number(n[0])+e-1;A.text=t.substring(0,n.index)+r}}}(),this.setCell(C,T,A,n),i(C,T,A)}}},{key:"cutPaste",value:function(t,e){var n=this,r={};this.each(function(i){n.eachCells(i,function(o){var a=parseInt(i,10),l=parseInt(o,10);t.includes(i,o)&&(a=e.sri+(a-t.sri),l=e.sci+(l-t.sci)),r[a]=r[a]||{cells:{}},r[a].cells[l]=n._[i].cells[o]})}),this._=r}},{key:"paste",value:function(t,e){var n=this;if(!(t.length<=0)){var r=e.sri,i=e.sci;t.forEach(function(t,e){var o=r+e;t.forEach(function(t,e){var r=i+e;n.setCellText(o,r,t)})})}}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r={};this.each(function(i,o){var a=parseInt(i,10);a>=t&&(a+=n,e.eachCells(i,function(e,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/\w{1,3}\d/g,function(e){return p(e,0,n,function(e,n){return n>=t})}))})),r[a]=o}),this._=r,this.len+=n}},{key:"delete",value:function(t,e){var n=this,r=e-t+1,i={};this.each(function(o,a){var l=parseInt(o,10);l<t?i[l]=a:o>e&&(i[l-r]=a,n.eachCells(o,function(t,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/\w{1,3}\d/g,function(t){return p(t,0,-r,function(t,n){return n>e})}))}))}),this._=i,this.len-=r}},{key:"insertColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each(function(r,i){var o={};e.eachCells(r,function(e,r){var i=parseInt(e,10);i>=t&&(i+=n,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/\w{1,3}\d/g,function(e){return p(e,n,0,function(e){return e>=t})}))),o[i]=r}),i.cells=o})}},{key:"deleteColumn",value:function(t,e){var n=this,r=e-t+1;this.each(function(i,o){var a={};n.eachCells(i,function(n,i){var o=parseInt(n,10);o<t?a[o]=i:o>e&&(a[o-r]=i,i.text&&"="===i.text[0]&&(i.text=i.text.replace(/\w{1,3}\d/g,function(t){return p(t,-r,0,function(t){return t>e})})))}),o.cells=a})}},{key:"deleteCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each(function(t,r){e.deleteCell(t,r,n)})}},{key:"deleteCell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=this.get(t);if(null!==r){var i=this.getCell(t,e);null!==i&&("all"===n?delete r.cells[e]:"text"===n?(i.text&&delete i.text,i.value&&delete i.value):"format"===n?(void 0!==i.style&&delete i.style,i.merge&&delete i.merge):"merge"===n&&i.merge&&delete i.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],n=this._[e];if(n){var r=n.cells,i=Object.keys(r),o=i[i.length-1];return[parseInt(e,10),parseInt(o,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach(function(e){var n=M(e,2),r=n[0],i=n[1];t(r,i)})}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach(function(t){var n=M(t,2),r=n[0],i=n[1];e(r,i)})}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&L(e.prototype,n),r&&L(e,r),t}();function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var F=function(){function t(e){var n=e.len,r=e.width,i=e.indexWidth,o=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.width=r,this.indexWidth=i,this.minWidth=o}var e,n,r;return e=t,(n=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return z.rangeSum(t,e,function(t){return n.getWidth(t)})}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&H(e.prototype,n),r&&H(e,r),t}(),N="en",q={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function B(t,e){if(e&&e[N])for(var n=e[N],r=t.split("."),i=0;i<r.length;i+=1){var o=n[r[i]];if(i===r.length-1)return o;if(!o)return;n=o}}function V(t){var e=B(t,q);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=B(t,window.x_spreadsheet.$messages)),e||""}function U(t){return function(){return V(t)}}function $(t,e){N=t,e&&(q[t]=e)}function Y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function X(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var K={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function Z(t,e){var n="";if(!t){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];n=V.apply(void 0,["validation.".concat(e)].concat(i))}return[t,n]}var G=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=n,this.value=r,this.type=e,this.operator=i,this.message=""}var e,n,r;return e=t,(n=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?z.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,r=this.value,i=this.type;if(e&&/^\s*$/.test(t))return Z(!1,"required");if(/^\s*$/.test(t))return[!0];if(K[i]&&!K[i].test(t))return Z(!1,"notMatch");if("list"===i)return Z(this.values().includes(t),"notIn");if(n){var o=this.parseValue(t);if("be"===n){var a=Y(r,2),l=a[0],u=a[1];return Z(o>=this.parseValue(l)&&o<=this.parseValue(u),"between",l,u)}if("nbe"===n){var c=Y(r,2),s=c[0],f=c[1];return Z(o<this.parseValue(s)||o>this.parseValue(f),"notBetween",s,f)}if("eq"===n)return Z(o===this.parseValue(r),"equal",r);if("neq"===n)return Z(o!==this.parseValue(r),"notEqual",r);if("lt"===n)return Z(o<this.parseValue(r),"lessThan",r);if("lte"===n)return Z(o<=this.parseValue(r),"lessThanEqual",r);if("gt"===n)return Z(o>this.parseValue(r),"greaterThan",r);if("gte"===n)return Z(o>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}])&&X(e.prototype,n),r&&X(e,r),t}();function J(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function et(t,e,n){return e&&tt(t.prototype,e),n&&tt(t,n),t}var nt=function(){function t(e,n,r){Q(this,t),this.refs=n,this.mode=e,this.validator=r}return et(t,[{key:"includes",value:function(t,e){for(var n=this.refs,r=0;r<n.length;r+=1){if(y.valueOf(n[r]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(y.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach(function(n){var r=y.valueOf(n);r.intersects(t)?r.difference(t).forEach(function(t){return e.push(t.toString())}):e.push(n)}),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(e){var n=e.refs,r=e.mode,i=e.type,o=e.required,a=e.operator,l=e.value;return new t(r,n,new G(i,o,l,a))}}]),t}(),rt=function(){function t(){Q(this,t),this._=[],this.errors=new Map}return et(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var r=this.get(t,e),i="".concat(t,"_").concat(e),o=this.errors;if(null!==r){var a=J(r.validator.validate(n),2),l=a[0],u=a[1];l?o.delete(i):o.set(i,u)}else o.delete(i);return!0}},{key:"add",value:function(t,e,n){var r=n.type,i=n.required,o=n.value,a=n.operator,l=new G(r,i,o,a),u=this.getByValidator(l);null!==u?u.addRef(e):this._.push(new nt(t,[e],l))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"remove",value:function(t){this.each(function(e){e.remove(t)})}},{key:"each",value:function(t){this._.forEach(function(e){return t(e)})}},{key:"getData",value:function(){return this._.filter(function(t){return t.refs.length>0}).map(function(t){return t.getData()})}},{key:"setData",value:function(t){this._=t.map(function(t){return nt.valueOf(t)})}}]),t}(),it=n(1),ot=n.n(it),at=25;function lt(t){return t&&t.tree&&t.tree.show?t.tree.maxLength*at:0}function ut(t){return t&&t.tree&&t.tree.maxLength?t.tree.maxLength:0}function ct(t){return t.tree&&t.tree.show}function st(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ht(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var pt={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},showBottomBar:!0,style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}},vt=41;function dt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,i=e.clone(),o=ht(t.size(),2),a=o[0],l=o[1],u=ht(e.size(),2),c=u[0],s=u[1];return a>c&&(i.eri=e.sri+a-1),l>s&&(i.eci=e.sci+l-1),!r.intersects(i)||(n(V("error.pasteForMergedCell")),!1)}function yt(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,o=this.merges;"all"!==n&&"format"!==n||(i.deleteCells(e,n),o.deleteWithin(e)),i.copyPaste(t,e,n,r,function(t,e,n){if(n&&n.merge){var r=ht(n.merge,2),i=r[0],a=r[1];if(i<=0&&a<=0)return;o.add(new y(t,e,t+i,e+a))}})}function gt(t,e){var n=this.clipboard,r=this.rows,i=this.merges;r.cutPaste(t,e),i.move(t,e.sri-t.sri,e.sci-t.sci),n.clear()}function bt(t,e,n){var r=this.styles,i=this.rows.getCellOrNew(t,e),o={};void 0!==i.style&&(o=z.cloneDeep(r[i.style])),o=z.merge(o,{border:n}),i.style=this.addStyle(o)}var mt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=z.merge(pt,n||{}),this.name=e||"sheet",this.bottombarHeight=this.settings.showBottomBar?vt:10,this.freeze=[0,0],this.styles=[],this.merges=new P,this.rows=new W(this.settings.row),this.cols=new F(this.settings.col),this.validations=new rt,this.hyperlinks={},this.comments={},this.tree=this.settings.tree,this.tableData=[],this.selector=new b,this.scroll=new m,this.history=new _,this.clipboard=new x,this.autoFilter=new T,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}var e,n,r;return e=t,(n=[{key:"addValidation",value:function(t,e,n){var r=this;this.changeData(function(){r.validations.add(t,e,n)})}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData(function(){t.validations.remove(e)})}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=this.validations.get(e,n);return r?r.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=t.range,i=this.validations.get(e,n),o={ref:r.toString()};return null!==i&&(o.mode=i.mode,o.validator=i.validator),o}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),function(e){t.setData(e)})}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),function(e){t.setData(e)})}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.clipboard,i=this.selector;return!r.isClear()&&(!!dt.call(this,r.range,i.range,n)&&(this.changeData(function(){r.isCopy()?yt.call(t,r.range,i.range,e):r.isCut()&&gt.call(t,r.range,i.range)}),!0))}},{key:"pasteFromText",value:function(t){var e=t.split("\r\n").map(function(t){return t.replace(/"/g,"").split("\t")});e.length>0&&(e.length-=1);var n=this.rows,r=this.selector;this.changeData(function(){n.paste(e,r.range)})}},{key:"autofill",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!dt.call(this,i,t,r)&&(this.changeData(function(){yt.call(n,i,t,e,!0)}),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges,a=n.range,l=a.sri,u=a.sci,c=a.eri,s=a.eci,f=n.ri,h=n.ci,p=t,v=e;return t<0&&(p=r.len-1),e<0&&(v=i.len-1),p>f?(l=f,c=p):(l=p,c=f),v>h?(u=h,s=v):(u=v,s=h),n.range=o.union(new y(l,u,c,s)),n.range=o.union(n.range),n.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges.getFirstIncludes(t,e);return null===o&&(o=new y(t,e,t,e),-1===t&&(o.sri=0,o.eri=r.len-1),-1===e&&(o.sci=0,o.eci=i.len-1)),n.range=o,o}},{key:"setSelectedCellAttr",value:function(t,e){var n=this;this.changeData(function(){var r=n.selector,i=n.styles,o=n.rows;if("merge"===t)e?n.merge():n.unmerge();else if("border"===t)(function(t){var e=this,n=t.mode,r=t.style,i=t.color,o=this.styles,a=this.selector,l=this.rows,u=a.range,c=u.sri,s=u.sci,f=u.eri,h=u.eci,p=!this.isSignleSelected();if(p||"inside"!==n&&"horizontal"!==n&&"vertical"!==n)if("outside"!==n||p){if("none"===n)a.range.each(function(t,n){var r=l.getCell(t,n);if(r&&void 0!==r.style){var i=z.cloneDeep(o[r.style]);delete i.border,r.style=e.addStyle(i)}});else if("all"===n||"inside"===n||"outside"===n||"horizontal"===n||"vertical"===n)!function(){for(var t=[],o=c;o<=f;o+=1)for(var a=s;a<=h;a+=1){for(var u=[],v=0;v<t.length;v+=1){var d=ht(t[v],4),y=d[0],g=d[1],b=d[2],m=d[3];if(o===y+b+1&&u.push(v),y<=o&&o<=y+b&&a===g){a+=m+1;break}}if(u.forEach(function(e){return t.splice(e,1)}),a>h)break;var w=l.getCell(o,a),_=0,k=0;if(w&&w.merge){var x=ht(w.merge,2);_=x[0],k=x[1],t.push([o,a,_,k])}var O=_>0&&o+_===f,S=k>0&&a+k===h,E={};"all"===n?E={bottom:[r,i],top:[r,i],left:[r,i],right:[r,i]}:"inside"===n?(!S&&a<h&&(E.right=[r,i]),!O&&o<f&&(E.bottom=[r,i])):"horizontal"===n?!O&&o<f&&(E.bottom=[r,i]):"vertical"===n?!S&&a<h&&(E.right=[r,i]):"outside"===n&&p&&(c===o&&(E.top=[r,i]),(O||f===o)&&(E.bottom=[r,i]),s===a&&(E.left=[r,i]),(S||h===a)&&(E.right=[r,i])),Object.keys(E).length>0&&bt.call(e,o,a,E),a+=k}}();else if("top"===n||"bottom"===n)for(var v=s;v<=h;v+=1)"top"===n&&(bt.call(this,c,v,{top:[r,i]}),v+=l.getCellMerge(c,v)[1]),"bottom"===n&&(bt.call(this,f,v,{bottom:[r,i]}),v+=l.getCellMerge(f,v)[1]);else if("left"===n||"right"===n)for(var d=c;d<=f;d+=1)"left"===n&&(bt.call(this,d,s,{left:[r,i]}),d+=l.getCellMerge(d,s)[0]),"right"===n&&(bt.call(this,d,h,{right:[r,i]}),d+=l.getCellMerge(d,h)[0])}else bt.call(this,c,s,{top:[r,i],bottom:[r,i],left:[r,i],right:[r,i]})}).call(n,e);else if("formula"===t){var a=r.ri,l=r.ci,u=r.range;if(r.multiple()){var c=ht(r.size(),2),s=c[0],f=c[1],p=u.sri,v=u.sci,d=u.eri,y=u.eci;if(s>1)for(var g=v;g<=y;g+=1){o.getCellOrNew(d+1,g).text="=".concat(e,"(").concat(h(g,p),":").concat(h(g,d),")")}else if(f>1){o.getCellOrNew(a,y+1).text="=".concat(e,"(").concat(h(v,a),":").concat(h(y,a),")")}}else{o.getCellOrNew(a,l).text="=".concat(e,"()")}}else r.range.each(function(r,a){var l=o.getCellOrNew(r,a),u={};if(void 0!==l.style&&(u=z.cloneDeep(i[l.style])),"format"===t)u.format=e,l.style=n.addStyle(u);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var c={};c[t.split("-")[1]]=e,u.font=Object.assign(u.font||{},c),l.style=n.addStyle(u)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(u[t]=e,l.style=n.addStyle(u)):l[t]=e})})}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=this.autoFilter,r=this.selector,i=this.rows,o=r.ri,a=r.ci,l=o;this.unsortedRowMap.has(o)&&(l=this.unsortedRowMap.get(o));var u=i.getCell(l,a),c=u?u.text:"";if(this.setCellText(l,a,t,e),n.active()){var s=n.getFilter(a);if(s){var f=s.value.findIndex(function(t){return t===c});f>=0&&s.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,n)}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),r=n.left,i=n.top,o=n.width,a=n.height,l=t-this.cols.indexWidth,u=e-this.rows.height;return l>r&&l<r+o&&u>i&&u<i+a}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,r=this.cols,i=this.exceptRowSet,o=t.sri,a=t.sci,l=t.eri,u=t.eci;if(o<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var c=r.sumWidth(0,a),s=n.sumHeight(0,o,i),f=n.sumHeight(o,l+1,i),h=r.sumWidth(a,u+1),p=c-e.x,v=s-e.y,d=this.freezeTotalHeight(),y=this.freezeTotalWidth();return y>0&&y>c&&(p=c),d>0&&d>s&&(v=s),{l:c,t:s,left:p,top:v,height:f,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n=this.scroll,r=this.merges,i=this.rows,o=this.cols,a=function(t,e){var n=this.rows,r=this.freezeTotalHeight(),i=n.height;r+n.height<t&&(i-=e);for(var o=this.exceptRowSet,a=0,l=i,u=n.height;a<n.len&&!(l>t);a+=1)o.has(a)||(l+=u=n.getHeight(a));return(l-=u)<=0?{ri:-1,top:0,height:u}:{ri:a-1,top:l,height:u}}.call(this,e,n.y),l=a.ri,u=a.top,c=a.height,s=function(t,e){var n=this.cols,r=this.settings,i=this.freezeTotalWidth(),o=n.indexWidth+lt(r);i+n.indexWidth<t&&(o-=e);var a=ht(z.rangeReduceIf(0,n.len,o,n.indexWidth,t,function(t){return n.getWidth(t)}),3),l=a[0],u=a[1],c=a[2];return u<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:l-1,left:u,width:c}}.call(this,t,n.x),f=s.ci,h=s.left,p=s.width;if(-1===f&&(p=o.totalWidth()),-1===l&&(c=i.totalHeight()),l>=0||f>=0){var v=r.getFirstIncludes(l,f);if(v){l=v.sri,f=v.sci;var d=this.cellRect(l,f);h=d.left,u=d.top,p=d.width,c=d.height}}return{ri:l,ci:f,left:h,top:u,width:p,height:c}}},{key:"isSignleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=ht(o.merge,2),l=a[0],u=a[1];if(e+l===r&&n+u===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=ht(o.merge,2),l=a[0],u=a[1];if(e+l===r&&n+u===i)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,n=this.rows;if(!this.isSignleSelected()){var r=ht(e.size(),2),i=r[0],o=r[1];if(i>1||o>1){var a=e.range,l=a.sri,u=a.sci;this.changeData(function(){var r=n.getCellOrNew(l,u);r.merge=[i-1,o-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(l,u,r)})}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSignleSelected()){var n=e.range,r=n.sri,i=n.sci;this.changeData(function(){t.rows.deleteCell(r,i,"merge"),t.merges.deleteWithin(e.range)})}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector;this.changeData(function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()})}},{key:"setAutoFilter",value:function(t,e,n,r){var i=this.autoFilter;i.addFilter(t,n,r),i.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,n=this.rows;if(e.active()){var r=e.sort,i=e.filteredRows(function(t,e){return n.getCell(t,e)}),o=i.rset,a=i.fset,l=Array.from(a),u=Array.from(a);r&&l.sort(function(t,e){return"asc"===r.order?t-e:"desc"===r.order?e-t:0}),this.exceptRowSet=o,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,l.forEach(function(e,n){t.sortedRowMap.set(u[n],e),t.unsortedRowMap.set(e,u[n])})}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector;this.changeData(function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range)})}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData(function(){var r=e.selector.range,i=r.sri,o=r.sci,a=e.rows,l=e.merges,u=e.cols,c=i;if("row"===t){if(a.insert(i,n),!e.tree)return;e.tree.data.splice(i,0,{expand:!0,level:i<e.tree.data.length?e.tree.data[i].level:0,ri:i,childrenLen:0,parent:i<e.tree.data.length?e.tree.data[i].parent:""}),e.addParentLen(e.tree.data[i].parent?e.tree.data[i].parent.id:"",1),e.tree.data.forEach(function(t,e){t.ri=e})}else"column"===t&&(a.insertColumn(o,n),c=o,u.len+=1);l.shift(t,c,n,function(t,e,n,r){var i=a.getCell(t,e);i.merge[0]+=n,i.merge[1]+=r})})}},{key:"addParentLen",value:function(t,e){var n=this;t&&this.tree.data.forEach(function(r){r.id===t&&(r.childrenLen=r.childrenLen+e,n.addParentLen(r.parent?r.parent.id:"",e))})}},{key:"addLevel",value:function(){var t=this;this.changeData(function(){var e=t.selector,n=t.rows,r=t.merges,i=t.tree,o=e.ri;if(!i.data[o].childrenLen){n.insert(o+1,1),i.data[o].lastChild&&delete i.data[o].lastChild,i.data[o].childrenLen=1,i.data.splice(o+1,0,{expand:!0,childrenLen:0,parent:i.data[o],level:i.data[o].level+1,lastChild:!0});var a=0;i.data.forEach(function(t,e){t.ri=e,t.level>a&&(a=t.level)}),i.maxLength=a+1,r.shift("row",o,1,function(t,e,r,i){var o=n.getCell(t,e);o.merge[0]+=r,o.merge[1]+=i}),t.change(t)}})}},{key:"delete",value:function(t){var e=this;this.changeData(function(){var n=e.rows,r=e.merges,i=e.selector,o=e.cols,a=i.range,l=i.range,u=l.sri,c=l.sci,s=l.eri,f=l.eci,h=ht(i.range.size(),2),p=h[0],v=h[1],d=u,y=p;if("row"===t){if(n.delete(u,s),!e.tree||!e.tree.data[s])return;var g=s-u+1;e.tree.data[u-1].lastChild=!!(e.tree.data[s].lastChild&&1!==e.tree.data[u-1].childrenLen&&e.tree.data[s].level===e.tree.data[u-1].level||e.tree.data[u-1].lastChild),e.deleteParentLen(e.tree.data[u].parent?e.tree.data[u].parent.id:"",g),e.tree.data.splice(u,g),e.tree.data.forEach(function(t,e){t.ri=e})}else"column"===t&&(n.deleteColumn(c,f),d=a.sci,y=v,o.len-=1);r.shift(t,d,-y,function(t,e,r,i){var o=n.getCell(t,e);o.merge[0]+=r,o.merge[1]+=i,0===o.merge[0]&&0===o.merge[1]&&delete o.merge})})}},{key:"deleteParentLen",value:function(t,e){var n=this;t&&this.tree.data.forEach(function(r){r.id===t&&(r.childrenLen-=e,n.deleteParentLen(r.parent?r.parent.id:"",e))})}},{key:"scrollx",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.cols,o=ht(r,2)[1],a=ht(z.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getWidth(t)}),3),l=a[0],u=a[1],c=a[2],s=u;t>0&&(s+=c),n.x!==s&&(n.ci=t>0?l:0,n.x=s,e())}},{key:"scrolly",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.rows,o=ht(r,1)[0],a=ht(z.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getHeight(t)}),3),l=a[0],u=a[1],c=a[2],s=u;t>0&&(s+=c),n.y!==s&&(n.ri=t>0?l:0,n.y=s,e())}},{key:"cellRect",value:function(t,e){var n=this.rows,r=this.cols,i=r.sumWidth(0,e),o=n.sumHeight(0,t),a=n.getCell(t,e),l=r.getWidth(e),u=n.getHeight(t);if(null!==a&&a.merge){var c=ht(a.merge,2),s=c[0],f=c[1];if(s>0)for(var h=1;h<=s;h+=1)u+=n.getHeight(t+h);if(f>0)for(var p=1;p<=f;p+=1)l+=r.getWidth(e+p)}return{left:i,top:o,width:l,height:u,cell:a}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var n=this.getCell(t,e);return n&&n.text?n.text:""}},{key:"getCellStyle",value:function(t,e){var n=this.getCell(t,e);return n&&void 0!==n.style?this.styles[n.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,r=this.rows.getCell(t,e),i=r&&void 0!==r.style?n[r.style]:{};return z.merge(this.defaultStyle(),i)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellStyleOrDefault(e,n)}},{key:"setCellText",value:function(t,e,n,r){var i=this.rows,o=this.history,a=this.validations;"finished"===r?(i.setCellText(t,e,""),o.add(this.getData()),i.setCellText(t,e,n)):(i.setCellText(t,e,n),this.change(this.getData())),a.validate(t,e,n)}},{key:"freezeIsActive",value:function(){var t=ht(this.freeze,2),e=t[0],n=t[1];return e>0||n>0}},{key:"setFreeze",value:function(t,e){var n=this;this.changeData(function(){n.freeze=[t,e]})}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData(function(){n.rows.setHeight(t,e)})}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData(function(){n.cols.setWidth(t,e)})}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,r=e.height();return r-=this.bottombarHeight,n&&(r-=41),r}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=ht(this.freeze,2),e=t[0],n=t[1];return new y(0,0,e-1,n-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,n=ht(t.maxCell(),2),r=n[0],i=n[1],o=t.sumHeight(0,r+1),a=e.sumWidth(0,i+1);return new y(0,0,r,i,a,o)}},{key:"exceptRowTotalHeight",value:function(t,e){var n=this.exceptRowSet,r=this.rows,i=Array.from(n),o=0;return i.forEach(function(n){if(n<t||n>e){var i=r.getHeight(n);o+=i}}),o}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,r=this.freeze,i=this.exceptRowSet,o=t.ri,a=t.ci;o<=0&&(o=ht(r,1)[0]);a<=0&&(a=ht(r,2)[1]);for(var l=0,u=0,c=[e.len,n.len],s=c[0],f=c[1],h=o;h<e.len&&(i.has(h)||(u+=e.getHeight(h),s=h),!(u>this.viewHeight()));h+=1);for(var p=a;p<n.len&&(f=p,!((l+=n.getWidth(p))>this.viewWidth()));p+=1);return new y(o,a,s,f,l,u)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach(function(t){return e(t)})}},{key:"hideRowsOrCols",value:function(t){var e=this.rows,n=this.cols,r=this.selector,i=(this.tree.data&&this.tree.data,ht(r.size(),2)),o=i[0],a=i[1],l=r.range,u=l.sri,c=l.sci,s=l.eri,f=l.eci;if(t)"mousedown"===t.type&&this.exchangeLevel(t.mousedownItem),"mouseup"===t.type&&this.dragTreeData(t.mousedownItem,t.mouseupItem);else if(console.log(u,c,s,f,o,a,"----"),o===e.len)for(var h=c;h<=f;h+=1)n.setHide(h,!0);else if(a===n.len)for(var p=u;p<=s;p+=1)e.setHide(p,!0)}},{key:"exchangeLevel",value:function(t){console.log(this),console.log(this.tree.data);for(var e=t.ri,n=0;n<t.childrenLen;n++)t.expand?this.hideLevelTree(t.ri+1+n,t.level,this.tree.data[t.ri+n+1]):this.expandLevelTree(t.ri+n+1,t.level,this.tree.data[t.ri+1+n]);this.tree.data[e].expand=!this.tree.data[e].expand,this.change(this)}},{key:"expandLevelTree",value:function(t,e,n){console.log(t),console.log(e),console.log(n);var r=this.rows;e===n.hideLevel-1&&(r.setHide(t),delete n.hideLevel)}},{key:"hideLevelTree",value:function(t,e,n){console.log(t),console.log(e),console.log(n);var r=this.rows;n.hideLevel||(n.hideLevel=e+1,r.setHide(t,!0))}},{key:"dragTreeData",value:function(t,e){var n=this;t.ri!==e.ri&&this.changeData(function(){var r=n.rows,i=0,o=t.ri,a=t.level,l=1+t.childrenLen,u=n.tree.data.slice(o,o+l),c=e.ri,s=e.level-a,f=[];n.tree.data.splice(o,l),t.lastChild&&t.level===n.tree.data[o-1].level&&(n.tree.data[o-1].lastChild=!0),n.deleteParentLen(t.parent?t.parent.id:"",l),o<c?u.forEach(function(t,r){t.level+=s,t.hideLevel&&(t.hideLevel+=s),0===r&&(t.parent=e.parent,delete t.lastChild),n.tree.data.splice(c+r-l,0,t)}):u.forEach(function(t,r){t.level+=s,t.hideLevel&&(t.hideLevel+=s),0===r&&(t.parent=e.parent,delete t.lastChild),n.tree.data.splice(c+r,0,t)}),n.addParentLen(e.parent?e.parent.id:"",l),n.tree.data.forEach(function(t,e){t.ri=e,t.level>i&&(i=t.level)}),n.tree.maxLength=i+1,n.change(n);for(var h=0;h<l;h++)f.push(r._[o+h]);r.insert(c,l),f.forEach(function(t,e){r._[c+e]=t}),o<c?r.delete(o,o+l-1):r.delete(o+l,o+l+l-1)})}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,n){for(var r=0,i=this.rows,o=this.exceptRowSet,a=st(o),l=0,u=0;u<a.length;u+=1)a[u]<t&&(l+=1);for(var c=t+l;c<=e+l;c+=1)if(o.has(c))l+=1;else{var s=i.getHeight(c);if(s>0&&(n(c,r,s),(r+=s)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,n){for(var r=0,i=this.cols,o=t;o<=e;o+=1){var a=i.getWidth(o);if(a>0&&(n(o,r,a),(r+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,n=0;n<e.length;n+=1){var r=e[n];if(z.equals(r,t))return n}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach(function(n){if("merges"===n||"rows"===n||"cols"===n||"validations"===n)e[n].setData(t[n]);else if("freeze"===n){var r=ht(f(t[n]),2),i=r[0],o=r[1];e.freeze=[o,i]}else"autofilter"===n?e.autoFilter.setData(t[n]):"tree"===n?(e.tree=t[n],e.change(e)):void 0!==t[n]&&(e[n]=t[n])}),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,i=this.rows,o=this.cols,a=this.validations,l=this.autoFilter,u=ot.a.cloneDeep(this.tree);return{name:t,freeze:h(e[1],e[0]),styles:n,tree:u,merges:r.getData(),rows:i.getData(),cols:o.getData(),validations:a.getData(),autofilter:l.getData()}}}])&&ft(e.prototype,n),r&&ft(e,r),t}();function wt(t,e,n){t.addEventListener(e,n)}function _t(t,e,n){t.removeEventListener(e,n)}function kt(t){t.xclickoutside&&(_t(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function xt(t,e){t.xclickoutside=function(n){2===n.detail||t.contains(n.target)||(e?e(t):(t.hide(),kt(t)))},wt(window.document.body,"click",t.xclickoutside)}function Ot(t,e,n){wt(t,"mousemove",e),t.xEvtUp=function(r){_t(t,"mousemove",e),_t(t,"mouseup",t.xEvtUp),n(r)},wt(t,"mouseup",t.xEvtUp)}function St(t,e,n,r){Math.abs(t)>Math.abs(e)?r(t>0?"right":"left",t,n):r(e>0?"down":"up",e,n)}var Et="x-spreadsheet";window.devicePixelRatio;function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ct=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moving=!1,this.vertical=n,this.el=a("div","".concat(Et,"-resizer ").concat(n?"vertical":"horizontal")).children(this.unhideHoverEl=a("div","".concat(Et,"-resizer-hover")).on("dblclick.stop",function(t){return e.mousedblclickHandler(t)}).css("position","absolute").hide(),this.hoverEl=a("div","".concat(Et,"-resizer-hover")).on("mousedown.stop",function(t){return e.mousedownHandler(t)}),this.lineEl=a("div","".concat(Et,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=r,this.unhideFn=function(){}}var e,n,r;return e=t,(n=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var n=this.moving,r=this.vertical,i=this.hoverEl,o=this.lineEl,a=this.el,l=this.unhideHoverEl;if(!n){this.cRect=t;var u=t.left,c=t.top,s=t.width,f=t.height;a.offset({left:r?u+s-5:u,top:r?c:c+f-5}).show(),i.offset({width:r?5:s,height:r?f:5}),o.offset({width:r?0:e.width,height:r?e.height:0}),l.offset({left:r?5-s:u,top:r?c:5-f,width:r?5:s,height:r?f:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,n=t,r=this.el,i=this.lineEl,o=this.cRect,a=this.vertical,l=this.minDistance,u=a?o.width:o.height;i.show(),Ot(window,function(t){e.moving=!0,null!==n&&1===t.buttons&&(a?(u+=t.movementX)>l&&r.css("left","".concat(o.left+u,"px")):(u+=t.movementY)>l&&r.css("top","".concat(o.top+u,"px")),n=t)},function(){n=null,i.hide(),e.moving=!1,e.hide(),e.finishedFn&&(u<l&&(u=l),e.finishedFn(o,u))})}}])&&jt(e.prototype,n),r&&jt(e,r),t}();function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var At=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=a("div","".concat(Et,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=a("div","")).on("mousemove.stop",function(){}).on("scroll.stop",function(t){var e=t.target,r=e.scrollTop,i=e.scrollLeft;n.moveFn&&n.moveFn(n.vertical?r:i,t)})}var e,n,r;return e=t,(n=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;if(e>n){var r=this.vertical?"height":"width";this.el.css(r,"".concat(n-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(r,"".concat(e,"px"))}else this.el.hide();return this}}])&&Tt(e.prototype,n),r&&Tt(e,r),t}();function Pt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function It(t,e,n){return e&&Rt(t.prototype,e),n&&Rt(t,n),t}var Dt=10,zt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Pt(this,t),this.useHideInput=n,this.inputChange=function(){},this.cornerEl=a("div","".concat(Et,"-selector-corner")),this.areaEl=a("div","".concat(Et,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=a("div","".concat(Et,"-selector-clipboard")).hide(),this.autofillEl=a("div","".concat(Et,"-selector-autofill")).hide(),this.el=a("div","".concat(Et,"-selector")).css("z-index","".concat(Dt)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),n&&(this.hideInput=a("input","").on("compositionend",function(t){e.inputChange(t.target.value)}),this.el.child(this.hideInputDiv=a("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=a("div","hide-input").child(this.hideInput))),Dt+=1}return It(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,n=t.top,r={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:n-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.hideInput.val("").focus())}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.clipboardEl.offset({left:e,top:n,width:r-5,height:i-5})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.autofillEl.offset({width:r-3,height:i-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function Mt(t){var e=this.data,n=t.left,r=t.top,i=t.width,o=t.height,a=t.scroll,l=t.l,u=t.t,c=e.freezeTotalWidth(),s=e.freezeTotalHeight(),f=n-c;c>l&&(f-=a.x);var h=r-s;return s>u&&(h-=a.y),{left:f,top:h,width:i,height:o}}function Lt(t){var e=this.data,n=t.left,r=t.width,i=t.height,o=t.l,a=t.t,l=t.scroll,u=e.freezeTotalWidth(),c=n-u;return u>o&&(c-=l.x),{left:c,top:a,width:r,height:i}}function Wt(t){var e=this.data,n=t.top,r=t.width,i=t.height,o=t.l,a=t.t,l=t.scroll,u=e.freezeTotalHeight(),c=n-u;return u>a&&(c-=l.y),{left:o,top:c,width:r,height:i}}function Ht(t){this.br.setAreaOffset(Mt.call(this,t))}function Ft(t){this.t.setAreaOffset(Lt.call(this,t))}function Nt(t){this.l.setAreaOffset(Wt.call(this,t))}function qt(t){this.l.setClipboardOffset(Wt.call(this,t))}function Bt(t){this.br.setClipboardOffset(Mt.call(this,t))}function Vt(t){this.t.setClipboardOffset(Lt.call(this,t))}function Ut(t){Ht.call(this,t),function(t){this.tl.setAreaOffset(t)}.call(this,t),Ft.call(this,t),Nt.call(this,t)}function $t(t){Bt.call(this,t),function(t){this.tl.setClipboardOffset(t)}.call(this,t),Vt.call(this,t),qt.call(this,t)}var Yt=function(){function t(e){var n=this;Pt(this,t),this.inputChange=function(){},this.data=e,this.br=new zt(!0),this.t=new zt,this.l=new zt,this.tl=new zt,this.br.inputChange=function(t){n.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=a("div","".concat(Et,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Dt+=1}return It(t,[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,r=this.l,i=this.br,o=t.freezeTotalHeight(),a=t.freezeTotalWidth();o>0||a>0?(e.setOffset({width:a,height:o}),n.setOffset({left:a,height:o}),r.setOffset({top:o,width:a}),i.setOffset({left:a,top:o})):(e.hide(),n.hide(),r.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ut.call(this,t),$t.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ht.call(this,t),Ft.call(this,t),Bt.call(this,e),Vt.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ht.call(this,t),Nt.call(this,t),Bt.call(this,e),qt.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=r.calSelectedRangeByStart(t,e),o=i.sri,a=i.sci;if(n){var l=t,u=e;t<0&&(l=0),e<0&&(u=0),r.selector.setIndexes(l,u),this.indexes=[l,u]}this.moveIndexes=[o,a],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=this.lastri,o=this.lastci;if(n){if(t===i&&e===o)return;this.lastri=t,this.lastci=e}this.range=r.calSelectedRangeByEnd(t,e),Ut.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,n=t.eci;this.setEnd(e,n)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,r=n.sri,i=n.sci,o=n.eri,a=n.eci,l=t,u=e,c=r-t,s=o-t,f=a-e;if(i-e>0)this.arange=new y(r,u,o,i-1);else if(c>0)this.arange=new y(l,i,r-1,a);else if(f<0)this.arange=new y(r,a+1,o,u);else{if(!(s<0))return void(this.arange=null);this.arange=new y(o+1,i,l,a)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var p=this.br,v=this.l,d=this.t,g=this.tl;p.showAutofill(Mt.call(this,h)),v.showAutofill(Wt.call(this,h)),d.showAutofill(Lt.call(this,h)),g.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideAutofill()})}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();$t.call(this,e),["br","l","t","tl"].forEach(function(e){t[e].showClipboard()})}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideClipboard()})}}]),t}();function Xt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zt(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}var Gt=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterItems=[],this.items=e,this.el=a("div","".concat(Et,"-suggest")).css("width",r).hide(),this.itemClick=n,this.itemIndex=-1}var e,n,r;return e=t,(n=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),kt(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,n=this,r=this.items;if(/^\s*$/.test(t)||(r=r.filter(function(e){return(e.key||e).startsWith(t.toUpperCase())})),r=r.map(function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var r=a("div","".concat(Et,"-item")).child(e).on("click.stop",function(){n.itemClick(t),n.hide()});return t.label&&r.child(a("div","label").html(t.label)),r}),this.filterItems=r,!(r.length<=0)){var i=this.el;(e=i.html("")).children.apply(e,Xt(r)).show(),xt(i.parent(),function(){n.hide()})}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",function(t){return function(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:(function(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}).call(this,t);break;case 39:t.stopPropagation();break;case 40:(function(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}).call(this,t);break;case 13:case 9:Zt.call(this,t);break;default:t.stopPropagation()}}.call(e,t)})}}])&&Kt(e.prototype,n),r&&Kt(e,r),t}();function Jt(t){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function te(t,e){return!e||"object"!==Jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ee(t){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ne(t,e){return(ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var re=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=te(this,ee(e).call(this,"div","".concat(Et,"-icon")))).iconNameEl=a("div","".concat(Et,"-icon-img ").concat(t)),n.child(n.iconNameEl),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ne(t,e)}(e,o),n=e,(r=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(Et,"-icon-img ").concat(t))}}])&&Qt(n.prototype,r),i&&Qt(n,i),e}();function ie(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ae(t,e){t.setMonth(t.getMonth()+e)}function le(t,e){var n=new Date(t);return n.setDate(e-t.getDay()+1),n}var ue=function(){function t(e){var n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=a("div","calendar-header-left"),this.bodyEl=a("tbody",""),this.buildAll(),this.el=a("div","x-spreadsheet-calendar").children(a("div","calendar-header").children(this.headerLeftEl,a("div","calendar-header-right").children(a("a","calendar-prev").on("click.stop",function(){return r.prev()}).child(new re("chevron-left")),a("a","calendar-next").on("click.stop",function(){return r.next()}).child(new re("chevron-right")))),a("table","calendar-body").children(a("thead","").child((n=a("tr","")).children.apply(n,ie(V("calendar.weeks").map(function(t){return a("th","cell").child(t)})))),this.bodyEl)),this.selectChange=function(){}}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){ae(this.value,-1),this.buildAll()}},{key:"next",value:function(){ae(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(V("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,n=this.value,r=this.cvalue,i=this.bodyEl,o=function(t,e,n){for(var r=new Date(t,e,1,23,59,59),i=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var a=0;a<7;a+=1){var l=le(r,7*o+a),u=l.getMonth()!==e,c=l.getMonth()===n.getMonth()&&l.getDate()===n.getDate();i[o][a]={d:l,disabled:u,active:c}}return i}(n.getFullYear(),n.getMonth(),r).map(function(t){var n,r=t.map(function(t){var n="cell";return t.disabled&&(n+=" disabled"),t.active&&(n+=" active"),a("td","").child(a("div",n).on("click.stop",function(){e.selectChange(t.d)}).child(t.d.getDate().toString()))});return(n=a("tr","")).children.apply(n,ie(r))});(t=i.html("")).children.apply(t,ie(o))}}])&&oe(e.prototype,n),r&&oe(e,r),t}();function ce(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var se=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new ue(new Date),this.el=a("div","".concat(Et,"-datepicker")).child(this.calendar.el).hide()}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(n){t(n),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&ce(e.prototype,n),r&&ce(e,r),t}();function fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function he(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function pe(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,n=this.textEl,r=this.areaOffset,i=t.split("\n"),o=Math.max.apply(Math,he(i.map(function(t){return t.length}))),a=e.offset().width/t.length,l=(o+1)*a+5,u=this.viewFn().width-r.left-a,c=i.length;if(l>r.width){var s=l;l>u&&(s=u,c+=parseInt(l/u,10),c+=l%u>0?1:0),n.css("width","".concat(s,"px"))}(c*=this.rowHeight)>r.height&&n.css("height","".concat(c,"px"))}}function ve(t){var e=t.keyCode,n=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&n&&(function(t,e){var n=t.target,r=n.value,i=n.selectionEnd,o="".concat(r.slice(0,i)).concat(e).concat(r.slice(i));n.value=o,n.setSelectionRange(i+1,i+1),this.inputText=o,this.textlineEl.html(o),pe.call(this)}.call(this,t,"\n"),t.stopPropagation()),13!==e||n||t.preventDefault()}function de(t,e){var n=this.textEl,r=this.textlineEl;n.el.blur(),n.val(t),r.html(t),function(t){var e=this.textEl.el;setTimeout(function(){e.focus(),e.setSelectionRange(t,t)},0)}.call(this,e)}var ye=function(){function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=n,this.rowHeight=r,this.formulas=e,this.suggest=new Gt(e,function(t){(function(t){var e=this.inputText,n=this.validator,r=0;if(n&&"list"===n.type)this.inputText=t,r=this.inputText.length;else{var i=e.lastIndexOf("="),o=e.substring(0,i+1),a=e.substring(i+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(o+t.key,"("),r=this.inputText.length,this.inputText+=")".concat(a)}de.call(this,this.inputText,r)}).call(i,t)}),this.datepicker=new se,this.datepicker.change(function(t){i.setText(function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)}(t)),i.clear()}),this.areaEl=a("div","".concat(Et,"-editor-area")).children(this.textEl=a("textarea","").on("input",function(t){return function(t){var e=t.target.value,n=this.suggest,r=this.textlineEl,i=this.validator,o=this.cell;if(null!==o)if("editable"in o&&!0===o.editable||void 0===o.editable){if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var a=e.lastIndexOf("=");-1!==a?n.search(e.substring(a+1)):n.hide()}r.html(e),pe.call(this),this.change("input",e)}else t.target.value="";else{if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var l=e.lastIndexOf("=");-1!==l?n.search(e.substring(l+1)):n.hide()}r.html(e),pe.call(this),this.change("input",e)}}.call(i,t)}).on("paste.stop",function(){}).on("keydown",function(t){return ve.call(i,t)}),this.textlineEl=a("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",function(){}).on("mousedown.stop",function(){}),this.el=a("div","".concat(Et,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}var e,n,r;return e=t,(n=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),function(){this.suggest.setItems(this.formulas)}.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n=this.textEl,r=this.areaEl,i=this.suggest,o=this.freeze,a=this.el;if(t){this.areaOffset=t;var l=t.left,u=t.top,c=t.width,s=t.height,f=t.l,h=t.t,p={left:0,top:0};o.w>f&&o.h>h||(o.w<f&&o.h<h?(p.left=o.w,p.top=o.h):o.w>f?p.top=o.h:o.h>h&&(p.left=o.w)),a.offset(p),r.offset({left:l-p.left-.8,top:u-p.top-.8}),n.offset({width:c-9+.8,height:s-3+.8});var v={left:0};v[e]=s,i.setOffset(v),i.hide()}}},{key:"setCell",value:function(t,e){var n=this.el,r=this.datepicker,i=this.suggest;n.show(),this.cell=t;var o=t&&t.text||"";if(this.setText(o),this.validator=e,e){var a=e.type;"date"===a&&(r.show(),/^\s*$/.test(o)||r.setValue(o)),"list"===a&&(i.setItems(e.values()),i.search(""))}}},{key:"setText",value:function(t){this.inputText=t,de.call(this,t,t.length),pe.call(this)}}])&&fe(e.prototype,n),r&&fe(e,r),t}();function ge(t){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function be(t,e){return!e||"object"!==ge(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function me(t){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function we(t,e){return(we=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _e=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=be(this,me(e).call(this,"div","".concat(Et,"-button ").concat(r)))).child(V("button.".concat(t))),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&we(t,e)}(e,o),e}();function ke(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function xe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ee(t,e,n){return e&&Se(t.prototype,e),n&&Se(t,n),t}function je(){return window.devicePixelRatio||1}function Ce(){return je()-.5}function Te(t){return parseInt(t*je(),10)}function Ae(t){var e=Te(t);return e>0?e-.5:.5}var Pe=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Oe(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.padding=o,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}return Ee(t,[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,r=t.left,i=t.right;e&&(this.borderTop=e),i&&(this.borderRight=i),n&&(this.borderBottom=n),r&&(this.borderLeft=r)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,n=this.padding,r=this.x;return"left"===t?r+=n:"center"===t?r+=e/2:"right"===t&&(r+=e-n),r}},{key:"texty",value:function(t,e){var n=this.height,r=this.padding,i=this.y;return"top"===t?i+=r:"middle"===t?i+=n/2-e/2:"bottom"===t&&(i+=n-r-e),i}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return[[t,e+r],[t+n,e+r]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function Re(t,e,n,r,i,o,a){var l={x:0,y:0};"underline"===t?l.y="bottom"===i?0:"top"===i?-(o+2):-o/2:"strike"===t&&("bottom"===i?l.y=o/2:"top"===i&&(l.y=-(o/2+2))),"center"===r?l.x=a/2:"right"===r&&(l.x=a),this.line([e-l.x,n-l.y],[e-l.x+a,n-l.y])}var Ie=function(){function t(e,n,r){Oe(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(n,r),this.ctx.scale(je(),je())}return Ee(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=Te(t),this.el.height=Te(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,n=t.height;return this.ctx.clearRect(0,0,e,n),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(Te(t),Te(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,n,r){return this.ctx.clearRect(t,e,n,r),this}},{key:"fillRect",value:function(t,e,n,r){return this.ctx.fillRect(Te(t)-.5,Te(e)-.5,Te(n),Te(r)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,Te(e),Te(n)),this}},{key:"text",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.ctx,a=r.align,l=r.valign,u=r.font,c=r.color,s=r.strike,f=r.underline,h=e.textx(a);o.save(),o.beginPath(),this.attr({textAlign:a,textBaseline:l,font:"".concat(u.italic?"italic":""," ").concat(u.bold?"bold":""," ").concat(Te(u.size),"px ").concat(u.name),fillStyle:c,strokeStyle:c});var p="".concat(t).split("\n"),v=e.innerWidth(),d=[];p.forEach(function(t){var e=o.measureText(t).width;if(i&&e>Te(v)){for(var n={w:0,len:0,start:0},r=0;r<t.length;r+=1)n.w>=Te(v)&&(d.push(t.substr(n.start,n.len)),n={w:0,len:0,start:r}),n.len+=1,n.w+=o.measureText(t[r]).width+1;n.len>0&&d.push(t.substr(n.start,n.len))}else d.push(t)});var y=(d.length-1)*(u.size+2),g=e.texty(l,y);return d.forEach(function(t){var e=o.measureText(t).width;n.fillText(t,h,g),s&&Re.call(n,"strike",h,g,a,l,u.size,e),f&&Re.call(n,"underline",h,g,a,l,u.size,e),g+=u.size+2}),o.restore(),this}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=Ce,n.strokeStyle=e,"medium"===t?n.lineWidth=Te(2)-.5:"thick"===t?n.lineWidth=Te(3):"dashed"===t?n.setLineDash([Te(3),Te(2)]):"dotted"===t?n.setLineDash([Te(1),Te(1)]):"double"===t&&n.setLineDash([Te(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],n=xe(e,2),r=n[0],i=n[1];t.moveTo(Ae(r),Ae(i));for(var o=1;o<arguments.length;o+=1){var a=o<0||arguments.length<=o?void 0:arguments[o],l=xe(a,2),u=l[0],c=l[1];t.lineTo(Ae(u),Ae(c))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var n=t.borderTop,r=t.borderRight,i=t.borderBottom,o=t.borderLeft;n&&(this.border.apply(this,ke(n)),this.line.apply(this,ke(t.topxys()))),r&&(this.border.apply(this,ke(r)),this.line.apply(this,ke(t.rightxys()))),i&&(this.border.apply(this,ke(i)),this.line.apply(this,ke(t.bottomxys()))),o&&(this.border.apply(this,ke(o)),this.line.apply(this,ke(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-15,o=r+t.height-15;e.save(),e.beginPath(),e.moveTo(Te(i),Te(o)),e.lineTo(Te(i+8),Te(o)),e.lineTo(Te(i+4),Te(o+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Te(i-8),Te(r-1)),e.lineTo(Te(i),Te(r-1)),e.lineTo(Te(i),Te(r+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Te(i-8),Te(r-1)),e.lineTo(Te(i),Te(r-1)),e.lineTo(Te(i),Te(r+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var n=this.ctx,r=t.x,i=t.y,o=t.width,a=t.height,l=t.bgcolor;n.save(),n.beginPath(),n.fillStyle=l||"#fff",n.rect(Ae(r+1),Ae(i+1),Te(o-2),Te(a-2)),n.clip(),n.fill(),e(),n.restore()}}]),t}(),De=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],ze=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function Me(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Le=function(t){for(var e=[],n=[],r=[],i=0,o="",a=1,l="",u=0;u<t.length;u+=1){var c=t.charAt(u);if(" "!==c){if(c>="a"&&c<="z")r.push(c.toUpperCase());else if(c>="0"&&c<="9"||c>="A"&&c<="Z"||"."===c)r.push(c);else if('"'===c){for(u+=1;'"'!==t.charAt(u);)r.push(t.charAt(u)),u+=1;n.push('"'.concat(r.join(""))),r=[]}else if("-"===c&&/[+\-*/,(]/.test(l))r.push(c);else{if("("!==c&&r.length>0&&n.push(r.join("")),")"===c){var s=e.pop();if(2===i)try{for(var p=Me(f(n.pop()),2),v=p[0],d=p[1],y=Me(f(n.pop()),2),g=y[0],b=y[1],m=0,w=g;w<=v;w+=1)for(var _=b;_<=d;_+=1)n.push(h(w,_)),m+=1;n.push([s,m])}catch(t){}else if(1===i||3===i)3===i&&n.push(o),n.push([s,a]),a=1;else for(;"("!==s&&(n.push(s),!(e.length<=0));)s=e.pop();i=0}else if("="===c||">"===c||"<"===c){var k=t.charAt(u+1);o=c,"="!==k&&"-"!==k||(o+=k,u+=1),i=3}else if(":"===c)i=2;else if(","===c)3===i&&n.push(o),i=1,a+=1;else if("("===c&&r.length>0)e.push(r.join(""));else{if(e.length>0&&("+"===c||"-"===c)){var x=e[e.length-1];if("("!==x&&n.push(e.pop()),"*"===x||"/"===x)for(;e.length>0&&"("!==(x=e[e.length-1]);)n.push(e.pop())}e.push(c)}r=[]}l=c}}for(r.length>0&&n.push(r.join(""));e.length>0;)n.push(e.pop());return n},We=function(t,e){var n=Me(t,1)[0],r=t;if('"'===n)return t.substring(1);var i=1;if("-"===n&&(r=t.substring(1),i=-1),r[0]>="0"&&r[0]<="9")return i*Number(r);var o=Me(f(r),2);return i*e(o[0],o[1])},He=function(t,e,n,r){for(var i=[],o=0;o<t.length;o+=1){var a=t[o],l=a[0];if("+"===a){var u=i.pop();i.push(D("+",i.pop(),u))}else if("-"===a)if(1===i.length){var c=i.pop();i.push(D("*",c,-1))}else{var s=i.pop();i.push(D("-",i.pop(),s))}else if("*"===a)i.push(D("*",i.pop(),i.pop()));else if("/"===a){var f=i.pop();i.push(D("/",i.pop(),f))}else if("="===l||">"===l||"<"===l){var h=i.pop();Number.isNaN(h)||(h=Number(h));var p=i.pop();Number.isNaN(p)||(p=Number(p));var v=!1;"="===l?v=p===h:">"===a?v=p>h:">="===a?v=p>=h:"<"===a?v=p<h:"<="===a&&(v=p<=h),i.push(v)}else if(Array.isArray(a)){for(var d=Me(a,2),y=d[0],g=d[1],b=[],m=0;m<g;m+=1)b.push(i.pop());i.push(e[y].render(b.reverse()))}else{if(r.includes(a))return 0;(l>="a"&&l<="z"||l>="A"&&l<="Z")&&r.push(a),i.push(We(a,n)),r.pop()}}return i[0]},Fe={render:function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var o=Le(e.substring(1));return o.length<=0?e:He(o,n,function(e,o){return t(r(e,o),n,r,i)},i)}return e}};function Ne(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qe(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Be=[{key:"SUM",title:U("formula.sum"),render:function(t){return t.reduce(function(t,e){return D("+",t,e)},0)}},{key:"AVERAGE",title:U("formula.average"),render:function(t){return t.reduce(function(t,e){return Number(t)+Number(e)},0)/t.length}},{key:"MAX",title:U("formula.max"),render:function(t){return Math.max.apply(Math,qe(t.map(function(t){return Number(t)})))}},{key:"MIN",title:U("formula.min"),render:function(t){return Math.min.apply(Math,qe(t.map(function(t){return Number(t)})))}},{key:"IF",title:U("formula._if"),render:function(t){var e=Ne(t,3),n=e[0],r=e[1],i=e[2];return n?r:i}},{key:"AND",title:U("formula.and"),render:function(t){return t.every(function(t){return t})}},{key:"OR",title:U("formula.or"),render:function(t){return t.some(function(t){return t})}},{key:"CONCAT",title:U("formula.concat"),render:function(t){return t.join("")}}],Ve=Be,Ue={};function $e(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||Xe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ye(t){return function(t){if(Array.isArray(t))return t}(t)||Xe(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Xe(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}Be.forEach(function(t){Ue[t.key]=t});var Ke=function(t){return t},Ze=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=Ye(Number(t).toFixed(2).toString().split("\\.")),n=e[0],r=e.slice(1);return[n.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat($e(r))}return t},Ge=[{key:"normal",title:U("format.normal"),type:"string",render:Ke},{key:"text",title:U("format.text"),type:"string",render:Ke},{key:"number",title:U("format.number"),type:"number",label:"1,000.12",render:Ze},{key:"percent",title:U("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:U("format.rmb"),type:"number",label:"￥10.00",render:function(t){return"￥".concat(Ze(t))}},{key:"usd",title:U("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Ze(t))}},{key:"eur",title:U("format.eur"),type:"number",label:"€10.00",render:function(t){return"€".concat(Ze(t))}},{key:"date",title:U("format.date"),type:"date",label:"26/09/2008",render:Ke},{key:"time",title:U("format.time"),type:"date",label:"15:59:00",render:Ke},{key:"datetime",title:U("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:Ke},{key:"duration",title:U("format.duration"),type:"date",label:"24:01:00",render:Ke}],Je={};function Qe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Ge.forEach(function(t){Je[t.key]=t});var en=5,nn={fillStyle:"#f4f5f8"},rn={fillStyle:"#fff",lineWidth:Ce,strokeStyle:"#e6e6e6"};function on(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.cellRect(e,n),o=i.left,a=i.top,l=i.width,u=i.height;return new Pe(o,a+r,l,u,en)}function an(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.sortedRowMap,a=e.rows,l=e.cols;if(!a.isHide(n)&&!l.isHide(r)){var u=n;o.has(n)&&(u=o.get(n));var c=e.getCell(u,r);if(null!==c){var s=!1;"editable"in c&&!1===c.editable&&(s=!0);var f=e.getCellStyleOrDefault(u,r),h=on(e,n,r,i);h.bgcolor=f.bgcolor,void 0!==f.border&&(h.setBorders(f.border),t.strokeBorders(h)),t.rect(h,function(){var i=Fe.render(c.text||"",Ue,function(t,n){return e.getCellTextOrDefault(n,t)});f.format&&(i=Je[f.format].render(i));var o=Object.assign({},f.font);o.size=function(t){for(var e=0;e<ze.length;e+=1){var n=ze[e];if(n.pt===t)return n.px}return t}(o.size),t.text(i,h,{align:f.align,valign:f.valign,font:o,color:f.color,strike:f.strike,underline:f.underline},f.textwrap),e.validations.getError(n,r)&&t.error(h),s&&t.frozen(h)})}}}function ln(t,e,n,r,i){var o=this.draw,a=this.data,l=lt(a.settings);o.save(),o.translate(e,n).translate(r,i);var u=a.exceptRowSet,c=a.exceptRowTotalHeight(t.sri,t.eri);o.save(),o.translate(l,-c),t.each(function(t,e){an(o,a,t,e)},function(t){return function(t){var e=u.has(t);if(e){var n=a.rows.getHeight(t);o.translate(l,-n)}return!e}(t)}),o.restore();var s=new Set;o.save(),o.translate(l,-c),a.eachMergesInView(t,function(t){var e=t.sri,n=t.sci,r=t.eri;if(u.has(e)){if(!s.has(e)){s.add(e);var i=a.rows.sumHeight(e,r+1);o.translate(l,-i)}}else an(o,a,e,n)}),o.restore(),function(t){var e=this.data,n=this.draw;if(t){var r=e.autoFilter;if(!r.active())return;var i=r.hrange();t.intersects(i)&&i.each(function(t,r){var i=on(e,t,r);n.dropdown(i)})}}.call(this,t),o.restore()}function un(t,e,n,r){var i=this.draw,o=this.data;i.save();var a=lt(o.settings);i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(a,e,n-a,r),i.restore()}function cn(t,e,n,r,i,o){var a=this,l=this.draw,u=this.data,s=this.tree,f=e.h,h=e.w,p=o+r,v=i+n,d=lt(u.settings);l.save(),l.attr(nn),"all"!==t&&"left"!==t||(ct(u.settings)?(l.fillRect(0,p,d,f),l.fillRect(d,p,n-d-1,f)):l.fillRect(0,p,n,f)),"all"!==t&&"top"!==t||l.fillRect(v,0,h,r);var y=u.selector.range,g=y.sri,b=y.sci,m=y.eri,w=y.eci;l.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(Te(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Ce(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(u.rowEach(e.sri,e.eri,function(t,e,r){var i=p+e,o=t;l.line([d,i],[d,r]),s.collapseTree(n,i,r,t),g<=o&&o<m+1&&un.call(a,0,i,n,r),l.fillText(o+1,(n-d)/2+d,i+r/2),t>0&&u.rows.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([5,i+5],[n-5,i+5]),l.restore())}),l.line([0,f+p],[n,f+p]),l.line([n,p],[n,f+p])),"all"!==t&&"top"!==t||(u.colEach(e.sci,e.eci,function(t,e,n){var i=v+e,o=t;l.line([i,0],[i,r]),b<=o&&o<w+1&&un.call(a,i,0,n,r),l.fillText(c(o),i+n/2,r/2),t>0&&u.cols.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([i+5,5],[i+5,r-5]),l.restore())}),l.line([h+v,0],[h+v,r]),l.line([0,r],[h+v,r])),l.restore()}function sn(t,e,n,r,i){var o=t.sri,a=t.sci,l=t.eri,u=t.eci,c=t.w,s=t.h,f=this.draw,h=this.data,p=h.settings,v=lt(p);f.save(),f.attr(rn).translate(e+r,n+i),f.clearRect(0,0,c,s),p.showGrid?(h.rowEach(o,l,function(t,e,n){t!==o&&f.line([v,e],[c+v,e]),t===l&&f.line([v,e+n],[c+v,e+n])}),h.colEach(a,u,function(t,e,n){t!==a&&f.line([e+v,0],[e+v,s]),t===u&&f.line([e+n+v,0],[e+n+v,s])}),f.restore()):f.restore()}var fn=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new Ie(e,n.viewWidth(),n.viewHeight()),this.data=n,this.tree=r}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,n=t.cols.indexWidth,r=e.height,i=lt(t.settings);this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var o=t.viewRange(),a=t.freezeTotalWidth(),l=t.freezeTotalHeight(),u=t.scroll,s=u.x,f=u.y;this.tree.clearAll(),sn.call(this,o,n,r,a,l),ln.call(this,o,n,r,-s,-f),cn.call(this,"all",o,n+i,r,a,l),function(t,e){var n=this.draw,r=lt(this.data.settings);n.save(),n.attr({fillStyle:"#f4f5f8"}).fillRect(r,0,t,e),n.restore()}.call(this,n,r);var h=Qe(t.freeze,2),p=h[0],v=h[1];if(p>0||v>0){if(p>0){var d=o.clone();d.sri=0,d.eri=p-1,d.h=l,sn.call(this,d,n,r,a,0),ln.call(this,d,n,r,-s,0),cn.call(this,"top",d,n+i,r,a,0)}if(v>0){var y=o.clone();y.sci=0,y.eci=v-1,y.w=a,sn.call(this,y,n,r,0,l),cn.call(this,"left",y,n+i,r,0,l),ln.call(this,y,n,r,0,-f)}var g=t.freezeViewRange();sn.call(this,g,n,r,0,0),cn.call(this,"all",g,n+i,r,0,0),ln.call(this,g,n,r,0,0),function(t,e,n,r){var i=this.draw,o=this.data,a=lt(o.settings),l=o.viewWidth()-t,u=o.viewHeight()-e;i.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([a,r],[l+a,r]),i.line([n+a,0],[n+a,u]),i.restore()}.call(this,n,r,a,l)}var b={textAlign:"center",textBaseline:"middle",font:"500 ".concat(Te(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Ce(),strokeStyle:"#e6e6e6"};this.draw.attr(b),this.draw.fillText(c(this.data.selector.ci)+(this.data.selector.ri+1),n/2+i,12.5)}},{key:"clear",value:function(){this.draw.clear()}}])&&tn(e.prototype,n),r&&tn(e,r),t}();function hn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function pn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vn=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],dn=["landscape","portrait"];function yn(t){return parseInt(96*t,10)}function gn(t){"cancel"===t?this.el.hide():this.toPrint()}var bn=function(){function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:yn(vn[0][1]),h:yn(vn[0][2]),padding:50,orientation:dn[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=a("div","".concat(Et,"-print")).children(a("div","".concat(Et,"-print-bar")).children(a("div","-title").child("Print settings"),a("div","-right").children(a("div","".concat(Et,"-buttons")).children(new _e("cancel").on("click",gn.bind(this,"cancel")),new _e("next","primary").on("click",gn.bind(this,"next"))))),a("div","".concat(Et,"-print-content")).children(this.contentEl=a("div","-content"),a("div","-sider").child(a("form","").children(a("fieldset","").children(a("label","").child("".concat(V("print.size"))),(n=a("select","")).children.apply(n,hn(vn.map(function(t,e){return a("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))}))).on("change",function(t){var e=this.paper,n=t.target.value,r=vn[n];e.w=yn(r[1]),e.h=yn(r[2]),this.preview()}.bind(this))),a("fieldset","").children(a("label","").child("".concat(V("print.orientation"))),(r=a("select","")).children.apply(r,hn(dn.map(function(t,e){return a("option","").attr("value",e).child("".concat(V("print.orientations")[e]))}))).on("change",function(t){var e=this.paper,n=t.target.value,r=dn[n];e.orientation=r,this.preview()}.bind(this))))))).hide()}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,n=this.paper,r=n.width,i=n.height,o=n.padding,l=r-2*o,u=i-2*o,c=e.contentRange(),s=parseInt(c.h/u,10)+1,f=l/c.w,h=o,p=o;f>1&&(h+=(l-c.w)/2);var v=0,d=0;this.contentEl.html(""),this.canvases=[];for(var y={sri:0,sci:0,eri:0,eci:0},g=function(n){var o=0,l=0,s=a("div","".concat(Et,"-canvas-card")),g=a("canvas","".concat(Et,"-canvas"));t.canvases.push(g.el);var b=new Ie(g.el,r,i);for(b.save(),b.translate(h,p),f<1&&b.scale(f,f);v<=c.eri;v+=1){var m=e.rows.getHeight(v);if(!((o+=m)<u)){l=-(o-m);break}for(var w=0;w<=c.eci;w+=1)an(b,e,v,w,d),y.eci=w}y.eri=v,b.restore(),b.save(),b.translate(h,p),f<1&&b.scale(f,f);var _=d;e.eachMergesInView(y,function(t){var n=t.sri,r=t.sci;an(b,e,n,r,_)}),b.restore(),y.sri=y.eri,y.sci=y.eci,d+=l,t.contentEl.child(a("div","".concat(Et,"-canvas-card-wraper")).child(s.child(g)))},b=0;b<s;b+=1)g();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=a("iframe","").hide().el;window.document.body.appendChild(e);var n=e.contentWindow,r=n.document,i=document.createElement("style");i.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),r.head.appendChild(i),this.canvases.forEach(function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),r.body.appendChild(e)}),n.print()}}])&&pn(e.prototype,n),r&&pn(e,r),t}();function mn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _n=[{key:"copy",title:U("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:U("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:U("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:U("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:U("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:U("contextmenu.insertRow")},{key:"insert-column",title:U("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:U("contextmenu.deleteRow")},{key:"delete-column",title:U("contextmenu.deleteColumn")},{key:"delete-cell-text",title:U("contextmenu.deleteCellText")},{key:"hide",title:U("contextmenu.hide")},{key:"divider"},{key:"validation",title:U("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:U("contextmenu.cellprintable")},{key:"cell-non-printable",title:U("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:U("contextmenu.celleditable")},{key:"cell-non-editable",title:U("contextmenu.cellnoneditable")}];function kn(t){var e=this;return"divider"===t.key?a("div","".concat(Et,"-item divider")):a("div","".concat(Et,"-item")).on("click",function(){e.itemClick(t.key,t.trigger),e.hide()}).children("string"==typeof t.title?t.title:t.title(),a("div","label").child(t.label||""))}var xn=function(){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.defaultContextMenu=i,this.defineContentMenu=o,this.menuItems=function(){var t=this,e=[];return this.defaultContextMenu.length?this.defaultContextMenu.forEach(function(n){e.push(kn.call(t,_n.filter(function(t){return t.key===n})[0]))}):_n.forEach(function(n){e.push(kn.call(t,n))}),this.defineContentMenu.length&&this.defineContentMenu.forEach(function(n){e.push(kn.call(t,n))}),e}.call(this),this.el=(n=a("div","".concat(Et,"-contextmenu"))).children.apply(n,mn(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=r,this.setMode("range")}var e,n,r;return e=t,(n=[{key:"setMode",value:function(t){var e=this.menuItems[this.menuItems.length-1];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),kt(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var n=this.el,r=n.show().offset().width,i=this.viewFn(),o=i.height/2,a=t;i.width-t<=r&&(a-=r),n.css("left","".concat(a,"px")),e>o?n.css("bottom","".concat(i.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):n.css("top","".concat(e,"px")).css("max-height","".concat(i.height-e,"px")).css("bottom","auto"),xt(n)}}}])&&wn(e.prototype,n),r&&wn(e,r),t}();function On(t,e){if(!e.classList.contains("active")){var n=e.getBoundingClientRect(),r=n.left,i=n.top,o=n.width,l=n.height,u=a("div","".concat(Et,"-tooltip")).html(t).show();document.body.appendChild(u.el);var c=u.box();u.css("left","".concat(r+o/2-c.width/2,"px")).css("top","".concat(i+l+2,"px")),wt(e,"mouseleave",function(){document.body.contains(u.el)&&document.body.removeChild(u.el)}),wt(e,"click",function(){document.body.contains(u.el)&&document.body.removeChild(u.el)})}}function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var En=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip=V("toolbar.".concat(e.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()}))),n&&(this.tip+=" (".concat(n,")")),this.tag=e,this.shortcut=n,this.value=r,this.el=this.element(),this.change=function(){}}var e,n,r;return e=t,(n=[{key:"element",value:function(){var t=this.tip;return a("div","".concat(Et,"-toolbar-btn")).on("mouseenter",function(e){On(t,e.target)}).attr("data-tooltip",t)}},{key:"setState",value:function(){}}])&&Sn(e.prototype,n),r&&Sn(e,r),t}();function jn(t){return(jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tn(t,e){return!e||"object"!==jn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function An(t,e,n){return(An="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Pn(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Pn(t){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rn(t,e){return(Rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var In=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tn(this,Pn(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rn(t,e)}(e,En),n=e,(r=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,n=this.tag;return this.dd=this.dropdown(),this.dd.change=function(e){return t.change(n,t.getValue(e))},An(Pn(e.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])&&Cn(n.prototype,r),i&&Cn(n,i),e}();function Dn(t){return(Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mn(t,e){return!e||"object"!==Dn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ln(t){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wn(t,e){return(Wn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hn=function(t){function e(t,n,r,i){var o,l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(l=Mn(this,Ln(e).call(this,"div","".concat(Et,"-dropdown ").concat(i)))).title=t,l.change=function(){},l.headerClick=function(){},"string"==typeof t?l.title=a("div","".concat(Et,"-dropdown-title")).child(t):r&&l.title.addClass("arrow-left"),l.contentEl=a("div","".concat(Et,"-dropdown-content")).css("width",n).hide();for(var u=arguments.length,c=new Array(u>4?u-4:0),s=4;s<u;s++)c[s-4]=arguments[s];return(o=l).setContentChildren.apply(o,c),l.headerEl=a("div","".concat(Et,"-dropdown-header")),l.headerEl.on("click",function(){"block"!==l.contentEl.css("display")?l.show():l.hide()}).children(l.title,r?a("div","".concat(Et,"-icon arrow-right")).child(a("div","".concat(Et,"-icon-img arrow-down"))):""),l.children(l.headerEl,l.contentEl),l}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wn(t,e)}(e,o),n=e,(r=[{key:"setContentChildren",value:function(){var t;(this.contentEl.html(""),arguments.length>0)&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),xt(this.parent(),function(){t.hide()})}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),kt(this.parent())}}])&&zn(n.prototype,r),i&&zn(n,i),e}();function Fn(t){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bn(t,e){return!e||"object"!==Fn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vn(t){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t,e){return(Un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $n=function(t){function e(t,n){var r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new re("align-".concat(n)),l=t.map(function(t){return(e="align-".concat(t),a("div","".concat(Et,"-item")).child(new re(e))).on("click",function(){i.setTitle(t),i.change(t)});var e});return i=Bn(this,(r=Vn(e)).call.apply(r,[this,o,"auto",!0,"bottom-left"].concat(Nn(l))))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Un(t,e)}(e,Hn),n=e,(r=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&qn(n.prototype,r),i&&qn(n,i),e}();function Yn(t){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kn(t,e){return!e||"object"!==Yn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zn(t){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gn(t,e){return(Gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Kn(this,Zn(e).call(this,"align","",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gn(t,e)}(e,In),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new $n(["left","center","right"],t)}}])&&Xn(n.prototype,r),i&&Xn(n,i),e}();function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function er(t,e){return!e||"object"!==Qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nr(t){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rr(t,e){return(rr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ir=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),er(this,nr(e).call(this,"valign","",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rr(t,e)}(e,In),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new $n(["top","middle","bottom"],t)}}])&&tr(n.prototype,r),i&&tr(n,i),e}();function or(t){return(or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lr(t,e){return!e||"object"!==or(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ur(t,e,n){return(ur="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cr(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function cr(t){return(cr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sr(t,e){return(sr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),lr(this,cr(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sr(t,e)}(e,En),n=e,(r=[{key:"element",value:function(){var t=this,n=this.tag;return ur(cr(e.prototype),"element",this).call(this).child(new re(n)).on("click",function(){return t.click()})}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&ar(n.prototype,r),i&&ar(n,i),e}();function hr(t){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vr(t,e){return!e||"object"!==hr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dr(t){return(dr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yr(t,e){return(yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),vr(this,dr(e).call(this,"autofilter"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(e,fr),n=e,(r=[{key:"setState",value:function(){}}])&&pr(n.prototype,r),i&&pr(n,i),e}();function br(t){return(br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mr(t,e){return!e||"object"!==br(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _r(t,e){return(_r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),mr(this,wr(e).call(this,"font-bold","Ctrl+B"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_r(t,e)}(e,fr),e}();function xr(t){return(xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Or(t,e){return!e||"object"!==xr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sr(t){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Er(t,e){return(Er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Or(this,Sr(e).call(this,"font-italic","Ctrl+I"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Er(t,e)}(e,fr),e}();function Cr(t){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tr(t,e){return!e||"object"!==Cr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ar(t){return(Ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pr(t,e){return(Pr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tr(this,Ar(e).call(this,"strike","Ctrl+U"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pr(t,e)}(e,fr),e}();function Ir(t){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dr(t,e){return!e||"object"!==Ir(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zr(t){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mr(t,e){return(Mr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Dr(this,zr(e).call(this,"underline","Ctrl+U"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mr(t,e)}(e,fr),e}();function Wr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Hr=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Fr=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],Nr=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function qr(t){var e=this;return a("td","").child(a("div","".concat(Et,"-color-palette-cell")).on("click.stop",function(){return e.change(t)}).css("background-color",t))}var Br=function t(){var e,n,r,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=a("div","".concat(Et,"-color-palette")),this.change=function(){};var o=a("table","").children((e=a("tbody","")).children.apply(e,[(n=a("tr","".concat(Et,"-theme-color-placeholders"))).children.apply(n,Wr(Hr.map(function(t){return qr.call(i,t)})))].concat(Wr(Fr.map(function(t){var e;return(e=a("tr","".concat(Et,"-theme-colors"))).children.apply(e,Wr(t.map(function(t){return qr.call(i,t)})))})),[(r=a("tr","".concat(Et,"-standard-colors"))).children.apply(r,Wr(Nr.map(function(t){return qr.call(i,t)})))])));this.el.child(o)};function Vr(t){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ur(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $r(t,e){return!e||"object"!==Vr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yr(t){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xr(t,e){return(Xr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kr=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new re(t).css("height","16px").css("border-bottom","3px solid ".concat(n)),o=new Br;return o.change=function(t){r.setTitle(t),r.change(t)},r=$r(this,Yr(e).call(this,i,"auto",!1,"bottom-left",o.el))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xr(t,e)}(e,Hn),n=e,(r=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&Ur(n.prototype,r),i&&Ur(n,i),e}();function Zr(t){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Jr(t,e){return!e||"object"!==Zr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qr(t){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return(ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ei=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],ni=function(t){function e(t){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new re("line-type"),o=0,l=ei.map(function(e,n){return a("div","".concat(Et,"-item state ").concat(t===e[0]?"checked":"")).on("click",function(){l[o].toggle("checked"),l[n].toggle("checked"),o=n,r.hide(),r.change(e)}).child(a("div","".concat(Et,"-line-type")).html(e[1]))});return r=Jr(this,(n=Qr(e)).call.apply(n,[this,i,"auto",!1,"bottom-left"].concat(Gr(l))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,Hn),e}();function ri(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ii(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function oi(){var t;return a("table","").child((t=a("tbody","")).children.apply(t,arguments))}function ai(t){var e=this;return a("td","").child(a("div","".concat(Et,"-border-palette-cell")).child(new re("border-".concat(t))).on("click",function(){e.mode=t;var n=e.mode,r=e.style,i=e.color;e.change({mode:n,style:r,color:i})}))}var li=function t(){var e,n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Kr("line-color",this.color),this.ddColor.change=function(t){r.color=t},this.ddType=new ni(this.style),this.ddType.change=function(t){var e=ii(t,1)[0];r.style=e},this.el=a("div","".concat(Et,"-border-palette"));var i=oi(a("tr","").children(a("td","".concat(Et,"-border-palette-left")).child(oi((e=a("tr","")).children.apply(e,ri(["all","inside","horizontal","vertical","outside"].map(function(t){return ai.call(r,t)}))),(n=a("tr","")).children.apply(n,ri(["left","top","right","bottom","none"].map(function(t){return ai.call(r,t)}))))),a("td","".concat(Et,"-border-palette-right")).children(a("div","".concat(Et,"-toolbar-btn")).child(this.ddColor.el),a("div","".concat(Et,"-toolbar-btn")).child(this.ddType.el))));this.el.child(i)};function ui(t){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ci(t,e){return!e||"object"!==ui(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function si(t){return(si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fi(t,e){return(fi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hi=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new re("border-all"),r=new li;return r.change=function(e){t.change(e),t.hide()},t=ci(this,si(e).call(this,n,"auto",!1,"bottom-left",r.el))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fi(t,e)}(e,Hn),e}();function pi(t){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function di(t,e){return!e||"object"!==pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yi(t){return(yi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gi(t,e){return(gi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),di(this,yi(e).call(this,"border"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gi(t,e)}(e,In),n=e,(r=[{key:"dropdown",value:function(){return new hi}}])&&vi(n.prototype,r),i&&vi(n,i),e}();function mi(t){return(mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _i(t,e){return!e||"object"!==mi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ki(t,e,n){return(ki="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xi(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function xi(t){return(xi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oi(t,e){return(Oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Si=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_i(this,xi(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oi(t,e)}(e,En),n=e,(r=[{key:"element",value:function(){var t=this;return ki(xi(e.prototype),"element",this).call(this).child(new re(this.tag)).on("click",function(){return t.change(t.tag)})}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&wi(n.prototype,r),i&&wi(n,i),e}();function Ei(t){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ji(t,e){return!e||"object"!==Ei(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ci(t){return(Ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ti(t,e){return(Ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ai=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ji(this,Ci(e).call(this,"clearformat"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ti(t,e)}(e,Si),e}();function Pi(t){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ri(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ii(t,e){return!e||"object"!==Pi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Di(t){return(Di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zi(t,e){return(zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ii(this,Di(e).call(this,"paintformat"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zi(t,e)}(e,fr),n=e,(r=[{key:"setState",value:function(){}}])&&Ri(n.prototype,r),i&&Ri(n,i),e}();function Li(t){return(Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hi(t,e){return!e||"object"!==Li(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fi(t){return(Fi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ni(t,e){return(Ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qi=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Hi(this,Fi(e).call(this,"color",void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ni(t,e)}(e,In),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Kr(t,e)}}])&&Wi(n.prototype,r),i&&Wi(n,i),e}();function Bi(t){return(Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ui(t,e){return!e||"object"!==Bi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $i(t){return($i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yi(t,e){return(Yi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xi=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ui(this,$i(e).call(this,"bgcolor",void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yi(t,e)}(e,In),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Kr(t,e)}}])&&Vi(n.prototype,r),i&&Vi(n,i),e}();function Ki(t){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Gi(t,e){return!e||"object"!==Ki(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ji(t){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qi(t,e){return(Qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var to=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=ze.map(function(t){return a("div","".concat(Et,"-item")).on("click",function(){n.setTitle("".concat(t.pt)),n.change(t)}).child("".concat(t.pt))});return n=Gi(this,(t=Ji(e)).call.apply(t,[this,"10","60px",!0,"bottom-left"].concat(Zi(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qi(t,e)}(e,Hn),e}();function eo(t){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function no(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ro(t,e){return!e||"object"!==eo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oo(t,e){return(oo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ao=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ro(this,io(e).call(this,"font-size"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oo(t,e)}(e,In),n=e,(r=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new to}}])&&no(n.prototype,r),i&&no(n,i),e}();function lo(t){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uo(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function co(t,e){return!e||"object"!==lo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function so(t){return(so=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fo(t,e){return(fo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ho=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=De.map(function(t){return a("div","".concat(Et,"-item")).on("click",function(){n.setTitle(t.title),n.change(t)}).child(t.title)});return n=co(this,(t=so(e)).call.apply(t,[this,De[0].title,"160px",!0,"bottom-left"].concat(uo(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fo(t,e)}(e,Hn),e}();function po(t){return(po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yo(t,e){return!e||"object"!==po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function go(t){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bo(t,e){return(bo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yo(this,go(e).call(this,"font-name"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bo(t,e)}(e,In),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new ho}}])&&vo(n.prototype,r),i&&vo(n,i),e}();function wo(t){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ko(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xo(t,e){return!e||"object"!==wo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oo(t){return(Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function So(t,e){return(So=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Eo=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Ge.slice(0);return r.splice(2,0,{key:"divider"}),r.splice(8,0,{key:"divider"}),r=r.map(function(t){var e=a("div","".concat(Et,"-item"));return"divider"===t.key?e.addClass("divider"):(e.child(t.title()).on("click",function(){n.setTitle(t.title()),n.change(t)}),t.label&&e.child(a("div","label").html(t.label))),e}),n=xo(this,(t=Oo(e)).call.apply(t,[this,"Normal","220px",!0,"bottom-left"].concat(_o(r))))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&So(t,e)}(e,Hn),n=e,(r=[{key:"setTitle",value:function(t){for(var e=0;e<Ge.length;e+=1)Ge[e].key===t&&this.title.html(Ge[e].title());this.hide()}}])&&ko(n.prototype,r),i&&ko(n,i),e}();function jo(t){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Co(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function To(t,e){return!e||"object"!==jo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ao(t){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Po(t,e){return(Po=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ro=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),To(this,Ao(e).call(this,"format"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Po(t,e)}(e,In),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Eo}}])&&Co(n.prototype,r),i&&Co(n,i),e}();function Io(t){return(Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Do(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function zo(t,e){return!e||"object"!==Io(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mo(t){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lo(t,e){return(Lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wo=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Be.map(function(t){return a("div","".concat(Et,"-item")).on("click",function(){n.hide(),n.change(t)}).child(t.key)});return n=zo(this,(t=Mo(e)).call.apply(t,[this,new re("formula"),"180px",!0,"bottom-left"].concat(Do(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lo(t,e)}(e,Hn),e}();function Ho(t){return(Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function No(t,e){return!e||"object"!==Ho(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qo(t){return(qo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bo(t,e){return(Bo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),No(this,qo(e).call(this,"formula"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bo(t,e)}(e,In),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Wo}}])&&Fo(n.prototype,r),i&&Fo(n,i),e}();function Uo(t){return(Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){return!e||"object"!==Uo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yo(t){return(Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xo(t,e){return(Xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ko=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),$o(this,Yo(e).call(this,"freeze"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xo(t,e)}(e,fr),e}();function Zo(t){return(Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Go(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jo(t,e){return!e||"object"!==Zo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qo(t){return(Qo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ta(t,e){return(ta=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ea=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Jo(this,Qo(e).call(this,"merge"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ta(t,e)}(e,fr),n=e,(r=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&Go(n.prototype,r),i&&Go(n,i),e}();function na(t){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ra(t,e){return!e||"object"!==na(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ia(t){return(ia=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oa(t,e){return(oa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var aa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ra(this,ia(e).call(this,"redo","Ctrl+Y"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oa(t,e)}(e,Si),e}();function la(t){return(la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ua(t,e){return!e||"object"!==la(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ca(t){return(ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sa(t,e){return(sa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ua(this,ca(e).call(this,"undo","Ctrl+Z"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sa(t,e)}(e,Si),e}();function ha(t){return(ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pa(t,e){return!e||"object"!==ha(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function va(t){return(va=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function da(t,e){return(da=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ya=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),pa(this,va(e).call(this,"print","Ctrl+P"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&da(t,e)}(e,Si),e}();function ga(t){return(ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ba(t,e){return!e||"object"!==ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ma(t){return(ma=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wa(t,e){return(wa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ba(this,ma(e).call(this,"textwrap"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wa(t,e)}(e,fr),e}();function ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xa(t){return(xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sa(t,e){return!e||"object"!==xa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ea(t){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ja(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ca(t,e)}function Ca(t,e){return(Ca=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ta=function(t){function e(){var t;Oa(this,e);var n=new re("ellipsis"),r=a("div","".concat(Et,"-toolbar-more"));return(t=Sa(this,Ea(e).call(this,n,"auto",!1,"bottom-right",r))).moreBtns=r,t.contentEl.css("max-width","420px"),t}return ja(e,Hn),e}(),Aa=function(t){function e(){var t;return Oa(this,e),(t=Sa(this,Ea(e).call(this,"more"))).el.hide(),t}var n,r,i;return ja(e,In),n=e,(r=[{key:"dropdown",value:function(){return new Ta}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&ka(n.prototype,r),i&&ka(n,i),e}();function Pa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ra=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip=V("toolbar.".concat(e.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()}))),n&&(this.tip+=" ".concat(n)),this.tag=e,this.shortcut=n,this.icon=r,this.el=this.element(),this.change=function(){}}var e,n,r;return e=t,(n=[{key:"element",value:function(){var t=this.tip;return a("div","".concat(Et,"-toolbar-btn")).on("mouseenter",function(e){On(t,e.target)}).attr("data-tooltip",t)}},{key:"setState",value:function(){}}])&&Pa(e.prototype,n),r&&Pa(e,r),t}();function Ia(t){return(Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function za(t,e){return!e||"object"!==Ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ma(t,e,n){return(Ma="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=La(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function La(t){return(La=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wa(t,e){return(Wa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ha=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),za(this,La(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wa(t,e)}(e,Ra),n=e,(r=[{key:"element",value:function(){var t=this,n=this.createIcon(this.tag);return Ma(La(e.prototype),"element",this).call(this).child(n).on("click",function(){return t.change(t.tag)})}},{key:"setState",value:function(t){this.el.disabled(t)}},{key:"createIcon",value:function(t){var e=document.createElement("div");return e.style.cssText="\n        text-align: center;\n        display: inline-block;\n        vertical-align: middle;\n        height: 18px; \n        width: 18px;\n        background-size: 100% 100%;\n        opacity: 0.56;\n        background-image:url(".concat(this.icon,");"),e}}])&&Da(n.prototype,r),i&&Da(n,i),e}();function Fa(t){return(Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Na(t,e){return!e||"object"!==Fa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qa(t){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ba(t,e){return(Ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Va=function(t){function e(t,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Na(this,qa(e).call(this,t,n,r))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ba(t,e)}(e,Ha),e}();function Ua(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ya(){return a("div","".concat(Et,"-toolbar-divider"))}function Xa(){var t,e,n=this.el,r=this.btns,i=this.moreEl,o=this.btns2,a=i.dd,l=a.moreBtns,u=a.contentEl;n.css("width","".concat(this.widthFn()-60,"px"));var c=n.box(),s=160,f=12,h=[],p=[];o.forEach(function(t,e){var n=$a(t,2),r=n[0],i=n[1];s+=i,e===o.length-1||s<c.width?h.push(r):(f+=i,p.push(r))}),(t=r.html("")).children.apply(t,h),(e=l.html("")).children.apply(e,p),u.css("width","".concat(f,"px")),p.length>0?i.show():i.hide()}var Ka=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.change=function(){},this.widthFn=n,this.isHide=i,this.defaultToolbar=o,this.defaultToolbar=this.defineToolbar;var u=e.defaultStyle();this.items=[[this.undoEl=new fa,this.redoEl=new aa,new ya,this.paintformatEl=new Mi,this.clearformatEl=new Ai],Ya(),[this.formatEl=new Ro],Ya(),[this.fontEl=new mo,this.fontSizeEl=new ao],Ya(),[this.boldEl=new kr,this.italicEl=new jr,this.underlineEl=new Lr,this.strikeEl=new Rr,this.textColorEl=new qi(u.color)],Ya(),[this.fillColorEl=new Xi(u.bgcolor),this.borderEl=new bi,this.mergeEl=new ea],Ya(),[this.alignEl=new Jn(u.align),this.valignEl=new ir(u.valign),this.textwrapEl=new _a],Ya(),[this.freezeEl=new Ko,this.autofilterEl=new gr,this.formulaEl=new Vo,this.moreEl=new Aa]],o.length&&(this.items=[],o.forEach(function(t){if("string"==typeof t)switch(t){case"divider":r.items.push(Ya())}else if(Array.isArray(t)){var e=[];t.forEach(function(t){switch(t){case"undo":e.push(r.undoEl=new fa);break;case"redo":e.push(r.redoEl=new aa);break;case"print":e.push(new ya);break;case"paintformat":e.push(r.paintformatEl=new Mi);break;case"clearformat":e.push(r.clearformatEl=new Ai);break;case"format":e.push(r.formatEl=new Ro);break;case"font":e.push(r.fontEl=new mo);break;case"fontSize":e.push(r.fontSizeEl=new ao);break;case"bold":e.push(r.boldEl=new kr);break;case"italic":e.push(r.italicEl=new jr);break;case"underline":e.push(r.underlineEl=new Lr);break;case"strike":e.push(r.strikeEl=new Rr);break;case"textColor":e.push(r.textColorEl=new qi(u.color));break;case"fillColor":e.push(r.fillColorEl=new Xi(u.bgcolor));break;case"border":e.push(r.borderEl=new bi);break;case"merge":e.push(r.mergeEl=new ea);break;case"align":e.push(r.alignEl=new Jn(u.align));break;case"valign":e.push(r.valignEl=new ir(u.valign));break;case"textwrap":e.push(r.textwrapEl=new _a);break;case"freeze":e.push(r.freezeEl=new Ko);break;case"autofilter":e.push(r.autofilterEl=new gr);break;case"formula":e.push(r.formulaEl=new Vo);break;case"more":e.push(r.moreEl=new Aa)}}),r.items.push(e)}})),l.length&&l.forEach(function(t){if("string"==typeof t)switch(t){case"divider":r.items.push(Ya())}else if(Array.isArray(t)){var e=[];t.forEach(function(t){e.push(new Va(t.key,t.title,t.icon))}),r.items.push(e)}}),this.el=a("div","".concat(Et,"-toolbar")),this.btns=a("div","".concat(Et,"-toolbar-btns")),this.items.forEach(function(t){Array.isArray(t)?t.forEach(function(t){r.btns.child(t.el),t.change=function(){r.change.apply(r,arguments)}}):r.btns.child(t.el)}),this.el.child(this.btns),i?this.el.hide():(this.reset(),setTimeout(function(){(function(){var t=this;this.btns2=[],this.items.forEach(function(e){if(Array.isArray(e))e.forEach(function(e){var n=e.el,r=n.box(),i=n.computedStyle(),o=i.marginLeft,a=i.marginRight;t.btns2.push([n,r.width+parseInt(o,10)+parseInt(a,10)])});else{var n=e.box(),r=e.computedStyle(),i=r.marginLeft,o=r.marginRight;t.btns2.push([e,n.width+parseInt(i,10)+parseInt(o,10)])}})}).call(r),Xa.call(r)},0),wt(window,"resize",function(){Xa.call(r)}))}var e,n,r;return e=t,(n=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var n=e.font,r=e.format;this.formatEl.setState(r),this.fontEl.setState(n.name),this.fontSizeEl.setState(n.size),this.boldEl.setState(n.bold),this.italicEl.setState(n.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&Ua(e.prototype,n),r&&Ua(e,r),t}();function Za(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ga(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ja=function(){function t(e,n){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title=e,this.el=a("div","".concat(Et,"-modal")).css("width",o).children(a("div","".concat(Et,"-modal-header")).children(new re("close").on("click.stop",function(){return i.hide()}),this.title),(r=a("div","".concat(Et,"-modal-content"))).children.apply(r,Za(n))).hide()}var e,n,r;return e=t,(n=[{key:"show",value:function(){var t=this;this.dimmer=a("div","".concat(Et,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),n=e.width,r=e.height,i=document.documentElement,o=i.clientHeight,l=i.clientWidth;this.el.offset({left:(l-n)/2,top:(o-r)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},wt(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),_t(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&Ga(e.prototype,n),r&&Ga(e,r),t}();function Qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var tl=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=a("div","".concat(Et,"-form-input")),this.input=a("input","").css("width",e).on("input",function(t){return r.vchange(t)}).attr("placeholder",n),this.el.child(this.input)}var e,n,r;return e=t,(n=[{key:"focus",value:function(){var t=this;setTimeout(function(){t.input.el.focus()},10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&Qa(e.prototype,n),r&&Qa(e,r),t}();function el(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var nl=function(){function t(e,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e,this.getTitle=o,this.vchange=function(){},this.el=a("div","".concat(Et,"-form-select")),this.suggest=new Gt(n.map(function(t){return{key:t,title:i.getTitle(t)}}),function(t){i.itemClick(t.key),l(t.key),i.vchange(t.key)},r,this.el),this.el.children(this.itemEl=a("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",function(){return i.show()})}var e,n,r;return e=t,(n=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&el(e.prototype,n),r&&el(e,r),t}();function rl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var il={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},ol=function(){function t(e,n,r,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=n,r&&(this.label=a("label","label").css("width","".concat(i,"px")).html(r)),this.tip=a("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return o.validate()},this.el=a("div","".concat(Et,"-form-field")).children(this.label,e.el,this.tip)}var e,n,r;return e=t,(n=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,r=this.el,i=t.val();if(e.required&&/^\s*$/.test(i))return n.html(V("validation.required")),r.addClass("error"),!1;if((e.type||e.pattern)&&!(e.pattern||il[e.type]).test(i))return n.html(V("validation.notMatch")),r.addClass("error"),!1;return r.removeClass("error"),!0}}])&&rl(e.prototype,n),r&&rl(e,r),t}();function al(t){return(al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ul(t,e){return!e||"object"!==al(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cl(t){return(cl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sl(t,e){return(sl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fl=100,hl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new ol(new nl("cell",["cell"],"100%",function(t){return V("dataValidation.modeType.".concat(t))}),{required:!0},"".concat(V("dataValidation.range"),":"),fl),r=new ol(new tl("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),i=new ol(new nl("list",["list","number","date","phone","email"],"100%",function(t){return V("dataValidation.type.".concat(t))},function(e){return t.criteriaSelected(e)}),{required:!0},"".concat(V("dataValidation.criteria"),":"),fl),o=new ol(new nl("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",function(t){return V("dataValidation.operator.".concat(t))},function(e){return t.criteriaOperatorSelected(e)}),{required:!0}).hide(),l=new ol(new tl("70px","10"),{required:!0}).hide(),u=new ol(new tl("70px","100"),{required:!0,type:"number"}).hide(),c=new ol(new tl("120px","a,b,c"),{required:!0}),s=new ol(new tl("70px","10"),{required:!0,type:"number"}).hide();return(t=ul(this,cl(e).call(this,V("contextmenu.validation"),[a("div","".concat(Et,"-form-fields")).children(n.el,r.el),a("div","".concat(Et,"-form-fields")).children(i.el,o.el,l.el,u.el,s.el,c.el),a("div","".concat(Et,"-buttons")).children(new _e("cancel").on("click",function(){return t.btnClick("cancel")}),new _e("remove").on("click",function(){return t.btnClick("remove")}),new _e("save","primary").on("click",function(){return t.btnClick("save")}))]))).mf=n,t.rf=r,t.cf=i,t.of=o,t.minvf=l,t.maxvf=u,t.vf=s,t.svf=c,t.change=function(){},t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sl(t,e)}(e,Ja),n=e,(r=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",n=this.vf;n.input.hint(e),n.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,r=this.maxvf,i=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,r.rule.type=t,"date"===t?(n.hint("2018-11-12"),r.hint("2019-11-12")):(n.hint("10"),r.hint("100")),n.show(),r.show(),i.hide(),o.hide()):("list"===t?o.show():o.hide(),i.hide(),e.hide(),n.hide(),r.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,n=this.maxvf,r=this.vf;if("be"===t||"nbe"===t)e.show(),n.show(),r.hide();else{var i=this.cf.val();r.rule.type=i,"date"===i?r.hint("2018-11-12"):r.hint("10"),r.show(),e.hide(),n.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var r=this[e[n]];if(r.isShow()&&!r.validate())return}var i=this.mf.val(),o=this.rf.val(),a=this.cf.val(),l=this.of.val(),u=this.svf.val();"number"!==a&&"date"!==a||(u="be"===l||"nbe"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,o,{type:a,operator:l,required:!1,value:u}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,n=this.rf,r=this.cf,i=this.of,o=this.svf,a=this.vf,l=this.minvf,u=this.maxvf,c=t.mode,s=t.ref,f=t.validator||{type:"list"},h=f.type,p=f.operator,v=f.value;e.val(c||"cell"),n.val(s),r.val(h),i.val(p),Array.isArray(v)?(l.val(v[0]),u.val(v[1])):(o.val(v||""),a.val(v||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(p)}this.show()}}])&&ll(n.prototype,r),i&&ll(n,i),e}();function pl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vl(t){return a("div","".concat(Et,"-item ").concat(t))}function dl(t){var e=this;return vl("state").child(V("sort.".concat(t))).on("click.stop",function(){return e.itemClick(t)})}function yl(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var gl=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=a("div","".concat(Et,"-body")),this.filterhEl=a("div","".concat(Et,"-header state")).on("click.stop",function(){return e.filterClick(0,"all")}),this.el=a("div","".concat(Et,"-sort-filter")).children(this.sortAscEl=dl.call(this,"asc"),this.sortDescEl=dl.call(this,"desc"),vl("divider"),a("div","".concat(Et,"-filter")).children(this.filterhEl,this.filterbEl),a("div","".concat(Et,"-buttons")).children(new _e("cancel").on("click",function(){return e.btnClick("cancel")}),new _e("ok","primary").on("click",function(){return e.btnClick("ok")}))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var e,n,r;return e=t,(n=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,n=this.sort,r=this.filterValues;this.ok&&this.ok(e,n,"in",r)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,r=this.filterValues,i=this.values,o=n.children();"all"===e?o.length===r.length?(this.filterValues=[],o.forEach(function(t){return a(t).checked(!1)})):(this.filterValues=Array.from(i),o.forEach(function(t){return a(t).checked(!0)})):a(o[t]).toggle("checked")?r.push(e):r.splice(r.findIndex(function(t){return t===e}),1);yl.call(this)}},{key:"set",value:function(t,e,n,r){this.ci=t;var i=this.sortAscEl,o=this.sortDescEl;null!==r?(this.sort=r.order,i.checked(r.asc()),o.checked(r.desc())):(this.sortDesc=null,i.checked(!1),o.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),function(t){var e=this,n=this.filterbEl,r=this.filterValues;n.html(""),Object.keys(t).forEach(function(i,o){var l=t[i],u=r.includes(i)?"checked":"";n.child(a("div","".concat(Et,"-item state ").concat(u)).on("click.stop",function(){return e.filterClick(o,i)}).children(""===i?V("filter.empty"):i,a("div","label").html("(".concat(l,")"))))})}.call(this,e,n),yl.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;xt(this.el,function(){n<=0&&e.hide(),n-=1})}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),kt(this.el)}}])&&pl(e.prototype,n),r&&pl(e,r),t}();function bl(t,e){var n=a("div","".concat(Et,"-toast")),r=a("div","".concat(Et,"-dimmer active"));n.children(a("div","".concat(Et,"-toast-header")).children(new re("close").on("click.stop",function(){return document.body.removeChild(n.el),void document.body.removeChild(r.el)}),t),a("div","".concat(Et,"-toast-content")).html(e)),document.body.appendChild(n.el),document.body.appendChild(r.el);var i=n.box(),o=i.width,l=i.height,u=document.documentElement,c=u.clientHeight,s=u.clientWidth;n.offset({left:(s-o)/2,top:(c-l)/3})}function ml(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wl=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.data=n,this.cb=r,this.isMove=!1,this.move={},this.renderFixHead()}var e,n,r;return e=t,(n=[{key:"renderFixHead",value:function(){var t=this.data.settings;if(ct(t)&&ut(t)>0){for(var e='<ul class="fixedTreeLevel">',n=0;n<ut(t);n++)e+="<li>".concat(n+1,"</li>");e+="</ul>",e+="<div class=\"tree-move\" style='width: 15px; height: 15px; background: rgba(0,0,0,.5); position: absolute;\n            display: none'></div>",this.el.innerHTML=e}}},{key:"collapseTree",value:function(t,e,n,r){var i=this.data.settings;this.el.contains(this.el.querySelector(".fixTree"))||(this.el.innerHTML=this.el.innerHTML+'<div class="fixTree"></div>');var o=i.tree&&i.tree.data?i.tree.data:[],a=this.el.querySelector(".fixTree");if(!this.el.querySelector('[attr="'.concat(r,'"]'))){var l=o.filter(function(t){return t.ri===r});if(l.length){var u="";u+="<div class='treeNodeContent' data-index=\"".concat(r,"\" style='width: ").concat(25*i.tree.maxLength,"px; top: ").concat(e+4-n,"px;'>\n                    <div\n                        attr=\"").concat(r,'"\n                        class="treeNode"\n                        style="\n                            left: ').concat(l[0].level*at+4,'px;\n                            top: 0;\n                        ">');for(var c=0;c<l[0].level;c++)u+='\n                        <span class="lineY"\n                            style="\n                                height: '.concat(n,"px;\n                                left: ").concat(c*at-l[0].level*at+7,'px;\n                                top: -4px;\n                            "\n                        ></span>\n                    '),l[0].lastChild&&l[0].level-1===c&&(u+='\n                        <span class="lineX"\n                            style="\n                                width: 12px;\n                                left: '.concat(c*at-l[0].level*at+7,"px;\n                                top: ").concat(n-5,'px;\n                            "\n                        ></span>\n                    '));u+="\n                        ".concat(l[0].childrenLen?'<span class="collpase">'+(l[0].expand?"-":"+")+'<i class="line" style="width:'+25*(i.tree.maxLength-l[0].level)+'px"></i></span>':'<span class="circle">'+(0===r?"":".")+'<i class="line" style="width:'+25*(i.tree.maxLength-l[0].level)+'px"></i></span>',"\n                    </div>\n                </div>\n                "),a.innerHTML=a.innerHTML+u}}}},{key:"clearAll",value:function(){var t=this.el.querySelector(".fixTree");t&&this.el.removeChild(t)}},{key:"clickEvt",value:function(t,e,n,r,i,o,a){if(-1===e){var l=this.data.settings,u=l.tree&&l.tree.data?l.tree.data.filter(function(e){return e.ri===t}):[];if(this.move=u[0],u.length){var c=this.el.querySelector('[attr="'.concat(t,'"]')),s=parseInt(c.style.left),f=parseInt(c.style.top)+25,h={left:s,top:f,bottom:16+f,right:16+s};if(l.tree&&o<25*l.tree.maxLength&&!(o<h.right&&o>h.left)){document.querySelector(".x-spreadsheet-overlayer").style.cursor="move";var p=this.el.querySelector(".tree-move");p.style.display="block",p.style.left="".concat(o-8,"px"),p.style.right="".concat(a-8,"px"),document.onmousemove=function(t){p.style.left="".concat(t.offsetX-8,"px"),p.style.top="".concat(t.offsetY-8,"px")},document.onmouseup=function(){document.onmousemove=null}}o<h.right&&o>h.left&&this.cb({mousedownItem:u[0],type:"mousedown"})}}}},{key:"moveEvt",value:function(t,e,n,r,i,o,a,l){if(-1===e){var u=this.data.settings;if((u.tree&&u.tree.data?u.tree.data.filter(function(e){return e.ri===t}):[]).length){var c=this.el.querySelector('[attr="'.concat(t,'"]'));if(!c)return;var s=parseInt(c.style.left),f=parseInt(c.style.top)+25,h={left:s,top:f,bottom:16+f,right:16+s},p=document.querySelector(".x-spreadsheet-overlayer");p.style.cursor=o<h.right&&o>h.left&&!l?"pointer":"default",l&&(c.querySelector(".line").style.display="inline-block",this.removeLine(t))}}}},{key:"removeLine",value:function(t){var e=this;this.data.settings.tree.data.forEach(function(n){if(n.ri!==t){var r=e.el.querySelector('[attr="'.concat(n.ri,'"]'));if(!r)return;r.querySelector(".line").style.display="none"}})}},{key:"mouseupEvt",value:function(t,e,n,r,i,o,a){var l=this.data.settings;if(l.tree){var u=l.tree&&l.tree.data?l.tree.data.filter(function(e){return e.ri===t}):[];document.querySelector(".x-spreadsheet-overlayer").style.cursor="default",this.el.querySelector(".tree-move").style.display="none",u.length&&l.tree&&o<25*l.tree.maxLength&&this.move&&0!==this.move.ri&&0!==u[0].ri&&this.move.ri<l.tree.data.length&&u[0].ri<l.tree.data.length&&this.check(this.move,u[0])&&this.cb({mousedownItem:this.move,type:"mouseup",mouseupItem:u[0]});var c=this.el.querySelector('[attr="'.concat(t,'"]'));c&&(c.querySelector(".line").style.display="none")}}},{key:"check",value:function(t,e){var n=this.data.settings,r=!0,i=t.id,o=e.parent?e.parent.id:"";if(t.childrenLen>0){!function t(e){e&&n.tree.data.forEach(function(n){n.id===e&&(n.id===i&&(r=!1),t(n.parent?n.parent.id:""))})}(o)}return r}},{key:"resetData",value:function(t){this.data.settings.tree=t.tree,this.renderFixHead()}}])&&ml(e.prototype,n),r&&ml(e,r),t}();function _l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function xl(t,e){var n,r=this;return function(){for(var i=r,o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];var u=a;n||(n=setTimeout(function(){n=null,t.apply(i,u)},e))}}function Ol(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==n){var o=this.table,a=this.selector,l=this.toolbar,u=this.data;this.contextMenu.setMode(-1===e||-1===n?"row-col":"range");var c=u.getCell(e,n);t?(a.setEnd(e,n,i),this.trigger("cells-selected",c,a.range)):(a.set(e,n,r),this.trigger("cell-selected",c,e,n)),l.reset(),o.render()}}function Sl(t,e){var n=this.selector,r=this.data,i=r.rows,o=r.cols,a=kl(n.indexes,2),l=a[0],u=a[1],c=n.range,s=c.eri,f=c.eci;if(t){var h=kl(n.moveIndexes,2);l=h[0],u=h[1]}"left"===e?u>0&&(u-=1):"right"===e?(f!==u&&(u=f),u<o.len-1&&(u+=1)):"up"===e?l>0&&(l-=1):"down"===e?(s!==l&&(l=s),l<i.len-1&&(l+=1)):"row-first"===e?u=0:"row-last"===e?u=o.len-1:"col-first"===e?l=0:"col-last"===e&&(l=i.len-1),t&&(n.moveIndexes=[l,u]),Ol.call(this,t,l,u),function(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRect(),i=r.l,o=r.t,a=r.left,l=r.top,u=r.width,c=r.height,s=this.getTableOffset();if(Math.abs(a)+u>s.width)n.move({left:i+u-s.width});else{var f=t.freezeTotalWidth();a<f&&n.move({left:i-1-f})}if(Math.abs(l)+c>s.height)e.move({top:o+c-s.height-1});else{var h=t.freezeTotalHeight();l<h&&e.move({top:o-1-h})}}.call(this)}function El(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function jl(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth())}function Cl(){var t=this.tableEl,e=this.overlayerEl,n=this.overlayerCEl,r=this.table,i=this.toolbar,o=this.selector,a=this.el,l=this.getTableOffset(),u=this.getRect();t.attr(u),e.offset(u),n.offset(l),a.css("width","".concat(u.width,"px")),El.call(this),jl.call(this),function(){var t=this.selector,e=this.data,n=this.editor,r=kl(e.freeze,2),i=r[0],o=r[1];if(i>0||o>0){var a=e.freezeTotalWidth(),l=e.freezeTotalHeight();n.setFreezeLengths(a,l)}t.resetAreaOffset()}.call(this),r.render(),i.reset(),o.reset()}function Tl(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function Al(){var t=this.data,e=this.selector;t.copy(),e.showClipboard()}function Pl(){var t=this.data,e=this.selector;t.cut(),e.showClipboard()}function Rl(t,e){var n=this.data;if("read"!==n.settings.mode)if(n.paste(t,function(t){return bl("Tip",t)}))Cl.call(this);else if(e){var r=e.clipboardData.getData("text/plain");this.data.pasteFromText(r),Cl.call(this)}}function Il(t){this.data.hideRowsOrCols(t),Cl.call(this)}function Dl(t,e){this.data.unhideRowsOrCols(t,e),Cl.call(this)}function zl(t){var e=this,n=this.selector,r=this.data,i=this.table,o=this.sortFilter,a=t.offsetX,l=t.offsetY,u=t.target.className==="".concat(Et,"-selector-corner"),c=r.getCellRectByXY(a,l),s=c.left,f=c.top,h=c.width,p=c.height,v=c.ri,d=c.ci,y=r.autoFilter,g=lt(r.settings);if(this.dragFlag=!0,y.includes(v,d)&&s+h-20<a&&f+p-20<l){var b=y.items(d,function(t,e){return r.rows.getCell(t,e)});return o.set(d,b,y.getFilter(d),y.getSort(d)),void o.setOffset({left:s,top:f+p+2})}this.tree.clickEvt(v,d,f,p,h,a,l),t.shiftKey||(u?n.showAutofill(v,d):a>g&&Ol.call(this,!1,v,d),Ot(window,function(t){var i=r.getCellRectByXY(t.offsetX,t.offsetY);v=i.ri,d=i.ci,u?n.showAutofill(v,d):1!==t.buttons||t.shiftKey||a>g&&Ol.call(e,!0,v,d,!0,!0)},function(){u&&n.arange&&"read"!==r.settings.mode&&r.autofill(n.arange,"all",function(t){return bl("Tip",t)})&&i.render(),n.hideAutofill(),function(){var t=this.toolbar;t.paintformatActive()&&(Rl.call(this,"format"),Tl.call(this),t.paintformatToggle())}.call(e)})),u||1!==t.buttons||t.shiftKey&&a>g&&Ol.call(this,!0,v,d)}function Ml(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),r="top";e.top>n.height/2&&(r="bottom"),t.setOffset(e,r)}function Ll(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(Ml.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),Tl.call(this))}function Wl(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",n=this.data,r=this.table;if("read"!==n.settings.mode){n.setSelectedCellText(t,e);var i=n.selector,o=i.ri,a=i.ci;"finished"===e?r.render():this.trigger("cell-edited",t,o,a)}}function Hl(t){var e=this.data;"insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),Tl.call(this),Cl.call(this)}function Fl(t,e){var n=this,r=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?Al.call(this):Tl.call(this);else if("clearformat"===t)Hl.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)(function(){this.data.autofilter(),Cl.call(this)}).call(this);else if("freeze"===t)if(e){var i=r.selector,o=i.ri,a=i.ci;this.freeze(o,a)}else this.freeze(0,0);else{if(r.settings.defineToolbar)return void r.settings.defineToolbar.forEach(function(e){Array.isArray(e)&&e.forEach(function(e){t===e.trigger&&n.trigger(e.trigger,n.data)})});r.setSelectedCellAttr(t,e),"formula"!==t||r.selector.multiple()||Ll.call(this),Cl.call(this)}}function Nl(){var t,e,n,r,i,o,a=this,l=this.selector,u=this.overlayerEl,c=this.rowResizer,s=this.colResizer,f=this.verticalScrollbar,h=this.horizontalScrollbar,p=this.editor,v=this.contextMenu,d=this.toolbar,y=this.modalValidation,g=this.sortFilter;u.on("mousedown",function(t){p.clear(),v.hide(),2===t.buttons?(a.data.xyInSelectedRect(t.offsetX,t.offsetY)?v.setPosition(t.offsetX,t.offsetY):(zl.call(a,t),v.setPosition(t.offsetX,t.offsetY)),t.stopPropagation()):2===t.detail?Ll.call(a):zl.call(a,t)}).on("mousewheel.stop",function(t){(function(t){var e=this.verticalScrollbar,n=this.horizontalScrollbar,r=this.data,i=e.scroll().top,o=n.scroll().left,a=r.rows,l=r.cols,u=t.deltaY,c=t.deltaX,s=function(t,e){var n=t,r=0;do{r=e(n),n+=1}while(r<=0);return r},f=function(t){if(t>0){var n=r.scroll.ri+1;if(n<a.len){var o=s(n,function(t){return a.getHeight(t)});e.move({top:i+o-1})}}else{var l=r.scroll.ri-1;if(l>=0){var u=s(l,function(t){return a.getHeight(t)});e.move({top:0===l?0:i-u})}}},h=Math.abs(u),p=Math.abs(c),v=Math.max(h,p);/Firefox/i.test(window.navigator.userAgent)&&xl(f(t.detail),50),v===p&&xl(function(t){if(t>0){var e=r.scroll.ci+1;if(e<l.len){var i=s(e,function(t){return l.getWidth(t)});n.move({left:o+i-1})}}else{var a=r.scroll.ci-1;if(a>=0){var u=s(a,function(t){return l.getWidth(t)});n.move({left:0===a?0:o-u})}}}(c),50),v===h&&xl(f(u),50)}).call(a,t)}).on("mousemove",function(t){(function(t){var e=t.offsetX,n=t.offsetY,r=this.rowResizer,i=this.colResizer,o=this.tableEl,a=this.data,l=a.rows,u=a.cols,c=a.getCellRectByXY(e,n),s=(c.left,c.top),f=c.width,h=c.height,p=c.ri,v=c.ci;if(this.tree.moveEvt(p,v,s,h,f,e,n,this.dragFlag),0===t.buttons&&t.target.className!=="".concat(Et,"-resizer-hover")){if(e>u.indexWidth&&n>l.height)return r.hide(),void i.hide();var d=o.box(),y=a.getCellRectByXY(t.offsetX,t.offsetY);y.ri>=0&&-1===y.ci?(y.width=u.indexWidth,r.show(y,{width:d.width}),l.isHide(y.ri-1)?r.showUnhide(y.ri):r.hideUnhide()):r.hide(),-1===y.ri&&y.ci>=0?(y.height=l.height,i.show(y,{height:d.height}),u.isHide(y.ci-1)?i.showUnhide(y.ci):i.hideUnhide()):i.hide()}}).call(a,t)}).on("mouseup",function(t){(function(t){var e=t.offsetX,n=t.offsetY,r=this.data.getCellRectByXY(e,n),i=(r.left,r.top),o=r.width,a=r.height,l=r.ri,u=r.ci;this.dragFlag=!1,this.tree.mouseupEvt(l,u,i,a,o,e,n)}).call(a,t)}).on("mouseout",function(t){var e=t.offsetX;t.offsetY<=0&&s.hide(),e<=0&&c.hide()}),l.inputChange=function(t){Wl.call(a,t,"input"),Ll.call(a)},t=u.el,n=(e={move:function(t,e){(function(t,e){var n=this.verticalScrollbar,r=this.horizontalScrollbar,i=n.scroll().top,o=r.scroll().left;"left"===t||"right"===t?r.move({left:o-e}):"up"!==t&&"down"!==t||n.move({top:i-e})}).call(a,t,e)}}).move,r=e.end,i=0,o=0,wt(t,"touchstart",function(t){var e=t.touches[0],n=e.pageX,r=e.pageY;i=n,o=r}),wt(t,"touchmove",function(t){if(n){var e=t.changedTouches[0],r=e.pageX,a=e.pageY,l=r-i,u=a-o;(Math.abs(l)>10||Math.abs(u)>10)&&(St(l,u,t,n),i=r,o=a),t.preventDefault()}}),wt(t,"touchend",function(t){if(r){var e=t.changedTouches[0],n=e.pageX,a=e.pageY;St(n-i,a-o,t,r)}}),d.change=function(t,e){return Fl.call(a,t,e)},g.ok=function(t,e,n,r){return function(t,e,n,r){this.data.setAutoFilter(t,e,n,r),Cl.call(this)}.call(a,t,e,n,r)},c.finishedFn=function(t,e){(function(t,e){var n=t.ri,r=this.table,i=this.selector;this.data.rows.setHeight(n,e),r.render(),i.resetAreaOffset(),El.call(this),Ml.call(this)}).call(a,t,e)},s.finishedFn=function(t,e){(function(t,e){var n=t.ci,r=this.table,i=this.selector;this.data.cols.setWidth(n,e),r.render(),i.resetAreaOffset(),jl.call(this),Ml.call(this)}).call(a,t,e)},c.unhideFn=function(t){Dl.call(a,"row",t)},s.unhideFn=function(t){Dl.call(a,"col",t)},f.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrolly(t,function(){i.resetBRLAreaOffset(),Ml.call(e),r.render()})}).call(a,t,e)},h.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrollx(t,function(){i.resetBRTAreaOffset(),Ml.call(e),r.render()})}).call(a,t,e)},p.change=function(t,e){Wl.call(a,e,t)},y.change=function(t){if("save"===t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=a.data).addValidation.apply(e,r)}else a.data.removeValidation()},v.itemClick=function(t,e){if("validation"===t)y.setValue(a.data.getSelectedValidation());else if("copy"===t)Al.call(a);else if("cut"===t)Pl.call(a);else if("paste"===t)Rl.call(a,"all");else if("paste-value"===t)Rl.call(a,"text");else if("paste-format"===t)Rl.call(a,"format");else if("hide"===t)Il.call(a);else{if(e){var n=a.data.selector,r=n.ri,i=n.ci,o=a.data.getCell(r,i);"level"===e?function(){var t=this.data;console.log("data",t),this.data.addLevel()}.call(a):a.trigger(e,a.data.selector,o)}Hl.call(a,t)}},wt(window,"resize",function(){a.reload()}),wt(window,"click",function(t){a.focusing=u.contains(t.target)}),wt(window,"paste",function(t){Rl.call(a,"all",t),t.preventDefault()}),wt(window,"keydown",function(t){if(a.focusing){var e=t.keyCode||t.which,n=t.key,r=t.ctrlKey,i=t.shiftKey,o=t.metaKey;if(r||o)switch(e){case 90:a.undo(),t.preventDefault();break;case 89:a.redo(),t.preventDefault();break;case 67:Al.call(a),t.preventDefault();break;case 88:Pl.call(a),t.preventDefault();break;case 85:d.trigger("underline"),t.preventDefault();break;case 86:break;case 37:Sl.call(a,i,"row-first"),t.preventDefault();break;case 38:Sl.call(a,i,"col-first"),t.preventDefault();break;case 39:Sl.call(a,i,"row-last"),t.preventDefault();break;case 40:Sl.call(a,i,"col-last"),t.preventDefault();break;case 32:Ol.call(a,!1,-1,a.data.selector.ci,!1),t.preventDefault();break;case 66:d.trigger("bold");break;case 73:d.trigger("italic")}else{switch(e){case 32:i&&Ol.call(a,!1,a.data.selector.ri,-1,!1);break;case 27:v.hide(),Tl.call(a);break;case 37:Sl.call(a,i,"left"),t.preventDefault();break;case 38:Sl.call(a,i,"up"),t.preventDefault();break;case 39:Sl.call(a,i,"right"),t.preventDefault();break;case 40:Sl.call(a,i,"down"),t.preventDefault();break;case 9:p.clear(),Sl.call(a,!1,i?"left":"right"),t.preventDefault();break;case 13:p.clear(),Sl.call(a,!1,i?"up":"down"),t.preventDefault();break;case 8:Hl.call(a,"delete-cell-text"),t.preventDefault()}"Delete"===n?(Hl.call(a,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(Wl.call(a,t.key,"input"),Ll.call(a)):113===e&&Ll.call(a)}}})}var ql=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMap=new Map;var i=n.settings,o=i.view,l=i.showToolbar,u=i.showContextmenu,c=i.defaultContextMenu,s=i.defineContentMenu,f=i.defaultToolbar,h=i.defineToolbar;this.el=a("div","".concat(Et,"-sheet")),this.toolbar=new Ka(n,o.width,!l,f,h),this.print=new bn(n),e.children(this.toolbar.el,this.el,this.print.el),this.data=n,this.tableEl=a("canvas","".concat(Et,"-table")),this.rowResizer=new Ct(!1,n.rows.height),this.colResizer=new Ct(!0,n.cols.minWidth),this.verticalScrollbar=new At(!0),this.horizontalScrollbar=new At(!1),this.editor=new ye(Ve,function(){return r.getTableOffset()},n.rows.height),this.modalValidation=new hl,this.contextMenu=new xn(function(){return r.getRect()},!u,c,s),this.selector=new Yt(n),this.overlayerCEl=a("div","".concat(Et,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=a("div","".concat(Et,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new gl,this.treeEl=a("div","dt-tree"),this.dragFlag=!1,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el,this.treeEl);var p=this;this.tree=new wl(this.treeEl.el,n,function(t){Il.call(p,t)}),this.table=new fn(this.tableEl.el,n,this.tree),Nl.call(this),Cl.call(this),Ol.call(this,!1,0,0)}var e,n,r;return e=t,(n=[{key:"on",value:function(t,e){return this.eventMap.set(t,e),this}},{key:"trigger",value:function(t){var e=this.eventMap;if(e.has(t)){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=e.get(t)).call.apply(n,[this].concat(i))}}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,El.call(this),jl.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"resetTreeData",value:function(t){this.tree.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),Cl.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),Cl.call(this),this}},{key:"undo",value:function(){this.data.undo(),Cl.call(this)}},{key:"redo",value:function(){this.data.redo(),Cl.call(this)}},{key:"reload",value:function(){return Cl.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,r=t.settings,i=this.getRect(),o=i.width,a=i.height,l=lt(r);return{width:o-n.indexWidth-l,height:a-e.height,left:n.indexWidth+l,top:e.height}}}])&&_l(e.prototype,n),r&&_l(e,r),t}();function Bl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Vl(t){return(Vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ul(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function $l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xl(t,e,n){return e&&Yl(t.prototype,e),n&&Yl(t,n),t}function Kl(t,e){return!e||"object"!==Vl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zl(t){return(Zl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gl(t,e){return(Gl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jl=function(t){function e(t){var n;$l(this,e);var r=new re("ellipsis");return(n=Kl(this,Zl(e).call(this,r,"auto",!1,"top-left"))).contentClick=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gl(t,e)}(e,Hn),Xl(e,[{key:"reset",value:function(t){var e=this,n=t.map(function(t,n){return a("div","".concat(Et,"-item")).css("width","150px").css("font-weight","normal").on("click",function(){e.contentClick(n),e.hide()}).child(t)});this.setContentChildren.apply(this,Ul(n))}},{key:"setTitle",value:function(){}}]),e}(),Ql=[{key:"delete",title:U("contextmenu.deleteSheet")}];function tu(){var t=this;return Ql.map(function(e){return function(t){var e=this;return a("div","".concat(Et,"-item")).child(t.title()).on("click",function(){e.itemClick(t.key),e.hide()})}.call(t,e)})}var eu=function(){function t(){var e;$l(this,t),this.el=(e=a("div","".concat(Et,"-contextmenu")).css("width","160px")).children.apply(e,Ul(tu.call(this))).hide(),this.itemClick=function(){}}return Xl(t,[{key:"hide",value:function(){var t=this.el;t.hide(),kt(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),xt(e)}}]),t}(),nu=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];$l(this,t),this.swapFunc=r,this.updateFunc=o,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new Jl(function(t){e.clickSwap2(e.items[t])}),this.contextMenu=new eu,this.contextMenu.itemClick=i,this.el=a("div","".concat(Et,"-bottombar")).children(this.contextMenu.el,this.menuEl=a("ul","".concat(Et,"-menu")).child(a("li","").children(new re("add").on("click",function(){e.dataNames.length<10?n():bl("tip","it less than or equal to 10")}),a("span","").child(this.moreEl)))).css("display",l?"block":"none")}return Xl(t,[{key:"addItem",value:function(t,e){var n=this;this.dataNames.push(t);var r=a("li",e?"active":"").child(t);r.on("click",function(){n.clickSwap2(r)}).on("contextmenu",function(t){var e=t.target,i=e.offsetLeft,o=e.offsetHeight;n.contextMenu.setOffset({left:i,bottom:o+1}),n.deleteEl=r}).on("dblclick",function(){var t=r.html(),e=new tl("auto","");e.val(t),e.input.on("blur",function(e){var r=e.target.value,i=n.dataNames.findIndex(function(e){return e===t});n.renameItem(i,r)}),r.html("").child(e.el),e.focus()}),e&&this.clickSwap(r),this.items.push(r),this.menuEl.child(r),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach(function(e){t.menuEl.removeChild(e.el)}),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var n=this.items.findIndex(function(t){return t===e});if(this.items.splice(n,1),this.dataNames.splice(n,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var r=Bl(this.items,1)[0];return this.activeEl=r,this.activeEl.toggle(),[n,0]}return[n,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex(function(e){return e===t});this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}]),t}();n(4);function ru(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function iu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"spreadsheet",function(){return au});var ou=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=e;this.options=r,this.sheetIndex=1,this.datas=[],"string"==typeof e&&(i=document.querySelector(e)),this.bottombar=new nu(function(){var t=n.addSheet();n.sheet.resetData(t)},function(t){var e=n.datas[t];n.sheet.resetData(e)},function(){n.deleteSheet()},function(t,e){n.datas[t].name=e},this.options.showBottomBar),this.data=this.addSheet();var o=a("div","".concat(Et)).on("contextmenu",function(t){return t.preventDefault()});i.appendChild(o.el),this.sheet=new ql(o,this.data),o.child(this.bottombar.el)}var e,n,r;return e=t,r=[{key:"locale",value:function(t,e){$(t,e)}}],(n=[{key:"addSheet",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t||"sheet".concat(this.sheetIndex),i=new mt(r,this.options);return i.change=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.sheet).trigger.apply(t,["change"].concat(r)),e.sheet.resetTreeData(r[0])},this.datas.push(i),this.bottombar.addItem(r,n),this.sheetIndex+=1,i}},{key:"deleteSheet",value:function(){var t=ru(this.bottombar.deleteItem(),2),e=t[0],n=t[1];e>=0&&(this.datas.splice(e,1),n>=0&&this.sheet.resetData(this.datas[n]))}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(this.bottombar.clear(),this.datas=[],e.length>0)for(var n=0;n<e.length;n+=1){var r=e[n],i=this.addSheet(r.name,0===n);i.setData(r),0===n&&this.sheet.resetData(i)}return this}},{key:"getData",value:function(){return this.datas.map(function(t){return t.getData()})}},{key:"cellText",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[r].setCellText(t,e,n,"finished"),this}},{key:"cell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}])&&iu(e.prototype,n),r&&iu(e,r),t}(),au=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new ou(t,e)};window&&(window.x_spreadsheet=au,window.x_spreadsheet.locale=function(t,e){return $(t,e)});e.default=ou}]);
//# sourceMappingURL=xspreadsheet.js.map